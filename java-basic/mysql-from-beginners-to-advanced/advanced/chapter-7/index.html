<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第07章_InnoDB 数据存储结构 | Bombax&#39;s Knowledge Document Notes</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="技术知识学习笔记">
    <meta name="keywords" content="技术知识学习笔记">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.a5ee4d2c.css" as="style"><link rel="preload" href="/assets/js/app.1f9bc03c.js" as="script"><link rel="preload" href="/assets/js/3.be9e7e99.js" as="script"><link rel="preload" href="/assets/js/2.c36d0987.js" as="script"><link rel="preload" href="/assets/js/33.a02e512f.js" as="script"><link rel="prefetch" href="/assets/js/1.0094a9f8.js"><link rel="prefetch" href="/assets/js/10.57dc9feb.js"><link rel="prefetch" href="/assets/js/100.549e8107.js"><link rel="prefetch" href="/assets/js/101.cdc9900a.js"><link rel="prefetch" href="/assets/js/102.559eb4e1.js"><link rel="prefetch" href="/assets/js/103.e93e873a.js"><link rel="prefetch" href="/assets/js/104.f72a97fa.js"><link rel="prefetch" href="/assets/js/105.8a88aff1.js"><link rel="prefetch" href="/assets/js/106.a6928366.js"><link rel="prefetch" href="/assets/js/107.88f8c8a9.js"><link rel="prefetch" href="/assets/js/108.221fcd72.js"><link rel="prefetch" href="/assets/js/109.83b01a4c.js"><link rel="prefetch" href="/assets/js/11.95ba941a.js"><link rel="prefetch" href="/assets/js/110.3a8bfc21.js"><link rel="prefetch" href="/assets/js/111.e09a67c7.js"><link rel="prefetch" href="/assets/js/112.8f29c828.js"><link rel="prefetch" href="/assets/js/113.a3ec218a.js"><link rel="prefetch" href="/assets/js/114.46baaf9a.js"><link rel="prefetch" href="/assets/js/115.dca2a47e.js"><link rel="prefetch" href="/assets/js/116.95b35ab7.js"><link rel="prefetch" href="/assets/js/117.748a7942.js"><link rel="prefetch" href="/assets/js/118.9baa4784.js"><link rel="prefetch" href="/assets/js/119.c98d396a.js"><link rel="prefetch" href="/assets/js/12.3e375fac.js"><link rel="prefetch" href="/assets/js/120.c56ebb20.js"><link rel="prefetch" href="/assets/js/121.0046ecb9.js"><link rel="prefetch" href="/assets/js/122.9266562d.js"><link rel="prefetch" href="/assets/js/123.607dd163.js"><link rel="prefetch" href="/assets/js/124.f902b1cd.js"><link rel="prefetch" href="/assets/js/125.a1fc58d3.js"><link rel="prefetch" href="/assets/js/126.0f7e19b0.js"><link rel="prefetch" href="/assets/js/127.0849390a.js"><link rel="prefetch" href="/assets/js/128.948551ba.js"><link rel="prefetch" href="/assets/js/129.d9ca416a.js"><link rel="prefetch" href="/assets/js/13.e15907e1.js"><link rel="prefetch" href="/assets/js/130.24c7e3fb.js"><link rel="prefetch" href="/assets/js/131.1b011ee5.js"><link rel="prefetch" href="/assets/js/132.8751add7.js"><link rel="prefetch" href="/assets/js/133.715ef8cf.js"><link rel="prefetch" href="/assets/js/14.8bc7a04e.js"><link rel="prefetch" href="/assets/js/15.45052e8a.js"><link rel="prefetch" href="/assets/js/16.9c02512f.js"><link rel="prefetch" href="/assets/js/17.48a859d1.js"><link rel="prefetch" href="/assets/js/18.5c00cde2.js"><link rel="prefetch" href="/assets/js/19.a40de13b.js"><link rel="prefetch" href="/assets/js/20.df43b03f.js"><link rel="prefetch" href="/assets/js/21.ceeba2d0.js"><link rel="prefetch" href="/assets/js/22.1bba0f00.js"><link rel="prefetch" href="/assets/js/23.76e4c23a.js"><link rel="prefetch" href="/assets/js/24.f9c3a106.js"><link rel="prefetch" href="/assets/js/25.d3ac7e27.js"><link rel="prefetch" href="/assets/js/26.2dccc980.js"><link rel="prefetch" href="/assets/js/27.470222d7.js"><link rel="prefetch" href="/assets/js/28.0083644b.js"><link rel="prefetch" href="/assets/js/29.c51b5005.js"><link rel="prefetch" href="/assets/js/30.e4d96a02.js"><link rel="prefetch" href="/assets/js/31.a6e5f592.js"><link rel="prefetch" href="/assets/js/32.f513417c.js"><link rel="prefetch" href="/assets/js/34.828ac0a3.js"><link rel="prefetch" href="/assets/js/35.6a8d3b2a.js"><link rel="prefetch" href="/assets/js/36.a17d9cce.js"><link rel="prefetch" href="/assets/js/37.b28188f4.js"><link rel="prefetch" href="/assets/js/38.6c0bad74.js"><link rel="prefetch" href="/assets/js/39.4ac705c3.js"><link rel="prefetch" href="/assets/js/4.80fad3d6.js"><link rel="prefetch" href="/assets/js/40.e1295e6b.js"><link rel="prefetch" href="/assets/js/41.ab0dc1d3.js"><link rel="prefetch" href="/assets/js/42.abf81f78.js"><link rel="prefetch" href="/assets/js/43.c6055770.js"><link rel="prefetch" href="/assets/js/44.2adf0a62.js"><link rel="prefetch" href="/assets/js/45.dfeaf4aa.js"><link rel="prefetch" href="/assets/js/46.4b7c2b21.js"><link rel="prefetch" href="/assets/js/47.d4a6831e.js"><link rel="prefetch" href="/assets/js/48.e1366a45.js"><link rel="prefetch" href="/assets/js/49.1bebc46f.js"><link rel="prefetch" href="/assets/js/5.1478cf6c.js"><link rel="prefetch" href="/assets/js/50.668f9cb0.js"><link rel="prefetch" href="/assets/js/51.dea0d5d9.js"><link rel="prefetch" href="/assets/js/52.3000ebc8.js"><link rel="prefetch" href="/assets/js/53.66f5ad34.js"><link rel="prefetch" href="/assets/js/54.319b0662.js"><link rel="prefetch" href="/assets/js/55.ffc0758d.js"><link rel="prefetch" href="/assets/js/56.b67a2b8d.js"><link rel="prefetch" href="/assets/js/57.70e2950c.js"><link rel="prefetch" href="/assets/js/58.a0a2420f.js"><link rel="prefetch" href="/assets/js/59.01790419.js"><link rel="prefetch" href="/assets/js/6.3409ab2f.js"><link rel="prefetch" href="/assets/js/60.43219c1e.js"><link rel="prefetch" href="/assets/js/61.ed48312b.js"><link rel="prefetch" href="/assets/js/62.62ea2fef.js"><link rel="prefetch" href="/assets/js/63.d1527c65.js"><link rel="prefetch" href="/assets/js/64.b10abcac.js"><link rel="prefetch" href="/assets/js/65.2206c2d8.js"><link rel="prefetch" href="/assets/js/66.bd612805.js"><link rel="prefetch" href="/assets/js/67.ad9c475a.js"><link rel="prefetch" href="/assets/js/68.7f975389.js"><link rel="prefetch" href="/assets/js/69.36725aff.js"><link rel="prefetch" href="/assets/js/70.b3cfc9e1.js"><link rel="prefetch" href="/assets/js/71.ef2c6abc.js"><link rel="prefetch" href="/assets/js/72.77bf484b.js"><link rel="prefetch" href="/assets/js/73.ca8e0259.js"><link rel="prefetch" href="/assets/js/74.9aa20efa.js"><link rel="prefetch" href="/assets/js/75.9de36ec8.js"><link rel="prefetch" href="/assets/js/76.79e8f077.js"><link rel="prefetch" href="/assets/js/77.a71d38fe.js"><link rel="prefetch" href="/assets/js/78.2168cfa5.js"><link rel="prefetch" href="/assets/js/79.d830dc29.js"><link rel="prefetch" href="/assets/js/80.ed07f097.js"><link rel="prefetch" href="/assets/js/81.036542c0.js"><link rel="prefetch" href="/assets/js/82.ccd57590.js"><link rel="prefetch" href="/assets/js/83.08279d07.js"><link rel="prefetch" href="/assets/js/84.fb82a36b.js"><link rel="prefetch" href="/assets/js/85.cc257bf7.js"><link rel="prefetch" href="/assets/js/86.9b4a4d60.js"><link rel="prefetch" href="/assets/js/87.be2fbadd.js"><link rel="prefetch" href="/assets/js/88.5dbe3bf4.js"><link rel="prefetch" href="/assets/js/89.baa4fea0.js"><link rel="prefetch" href="/assets/js/9.9ffa17fb.js"><link rel="prefetch" href="/assets/js/90.0b8138d9.js"><link rel="prefetch" href="/assets/js/91.6c5e4907.js"><link rel="prefetch" href="/assets/js/92.d4a76597.js"><link rel="prefetch" href="/assets/js/93.8a94df70.js"><link rel="prefetch" href="/assets/js/94.ed88a857.js"><link rel="prefetch" href="/assets/js/95.2f75b854.js"><link rel="prefetch" href="/assets/js/96.6946c831.js"><link rel="prefetch" href="/assets/js/97.b26e97d9.js"><link rel="prefetch" href="/assets/js/98.07ba851b.js"><link rel="prefetch" href="/assets/js/99.347e0865.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.cc39ba74.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a5ee4d2c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.webp" alt="Bombax's Knowledge Document Notes" class="logo"> <span class="site-name can-hide">Bombax's Knowledge Document Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><a href="/java-basic/" class="link-title router-link-active">Java基础</a> <span class="title" style="display:none;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前置</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-learning/" class="nav-link">尚硅谷Java学习</a></li><li class="dropdown-subitem"><a href="/java-basic/software-install-config/" class="nav-link">基础软件安装与配置</a></li></ul></li><li class="dropdown-item"><h4>核心</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-from-entry-to-proficiency/" class="nav-link">Java从入门到精通(JDK17版)</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/beginners/" class="nav-link">MySQL从入门到高级-基础篇</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/" class="nav-link router-link-active">MySQL从入门到高级-高级篇</a></li><li class="dropdown-subitem"><a href="/java-basic/jdbc-core/" class="nav-link">JDBC 核心技术(JDK21版)</a></li><li class="dropdown-subitem"><a href="/java-basic/java-web/" class="nav-link">JavaWeb 技术</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/pojo/" class="nav-link">POJO 概念</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务核心" class="dropdown-title"><a href="/micro-service-core/" class="link-title">微服务核心</a> <span class="title" style="display:none;">微服务核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud/" class="nav-link">SpringCloud</a></li><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud-Alibaba/" class="nav-link">SpringCloud-Alibaba</a></li></ul></li><li class="dropdown-item"><h4>持久层框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/micro-service-core/MyBatisPlus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>相关知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/20b7dd/" class="nav-link">Mybatis 代码生成工具比较</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务生态" class="dropdown-title"><a href="/micro-service-ecology/" class="link-title">微服务生态</a> <span class="title" style="display:none;">微服务生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>安全框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/SpringSecurity/" class="nav-link">安全框架之 Spring Security</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/Shiro/" class="nav-link">安全框架之 Shiro</a></li></ul></li><li class="dropdown-item"><h4>定时任务框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/Quartz/" class="nav-link">定时任务框架之 Quartz</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/XXL-JOB/" class="nav-link">定时任务框架之 XXL-JOB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用工具" class="dropdown-title"><a href="/tools/" class="link-title">实用工具</a> <span class="title" style="display:none;">实用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/java-logs/" class="nav-link">Java 日志热门框架</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">Git 常用命令</a></li><li class="dropdown-item"><!----> <a href="/tools/swagger/" class="nav-link">Swagger API 文档生成工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/weibocom/motan/wiki/zh_overview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Motan RPC
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.knowledgedict.com/tutorial/lombok-intro.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Tutorial
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://projectlombok.org/features/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Features
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/fastjson2/wiki/fastjson2_intro_cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FastJSON2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://felord.cn/_doc/spring/5.x.RELEASE/_book/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Framework 5 中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://x-stream.github.io/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XStream
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://neoremind.com/2016/02/java%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6fluent-validator/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  fluent-validator 业务逻辑验证框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.ehcache.org/documentation/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ehcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caffeine.gitbook.io/caffeine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  caffeine 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://springdoc.cn/spring/integration.html#cache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Cache
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/imyjy/p/15695160.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主流缓存框架调研
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95" target="_blank" rel="noopener noreferrer" class="nav-link external">
  redisson 官方中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012934325/article/details/100652805" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 中文学习指南
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.liquibase.com/concepts/introduction-to-liquibase.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 官方文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/coderofmutou/coderofmutou.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.webp"> <div class="blogger-info"><h3>bombax</h3> <span>小小程序猿</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><a href="/java-basic/" class="link-title router-link-active">Java基础</a> <span class="title" style="display:none;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前置</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-learning/" class="nav-link">尚硅谷Java学习</a></li><li class="dropdown-subitem"><a href="/java-basic/software-install-config/" class="nav-link">基础软件安装与配置</a></li></ul></li><li class="dropdown-item"><h4>核心</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-from-entry-to-proficiency/" class="nav-link">Java从入门到精通(JDK17版)</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/beginners/" class="nav-link">MySQL从入门到高级-基础篇</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/" class="nav-link router-link-active">MySQL从入门到高级-高级篇</a></li><li class="dropdown-subitem"><a href="/java-basic/jdbc-core/" class="nav-link">JDBC 核心技术(JDK21版)</a></li><li class="dropdown-subitem"><a href="/java-basic/java-web/" class="nav-link">JavaWeb 技术</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/pojo/" class="nav-link">POJO 概念</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务核心" class="dropdown-title"><a href="/micro-service-core/" class="link-title">微服务核心</a> <span class="title" style="display:none;">微服务核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud/" class="nav-link">SpringCloud</a></li><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud-Alibaba/" class="nav-link">SpringCloud-Alibaba</a></li></ul></li><li class="dropdown-item"><h4>持久层框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/micro-service-core/MyBatisPlus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>相关知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/20b7dd/" class="nav-link">Mybatis 代码生成工具比较</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务生态" class="dropdown-title"><a href="/micro-service-ecology/" class="link-title">微服务生态</a> <span class="title" style="display:none;">微服务生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>安全框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/SpringSecurity/" class="nav-link">安全框架之 Spring Security</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/Shiro/" class="nav-link">安全框架之 Shiro</a></li></ul></li><li class="dropdown-item"><h4>定时任务框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/Quartz/" class="nav-link">定时任务框架之 Quartz</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/XXL-JOB/" class="nav-link">定时任务框架之 XXL-JOB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用工具" class="dropdown-title"><a href="/tools/" class="link-title">实用工具</a> <span class="title" style="display:none;">实用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/java-logs/" class="nav-link">Java 日志热门框架</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">Git 常用命令</a></li><li class="dropdown-item"><!----> <a href="/tools/swagger/" class="nav-link">Swagger API 文档生成工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/weibocom/motan/wiki/zh_overview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Motan RPC
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.knowledgedict.com/tutorial/lombok-intro.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Tutorial
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://projectlombok.org/features/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Features
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/fastjson2/wiki/fastjson2_intro_cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FastJSON2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://felord.cn/_doc/spring/5.x.RELEASE/_book/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Framework 5 中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://x-stream.github.io/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XStream
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://neoremind.com/2016/02/java%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6fluent-validator/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  fluent-validator 业务逻辑验证框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.ehcache.org/documentation/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ehcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caffeine.gitbook.io/caffeine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  caffeine 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://springdoc.cn/spring/integration.html#cache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Cache
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/imyjy/p/15695160.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主流缓存框架调研
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95" target="_blank" rel="noopener noreferrer" class="nav-link external">
  redisson 官方中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012934325/article/details/100652805" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 中文学习指南
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.liquibase.com/concepts/introduction-to-liquibase.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 官方文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/coderofmutou/coderofmutou.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>核心</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Java从入门到精通(JDK17版)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>MySQL从入门到高级-基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>MySQL从入门到高级-高级篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-0/" class="sidebar-link">第00章_写在前面</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-1/" class="sidebar-link">第01章_Linux 下 MySQL 的安装与使用</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-2/" class="sidebar-link">第02章_MySQL 的数据目录</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-3/" class="sidebar-link">第03章_用户与权限管理</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-4/" class="sidebar-link">第04章_逻辑架构</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-5/" class="sidebar-link">第05章_存储引擎</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-6/" class="sidebar-link">第06章_索引的数据结构</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/" aria-current="page" class="active sidebar-link">第07章_InnoDB 数据存储结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-数据库的存储结构-页" class="sidebar-link">1. 数据库的存储结构：页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-1-磁盘与内存交互基本单位-页" class="sidebar-link">1.1 磁盘与内存交互基本单位：页</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-2-页结构概述" class="sidebar-link">1.2 页结构概述</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-3-页的大小" class="sidebar-link">1.3 页的大小</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-4-页的上层结构" class="sidebar-link">1.4 页的上层结构</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_2-页的内部结构" class="sidebar-link">2. 页的内部结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#第-1-部分-文件头部和文件尾部" class="sidebar-link">第 1 部分：文件头部和文件尾部</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#file-header-文件头部-38-字节" class="sidebar-link">File Header（文件头部）（38 字节）</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#file-trailer-文件尾部-8-字节" class="sidebar-link">File Trailer（文件尾部）（8 字节）</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#第-2-部分-空闲空间、用户记录和最小最大记录" class="sidebar-link">第 2 部分：空闲空间、用户记录和最小最大记录</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#free-space-空闲空间" class="sidebar-link">Free Space （空闲空间）</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#user-records-用户记录" class="sidebar-link">User Records （用户记录）</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#infimum-supremum-最小最大记录" class="sidebar-link">Infimum + Supremum（最小最大记录）</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#第-3-部分-页目录和页面头部" class="sidebar-link">第 3 部分：页目录和页面头部</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#page-directory-页目录" class="sidebar-link">Page Directory（页目录）</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#page-header-页面头部" class="sidebar-link">Page Header（页面头部）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-innodb-行格式-或记录格式" class="sidebar-link">3. InnoDB 行格式（或记录格式）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-1-指定行格式的语法" class="sidebar-link">3.1 指定行格式的语法</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-2-compact-行格式" class="sidebar-link">3.2 COMPACT 行格式</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_1-变长字段长度列表" class="sidebar-link">1）变长字段长度列表</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_2-null-值列表-null-bitmap" class="sidebar-link">2）NULL 值列表(NULL bitmap)</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-记录头信息-5-字节" class="sidebar-link">3）记录头信息（5 字节）</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-记录的真实数据" class="sidebar-link">4）记录的真实数据</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_5-举例-分析-compact-行记录的内部结构" class="sidebar-link">5）举例：分析 Compact 行记录的内部结构</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-3-dynamic-和-compressed-行格式" class="sidebar-link">3.3 Dynamic 和 Compressed 行格式</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_3-4-redundant-行格式" class="sidebar-link">3.4 Redundant 行格式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-区、段和碎片区" class="sidebar-link">4. 区、段和碎片区</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-1-为什么要有区" class="sidebar-link">4.1 为什么要有区？</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-2-为什么要有段" class="sidebar-link">4.2 为什么要有段？</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-3-为什么要有碎片区" class="sidebar-link">4.3 为什么要有碎片区？</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_4-4-区的分类" class="sidebar-link">4.4 区的分类</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_5-表空间" class="sidebar-link">5. 表空间</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_5-1-独立表空间" class="sidebar-link">5.1 独立表空间</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#_5-2-系统表空间" class="sidebar-link">5.2 系统表空间</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/#附录-数据页加载的三种方式" class="sidebar-link">附录：数据页加载的三种方式</a></li></ul></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-8/" class="sidebar-link">第08章_索引的创建与设计原则</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-9/" class="sidebar-link">第09章_性能分析工具的使用</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-10/" class="sidebar-link">第10章_索引优化与查询优化</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/" class="sidebar-link">第11章_数据库的设计规范</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-12/" class="sidebar-link">第12章_数据库其它调优策略</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-13/" class="sidebar-link">第13章_事务基础知识</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-14/" class="sidebar-link">第14章_MySQL 事务日志</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-15/" class="sidebar-link">第15章_锁</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-16/" class="sidebar-link">第16章_多版本并发控制</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-17/" class="sidebar-link">第17章_其它数据库日志</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-18/" class="sidebar-link">第18章_主从复制</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-19/" class="sidebar-link">第19章_数据库备份与恢复</a></li></ul></section></li><li><a href="/java-basic/jdbc-core/" class="sidebar-link">JDBC 核心技术(JDK21版)</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>JavaWeb技术</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Java%E5%9F%BA%E7%A1%80" title="分类" data-v-06225672>Java基础</a></li><li data-v-06225672><a href="/categories/?category=%E6%A0%B8%E5%BF%83" title="分类" data-v-06225672>核心</a></li><li data-v-06225672><a href="/categories/?category=MySQL%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7-%E9%AB%98%E7%BA%A7%E7%AF%87" title="分类" data-v-06225672>MySQL从入门到高级-高级篇</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/coderofmutou" target="_blank" title="作者" class="beLink" data-v-06225672>bombax</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-05-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">第07章_InnoDB 数据存储结构<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="第-07-章-innodb-数据存储结构"><a href="#第-07-章-innodb-数据存储结构" class="header-anchor">#</a> 第 07 章 InnoDB 数据存储结构</h1> <h2 id="_1-数据库的存储结构-页"><a href="#_1-数据库的存储结构-页" class="header-anchor">#</a> 1. 数据库的存储结构：页</h2> <p>索引结构给我们提供了高效的索引方式，不过索引信息以及数据记录都保存在文件上的，确切说是存储在页结构中。另一方面，索引是在存储引擎中实现的，MySQL 服务器上的<code>存储引擎</code>负责对表中数据的读取和写入工作。不同存储引擎中<code>存放的格式</code>一般不同的，甚至有的存储引擎比如 Memory 都不用磁盘来存储数据。</p> <p>由于<code>InnoDB</code>是 MySQL 的<code>默认存储引擎</code>，所以本章剖析 InooDB 存储引擎的数据存储结构。</p> <h3 id="_1-1-磁盘与内存交互基本单位-页"><a href="#_1-1-磁盘与内存交互基本单位-页" class="header-anchor">#</a> 1.1 磁盘与内存交互基本单位：页</h3> <p>InnoDB 将数据划分为若干个页，InnoDB 中页的大小默认为 <strong>16KB</strong>。</p> <p>以<code>页</code>作为磁盘和内存之间交互的<code>基本单位</code>，也就是一次最少从磁盘中读取 16KB 的内容到内存中，一次最少把内存中的 16KB 内容刷新到磁盘中。也就是说，<strong>在数据库中，不论读一行，还是读多行，都是将这些行所在的页进行加载。也就是说，数据库管理存储空间的基本单位是页(Page)，数据库 I/O 操作的最小单位是页</strong>。一个页中可以存储多个行记录。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>记录是按照行来存储的，但是数据库的读取并不以行为单位，否则一次读取（也就是一次 I/O 操作）只能处理一行数据，效率会非常低。</p></div> <h3 id="_1-2-页结构概述"><a href="#_1-2-页结构概述" class="header-anchor">#</a> 1.2 页结构概述</h3> <p>页 a、页 b、页 c...页 n 这些页可以<code>不在物理结构上相连</code>，只要通过<code>双向链表</code>相关联即可。每个数据页中的记录会按照主键值从小到大的顺序组成一个<code>单向链表</code>，每个数据页都会为存储在它里边的记录生成一个<code>页目录</code>，在通过主键查找某条记录的时候可以在页目录中<code>使用二分法</code>快速定位到对应的槽，然后再遍历该槽对应的分组中的记录即可快速找到指定的记录。</p> <h3 id="_1-3-页的大小"><a href="#_1-3-页的大小" class="header-anchor">#</a> 1.3 页的大小</h3> <p>不同的数据库管理系统（简称 DBMS）的页大小不同。比如在 MySQL 的 InnoDB 存储引擎中，默认页的大小是 <code>16KB</code>，可以通过下面的命令来进行查看：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%innodb_page_size%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
<span class="token operator">|</span> Variable_name    <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
<span class="token operator">|</span> innodb_page_size <span class="token operator">|</span> <span class="token number">16384</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+-------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>SQL Server 中页的大小为<code>8KB</code>，而在 Oracle 中用术语&quot;<code>块</code>&quot;(Block)来表示&quot;页&quot;，Oracle 支持的块大小为 2KB, 4KB, 8KB, 16KB, 32KB 和 64KB。</p> <h3 id="_1-4-页的上层结构"><a href="#_1-4-页的上层结构" class="header-anchor">#</a> 1.4 页的上层结构</h3> <p>另外在数据库中，还存在着区(Extent)、段(Segment)和表空间(Tablespace)的概念。</p> <p>行、页、区、段、表空间的关系如下图所示：</p> <p><img src="/assets/img/Extent_Segment_Tablespace.040a1814.webp" alt="Extent_Segment_Tablespace"></p> <p>区(Extent)是比页大一级的存储结构，在 InnoDB 存储引擎中，一个区会分配<code>64个连续的页</code>。因为 InnoDB 中的页大小默认是 16KB，所以一个区的大小是 64*16KB=<code>1MB</code>。</p> <p>段(Segment)由一个或多个区组成，区在文件系统是一个连续分配的空间（在 InnoDB 中是连续的 64 个页），不过在段中不要求区与区之间是相邻的。<code>段是数据库中的分配单位，不同类型的数据库对象以不同的段形式存在。</code>当我们创建数据表、索引的时候，就会相应创建对应的段，比如创建一张表时会创建一个表段，创建一个索引时会创建一个索引段。</p> <p>表空间(Tablespace)是一个逻辑容器，表空间存储的对象是段，在一个表空间中可以有一个或多个段，但是一个段只能属于一个表空间。数据库由一个或多个表空间组成，表空间从管理上可以划分为<code>系统表空间</code>、<code>用户表空间</code>、<code>撤销表空间</code>、<code>临时表空间</code>等。</p> <h2 id="_2-页的内部结构"><a href="#_2-页的内部结构" class="header-anchor">#</a> 2. 页的内部结构</h2> <p>页如果按类型划分的话，常见的有<code>数据页（保存 B+ 树节点）、系统表、Undo 页</code>和<code>事务数据页</code>等。数据页是我们最常使用的页。</p> <p>数据页的 <code>16KB</code> 大小的存储空间被划分为七个部分，分别是文件头(File Header)、页头(Page Header)、最大最小记录(Infimum + supremum)、用户记录(User Records)、空闲空间(Free Space)、页目录(Page Directory)和文件尾(File Tailer)。</p> <p>页结构的示意图如下所示：</p> <p><img src="data:image/webp;base64,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" alt="data_page_structure"></p> <p>这 7 个部分作用分别如下</p> <p><img src="/assets/img/data_page_structure2.c9510d4b.webp" alt="data_page_structure2"></p> <p>我们可以把这 7 个结构分为 3 个部分。</p> <h3 id="第-1-部分-文件头部和文件尾部"><a href="#第-1-部分-文件头部和文件尾部" class="header-anchor">#</a> 第 1 部分：文件头部和文件尾部</h3> <p>首先是<code>文件通用部分</code>，也就是<code>文件头</code>和<code>文件尾</code>。</p> <h4 id="file-header-文件头部-38-字节"><a href="#file-header-文件头部-38-字节" class="header-anchor">#</a> File Header（文件头部）（38 字节）</h4> <p><strong>作用</strong>：
描述各种页的通用信息。（比如页的编号、其上一页、下一页是谁等）</p> <p><strong>大小</strong>：38 字节</p> <table><thead><tr><th style="text-align:left;">名称</th> <th style="text-align:left;">占用空间大小</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>FIL_PAGE_SPACE_OR_CHKSUM</code></td> <td style="text-align:left;"><code>4</code>字节</td> <td style="text-align:left;">页的校验和（checksum 值）</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_OFFSET</code></td> <td style="text-align:left;"><code>4</code>字节</td> <td style="text-align:left;">页号</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_PREV</code></td> <td style="text-align:left;"><code>4</code>字节</td> <td style="text-align:left;">上一个页的页号</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_NEXT</code></td> <td style="text-align:left;"><code>4</code>字节</td> <td style="text-align:left;">下一个页的页号</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_LSN</code></td> <td style="text-align:left;"><code>8</code>字节</td> <td style="text-align:left;">页面被最后修改时对应的日志序列位置<br>英文名 Log Sequence Number</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_TYPE</code></td> <td style="text-align:left;"><code>2</code>字节</td> <td style="text-align:left;">该页的类型</td></tr> <tr><td style="text-align:left;">FIL_PAGE_FILE_FLUSH_LSN</td> <td style="text-align:left;"><code>8</code>字节</td> <td style="text-align:left;">仅在系统表空间的一个页中定义，代表文件至少被刷新到了对应的 LSN 值</td></tr> <tr><td style="text-align:left;">FIL_PAGE_ARCH_LOG_NO_OR_SPACE_ID</td> <td style="text-align:left;"><code>4</code>字节</td> <td style="text-align:left;">页属于哪个表空间</td></tr></tbody></table> <ul><li><p><code>FIL_PAGE_OFFSET（4字节）</code>：每一个页都有一个单独的页号，InnoDB 通过页号可以唯一定位一个页。</p></li> <li><p><code>FIL_PAGE_TYPE（2字节）</code>：这个代表当前页的类型。</p></li></ul> <table><thead><tr><th style="text-align:left;">类型名称</th> <th style="text-align:left;">十六进制</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">FIL_PAGE_TYPE_ALLOCATED</td> <td style="text-align:left;">0x0000</td> <td style="text-align:left;">最新分配，还没有使用</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_UNDO_LOG</code></td> <td style="text-align:left;">0x0002</td> <td style="text-align:left;">Undo 日志页</td></tr> <tr><td style="text-align:left;">FIL_PAGE_INODE</td> <td style="text-align:left;">0x0003</td> <td style="text-align:left;">段信息节点</td></tr> <tr><td style="text-align:left;">FIL_PAGE_IBUF_FREE_LIST</td> <td style="text-align:left;">0x0004</td> <td style="text-align:left;">Insert Buffer 空闲列表</td></tr> <tr><td style="text-align:left;">FIL_PAGE_IBUF_BITMAP</td> <td style="text-align:left;">0x0005</td> <td style="text-align:left;">Insert Buffer 位图</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_TYPE_SYS</code></td> <td style="text-align:left;">0x0006</td> <td style="text-align:left;">系统页</td></tr> <tr><td style="text-align:left;">FIL_PAGE_TYPE_TRX_SYS</td> <td style="text-align:left;">0x0007</td> <td style="text-align:left;">事务系统数据</td></tr> <tr><td style="text-align:left;">FIL_PAGE_TYPE_FSP_HDR</td> <td style="text-align:left;">0x0008</td> <td style="text-align:left;">表空间头部信息</td></tr> <tr><td style="text-align:left;">FIL_PAGE_TYPE_XDES</td> <td style="text-align:left;">0x0009</td> <td style="text-align:left;">扩展描述页</td></tr> <tr><td style="text-align:left;">FIL_PAGE_TYPE_BLOB</td> <td style="text-align:left;">0x000A</td> <td style="text-align:left;">溢出页</td></tr> <tr><td style="text-align:left;"><code>FIL_PAGE_INDEX</code></td> <td style="text-align:left;">0x45BF</td> <td style="text-align:left;">索引页，也就是我们所说的<code>数据页</code></td></tr></tbody></table> <ul><li><p><code>FIL_PAGE_PREV（4 字节）和FIL_PAGE_NEXT（4 字节）</code></p> <p>InnoDB 都是以页为单位存放数据的，如果数据分散到多个不连续的页中存储的话需要把这些页关联起来，FIL_PAGE_PREV 和 FIL_PAGE_NEXT 就分别代表本页的上一个和下一个页的页号。这样通过建立一个双向链表把许许多多的页就都串联起来了，这些页之间<strong>不需要是物理上的连续，而是逻辑上的连续。</strong></p> <p><img src="/assets/img/page_structure3.9ef75620.webp" alt="page_structure3"></p></li> <li><p><code>FIL_PAGE_SPACE_OR_CHKSUM（4 字节）</code></p> <p>代表当前页面的校验和(checksum)。文件头部和文件尾部都有属性：FIL_PAGE_SPACE_OR_CHKSUM</p> <p><strong>作用：</strong></p> <p>InnoDB 存储引擎以页为单位把数据加载到内存中处理，如果该页中的数据在内存中被修改了，那么<code>在修改后的某个时间需要把数据同步到磁盘中。</code>但是在同步了一半的时候断电了，造成了该页传输的不完整。</p> <p>为了检测一个页是否完整（也就是在同步的时候有没有发生只同步一半的尴尬情况），这时可以通过文件尾的校验和（checksum 值）与文件头的校验和做比对，如果两个值不相等则证明页的传输有问题，需要重新进行传输，否则认为页的传输已经完成。</p> <p><strong>具体的：</strong></p> <p>每当一个页面在内存中修改了，在同步之前就要把它的校验和算出来，因为 File Header 在页面的前边，所以校验和会被首先同步到磁盘，当完全写完时，校验和也会被写到页的尾部，如果完全同步成功，则页的首部和尾部的校验和应该是一致的。如果写了一半儿断电了，那么在 File Header 中的校验和就代表着已经修改过的页，而在 File Trailer 中的校验和代表着原先的页，二者不同则意味着同步中间出了错。这里，校验方式就是采用 Hash 算法进行校验。</p></li> <li><p><code>FIL_PAGE_LSN（8 字节）</code></p> <p>页面被最后修改时对应的日志序列位置（英文名是：Log Sequence Number）</p></li></ul> <h4 id="file-trailer-文件尾部-8-字节"><a href="#file-trailer-文件尾部-8-字节" class="header-anchor">#</a> File Trailer（文件尾部）（8 字节）</h4> <ul><li>前 4 个字节代表页的校验和：这个部分是和 File Header 中的校验和相对应的。</li> <li>后 4 个字节代表页面被最后修改时对应的日志序列位置(LSN)：这个部分也是为了校验页的完整性的，如果首部和尾部的 LSN 值校验不成功的话，就说明同步过程出现了问题。</li></ul> <h3 id="第-2-部分-空闲空间、用户记录和最小最大记录"><a href="#第-2-部分-空闲空间、用户记录和最小最大记录" class="header-anchor">#</a> 第 2 部分：空闲空间、用户记录和最小最大记录</h3> <p>第二个部分是<code>记录部分</code></p> <p>页的主要作用是存储记录，所以“最大和最小记录”和“用户记录”部分占了页结构的主要空间。</p> <p><img src="/assets/img/Page_Free_Space.82ebc4e2.webp" alt="Page_Free_Space"></p> <h4 id="free-space-空闲空间"><a href="#free-space-空闲空间" class="header-anchor">#</a> Free Space （空闲空间）</h4> <p>我们自己存储的记录会按照指定的<code>行格式</code>存储到<code>User Records</code>部分。但是在一开始生成页的时候，其实并没有 User Records 这个部分，<code>每当我们插入一条记录，都会从 Free Space 部分，也就是尚未使用的存储空间中申请一个记录大小的空间划分到 User Records 部分</code>，当 Free Space 部分的空间全部被 User Records 部分替代掉之后，也就意味着这个页使用完了，如果还有新的记录插入的话，就需要去<code>申请新的页</code>了。</p> <h4 id="user-records-用户记录"><a href="#user-records-用户记录" class="header-anchor">#</a> User Records （用户记录）</h4> <p>User Records 中的这些记录按照<code>指定的行格式</code>一条一条摆在 User Records 部分，相互之间形成<code>单链表</code>。</p> <h4 id="infimum-supremum-最小最大记录"><a href="#infimum-supremum-最小最大记录" class="header-anchor">#</a> Infimum + Supremum（最小最大记录）</h4> <p><strong>记录可以比较大小吗</strong>？
是的，记录可以比大小，对于一条完整的记录来说，比较记录的大小就是<code>比较主键</code>的大小。比方说我们插入的 4 行记录的主键值分别是：1、2、3、4，这也就意味着这 4 条记录是从小到大依次递增。</p> <p>InnoDB 规定的最小记录与最大记录这两条记录的构造十分简单，都是由 5 字节大小的记录头信息和 8 字节大小的一个固定的部分组成的。</p> <p><img src="/assets/img/Infimum_Supremum.92211610.webp" alt="Infimum_Supremum"></p> <p>这两条记录<code>不是我们自己定义的记录</code>，所以它们并不存放在页的 User Records 部分，他们被单独放在一个称为 Infimum + Supremum 的部分</p> <p><img src="/assets/img/Infimum_Supremum2.22a91831.webp" alt="Infimum_Supremum2"></p> <h3 id="第-3-部分-页目录和页面头部"><a href="#第-3-部分-页目录和页面头部" class="header-anchor">#</a> 第 3 部分：页目录和页面头部</h3> <h4 id="page-directory-页目录"><a href="#page-directory-页目录" class="header-anchor">#</a> Page Directory（页目录）</h4> <p><strong>为什么需要页目录</strong></p> <p>在页中，记录是以<code>单向链表</code>的形式进行存储的。单向链表的特点就是插入、删除非常方便，但是<code>检索效率不高</code>，最差的情况下需要遍历链表上的所有节点才能完成检索。因此在页结构中专门设计了页目录这个模块，<code>专门给记录做一个目录</code>，通过<code>二分查找法</code>的方式进行检索，提升效率。</p> <p><strong>页目录结构</strong></p> <p>① 将所有的记录<code>分成几个组</code>，这些记录包括最小记录和最大记录，但不包括标记为“已删除”的记录。</p> <p>第 1 组，也就是最小记录所在的分组只有 1 个记录；</p> <p>最后一组，就是最大记录所在的分组，会有 1-8 条记录；</p> <p>其余的组记录数量在 4-8 条之间。</p> <p>这样做的好处是，除了第 1 组（最小记录所在组）以外，其余组的记录数会<code>尽量平分</code>。</p> <p>② 在每个组中最后一条记录的头信息中会存储该组一共有多少条记录，作为<strong>n_owned 字段</strong>。</p> <p>③ <code>页目录用来存储每组最后一条记录的地址偏移量</code>，这些地址偏移量会按照<code>先后顺序存储</code>起来，每组的地址偏移量也被称之为<code>槽（slot）</code>，每个槽相当于指针指向了不同组的最后一个记录。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <ul><li>分组可以减少减少页目录的大小</li> <li>分组可以减少页目录的变动</li> <li>如果每条记录的偏移都放在页目录中，增加删除记录，就会频繁更改页目录。页目录是数组结构，增删改的时间复杂度是比较高的。</li> <li>一个页为 16KB，假设一条记录，占 200 个字节，每页也有将近 80 条多记录。</li></ul></div> <p><strong>举例 1：</strong></p> <p>现在的 page_demo 表中正常的记录共有 6 条，InnoDB 会把它们分成两组，第一组中只有一个最小记录，第二组中是剩余的 5 条记录。如下图：</p> <p><img src="/assets/img/page_solt2.c054e601.webp" alt="page_solt2"></p> <p>从这个图中我们需要注意这么几点：</p> <ul><li>现在页目录部分中有两个槽，也就意味着我们的记录被分成了两个组，槽 1 中的值是 112，代表最大记录的地址偏移量（就是从页面的 0 字节开始数，数 112 个字节）；槽 0 中的值是 99，代表最小记录的地址偏移量。</li> <li>注意最小和最大记录的头信息中的 n_owned 属性
<ul><li>最小记录的 n_owned 值为 1，这就代表着以最小记录结尾的这个分组中只有 1 条记录，也就是最小记录本身。</li> <li>最大记录的 n_owned 值为 5，这就代表着以最大记录结尾的这个分组中只有 5 条记录，包括最大记录本身还有我们自己插入的 4 条记录。</li></ul></li></ul> <p>用箭头指向的方式替代数字，这样更易于我们理解，修改后如下</p> <p><img src="/assets/img/page_solt3.cb9b0718.webp" alt="page_solt3"></p> <p><strong>举例 2：添加更多记录</strong></p> <p><img src="/assets/img/page_solt.8afbc7b8.webp" alt="page_solt"></p> <p><strong>页目录分组的过程</strong></p> <p>InnoDB 规定：对于最小记录所在的分组只能有 1 条记录，最大记录所在的分组拥有的记录条数只能在 1~8 条之间，剩下的分组中记录的条数范围只能在是 4~8 条之间。</p> <p>分组是按照下边的步骤进行的：</p> <ul><li>初始情况下一个数据页里只有最小记录和最大记录两条记录，它们分属于两个分组。</li> <li>之后每插入一条记录，都会从页目录中找到主键值比本记录的主键值大并且差值最小的槽，然后把该槽对应的记录的 n_owned 值加 1，表示本组内又添加了一条记录，直到该组中的记录数等于 8 个。</li> <li>在一个组中的记录数等于 8 个后再插入一条记录时，会将组中的记录拆分成两个组，一个组中 4 条记录，另一个 5 条记录。这个过程会在页目录中新增一个槽来记录这个新增分组中最大的那条记录的偏移量。</li></ul> <p><strong>页目录结构快速查找记录过程</strong></p> <p>在一个数据页中查找指定主键值的记录的过程分为两步：</p> <ul><li><p>通过二分法确定该记录所在的槽，并找到该槽所在分组中<strong>主键值最小的那条记录</strong>。</p></li> <li><p>通过记录的 next_record 属性遍历该槽所在的组中的各个记录。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>因为记录之间通过单链表连接，所以只能从左向右遍历</p></div> <h4 id="page-header-页面头部"><a href="#page-header-页面头部" class="header-anchor">#</a> Page Header（页面头部）</h4> <p>为了能得到一个数据页中存储的记录的状态信息，比如本页中已经存储了多少条记录，第一条记录的地址是什么，页目录中存储了多少个槽等等，特意在页中定义了一个叫 Page Header 的部分，这个部分占用固定的 56 个字节，专门存储各种状态信息。</p> <table><thead><tr><th style="text-align:left;">名称</th> <th style="text-align:left;">占用空间大小</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">PAGE_N_DIR_SLOTS</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">在页目录中的槽数量</td></tr> <tr><td style="text-align:left;">PAGE_HEAP_TOP</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">还未使用的空间最小地址，也就是说从该地址之后就是<code>Free Space</code></td></tr> <tr><td style="text-align:left;">PAGE_N_HEAP</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">本页中的记录的数量（包括最小和最大记录以及标记为删除的记录）</td></tr> <tr><td style="text-align:left;">PAGE_FREE</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">第一个已经标记为删除的记录的记录地址（各个已删除的记录通过<code>next_record</code>也会组成一个单链表，这个单链表中的记录可以被重新利用）</td></tr> <tr><td style="text-align:left;">PAGE_GARBAGE</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">已删除记录占用的字节数</td></tr> <tr><td style="text-align:left;">PAGE_LAST_INSERT</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">最后插入记录的位置</td></tr> <tr><td style="text-align:left;">PAGE_DIRECTION</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">记录插入的方向</td></tr> <tr><td style="text-align:left;">PAGE_N_DIRECTION</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">一个方向连续插入的记录数量</td></tr> <tr><td style="text-align:left;">PAGE_N_RECS</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">该页中记录的数量（不包括最小和最大记录以及被标记为删除的记录）</td></tr> <tr><td style="text-align:left;">PAGE_MAX_TRX_ID</td> <td style="text-align:left;">8 字节</td> <td style="text-align:left;">修改当前页的最大事务 ID，该值仅在二级索引中定义</td></tr> <tr><td style="text-align:left;">PAGE_LEVEL</td> <td style="text-align:left;">2 字节</td> <td style="text-align:left;">当前页在 B+树中所处的层级</td></tr> <tr><td style="text-align:left;">PAGE_INDEX_ID</td> <td style="text-align:left;">8 字节</td> <td style="text-align:left;">索引 ID，表示当前页属于哪个索引</td></tr> <tr><td style="text-align:left;">PAGE_BTR_SEG_LEAF</td> <td style="text-align:left;">10 字节</td> <td style="text-align:left;">B+树叶子段的头部信息，仅在 B+树的 Root 页定义</td></tr> <tr><td style="text-align:left;">PAGE_BTR_SEG_TOP</td> <td style="text-align:left;">10 字节</td> <td style="text-align:left;">B+树非叶子段的头部信息，仅在 B+树的 Root 页定义</td></tr></tbody></table> <p><strong>PAGE_DIRECTION</strong></p> <p>假如新插入的一条记录的主键值比上一条记录的主键值大，我们说这条记录的插入方向是右边，反之则是左边。用来表示最后一条记录插入方向的状态就是 PAGE_DIRECTION。</p> <p><strong>PAGE_N_DIRECTION</strong></p> <p>假设连续几次插入新记录的方向都是一致的，InnoDB 会把沿着同一个方向插入记录的条数记下来，这个条数就用 PAGE_N_DIRECTION 这个状态表示。当然，如果最后一条记录的插入方向改变了的话，这个状态的值会被清零重新统计。</p> <h2 id="_3-innodb-行格式-或记录格式"><a href="#_3-innodb-行格式-或记录格式" class="header-anchor">#</a> 3. InnoDB 行格式（或记录格式）</h2> <p>我们平时的数据以行为单位来向表中插入数据，这些记录在磁盘上的存放方式也被称为<code>行格式</code>或者<code>记录格式</code>。InnoDB 存储引擎设计了 4 种不同类型的<code>行格式</code>，分别是<code>Compact</code>、<code>Redundant</code>、<code>Dynamic</code>和<code>Compressed</code>行格式。</p> <p>查看 MySQL8 的默认行格式：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> @<span class="token variable">@innodb_default_row_format</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------------+</span>
<span class="token operator">|</span> @<span class="token variable">@innodb_default_row_format</span>         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------------+</span>
<span class="token operator">|</span> dynamic                             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>也可以使用如下语法查看具体表使用的行格式：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'表名'</span>\G
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-1-指定行格式的语法"><a href="#_3-1-指定行格式的语法" class="header-anchor">#</a> 3.1 指定行格式的语法</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名 <span class="token punctuation">(</span>列的信息<span class="token punctuation">)</span> ROW_FORMAT<span class="token operator">=</span>行格式名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 ROW_FORMAT<span class="token operator">=</span>行格式名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-2-compact-行格式"><a href="#_3-2-compact-行格式" class="header-anchor">#</a> 3.2 COMPACT 行格式</h3> <p>在 MySQL 5.1 版本中，默认设置为 Compact 行格式。一条完整的记录其实可以被分为<code>记录的额外信息</code>和<code>记录的真实数据</code>两大部分。</p> <p><img src="/assets/img/compact.916febfc.webp" alt="compact"></p> <h4 id="_1-变长字段长度列表"><a href="#_1-变长字段长度列表" class="header-anchor">#</a> 1）变长字段长度列表</h4> <p>MySQL 支持一些变长的数据类型，比如 VARCHAR(M)、VARBINARY(M)、TEXT 类型，BLOB 类型，这些数据类型修饰列称为<code>变长字段</code>，变长字段中存储多少字节的数据不是固定的，所以我们在存储真实数据的时候需要顺便把这些数据占用的字节数也存起来。<code>在 Compact 行格式中，把所有变长字段的真实数据占用的字节长度都存放在记录的开头部位，从而形成一个变长字段长度列表。</code></p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这里面存储的变长长度和字段顺序是反过来的。比如两个 varchar 字段在表结构的顺序是 a(10)，b(15)。那么在变长字段长度列表中存储的长度顺序就是 15，10，是反过来的。</p></div> <p><strong>举例</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> record_test_table <span class="token punctuation">(</span>
	col1 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	col2 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	col3 <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	col4 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>ascii ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>以 record_test_table 表中的第一条记录举例：因为 record_test_table 表的 col1、col2、col4 列都是 <code>VARCHAR(8)</code> 类型的，所以这三个列的值的长度都需要保存在记录开头处，注意 record_test_table 表中的各个列都使用的是 ascii 字符集（每个字符只需要 1 个字节来进行编码）。</p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">存储内容</th> <th style="text-align:left;">内容长度（十进制表示）</th> <th style="text-align:left;">内容长度（十六进制表示）</th></tr></thead> <tbody><tr><td style="text-align:left;">col1</td> <td style="text-align:left;">zhangsan</td> <td style="text-align:left;">8</td> <td style="text-align:left;">0x08</td></tr> <tr><td style="text-align:left;">col2</td> <td style="text-align:left;">lisi</td> <td style="text-align:left;">4</td> <td style="text-align:left;">0x04</td></tr> <tr><td style="text-align:left;">col4</td> <td style="text-align:left;">songhk</td> <td style="text-align:left;">6</td> <td style="text-align:left;">0x06</td></tr></tbody></table> <p>又因为这些长度值需要按照列的逆序存放，所以最后变长字段长度列表的字节串用十六进制表示的效果就是（各个字节之间实际上没有空格，用空格隔开只是方便理解）：06 04 08</p> <p>把这个字节串组成的变长字段长度列表填入上边的示意图中的效果就是：</p> <p><img src="data:image/webp;base64,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" alt="variable_length_fields"></p> <h4 id="_2-null-值列表-null-bitmap"><a href="#_2-null-值列表-null-bitmap" class="header-anchor">#</a> 2）NULL 值列表(NULL bitmap)</h4> <p>Compact 行格式会把可以为 NULL 的列统一管理起来，存在一个标记为 NULL 值列表中。如果表中没有允许存储 NULL 的列，则 NULL 值列表也不存在了。</p> <p><strong>为什么定义 NULL 值列表？</strong></p> <p>之所以要存储 NULL 是因为数据都是需要对齐的，如果<code>没有标注出来 NULL 值的位置</code>，就有可能在查询数据的时候<code>出现混乱</code>。如果使用<code>一个特定的符号</code>放到相应的数据位表示空置的话，虽然能达到效果，但是这样很浪费空间，所以直接就在行数据得头部开辟出一块空间专门用来记录该行数据哪些是非空数据，哪些是空数据，格式如下：</p> <ul><li><p>二进制位的值为 1 时，代表该列的值为 NULL。</p></li> <li><p>二进制位的值为 0 时，代表该列的值不为 NULL。</p></li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>同样顺序也是反过来存放的</p></div> <p><strong>例如：</strong></p> <p>字段 a、b、c，其中 a 是主键，在某一行中存储的数依次是 a=1、b=null、c=2。那么 Compact 行格式中的 NULL 值列表中存储：01。第一个 0 表示 c 不为 null，第二个 1 表示 b 是 null。这里之所以没有 a 是因为数据库会自动跳过主键，因为主键肯定是非 NULL 且唯一的，在 NULL 值列表的数据中就会自动跳过主键。</p> <p><strong>举例:以上面 record_test_table 表为例</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> record_test_table<span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">,</span> col3<span class="token punctuation">,</span> col4<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span> <span class="token string">'wangwu'</span><span class="token punctuation">,</span> <span class="token string">'songhk'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">(</span><span class="token string">'tong'</span><span class="token punctuation">,</span> <span class="token string">'chen'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/assets/img/null_bitmap.a8bb87a6.webp" alt="null_bitmap"></p> <h4 id="_3-记录头信息-5-字节"><a href="#_3-记录头信息-5-字节" class="header-anchor">#</a> 3）记录头信息（5 字节）</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> page_demo<span class="token punctuation">(</span>
    c1 <span class="token keyword">INT</span><span class="token punctuation">,</span>
    c2 <span class="token keyword">INT</span><span class="token punctuation">,</span>
    c3 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>c1<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>ascii ROW_FORMAT<span class="token operator">=</span>Compact<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> page_demo 
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'song'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'tong'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token string">'zhan'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">'lisi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/assets/img/compact_head.65f8a166.webp" alt="compact_head"></p> <table><thead><tr><th style="text-align:left;">名称</th> <th style="text-align:left;">大小（单位：bit）</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>预留位1</code></td> <td style="text-align:left;">1</td> <td style="text-align:left;">没有使用</td></tr> <tr><td style="text-align:left;"><code>预留位2</code></td> <td style="text-align:left;">1</td> <td style="text-align:left;">没有使用</td></tr> <tr><td style="text-align:left;"><code>delete_mask</code></td> <td style="text-align:left;">1</td> <td style="text-align:left;">标记该记录是否被删除</td></tr> <tr><td style="text-align:left;"><code>mini_rec_mask</code></td> <td style="text-align:left;">1</td> <td style="text-align:left;">B+树的每层非叶子节点中的最小记录都会添加该标记</td></tr> <tr><td style="text-align:left;"><code>n_owned</code></td> <td style="text-align:left;">4</td> <td style="text-align:left;">表示当前记录拥有的记录数</td></tr> <tr><td style="text-align:left;"><code>heap_no</code></td> <td style="text-align:left;">13</td> <td style="text-align:left;">表示当前记录在记录堆的位置信息</td></tr> <tr><td style="text-align:left;"><code>record_type</code></td> <td style="text-align:left;">3</td> <td style="text-align:left;">表示当前记录的类型，<code>0</code>表示普通记录，<code>1</code>表示 B+树非叶子节点记录，<code>2</code>表示最小记录，<code>3</code>表示最大记录</td></tr> <tr><td style="text-align:left;"><code>next_record</code></td> <td style="text-align:left;">16</td> <td style="text-align:left;">表示下一条记录的相对位置</td></tr></tbody></table> <ul><li><code>delete_mask</code>：这个属性标记着当前记录是否被删除，占用 1 个二进制位。
<ul><li>值为 0：代表记录并没有被删除</li> <li>值为 1：代表记录被删除掉了</li></ul></li></ul> <div class="custom-block note"><p class="custom-block-title">被删除的记录为什么还在页中存储呢？</p> <p>你以为它删除了，可它还在真实的磁盘上。这些被删除的记录之所以不立即从磁盘上移除，是因为移除它们之后其他的记录在磁盘上需要<code>重新排列，导致性能消耗</code>。所以只是打一个删除标记而已，所有被删除掉的记录都会组成一个所谓的<code>垃圾链表</code>，在这个链表中的记录占用的空间称之为<code>可重用空间</code>，之后如果有新记录插入到表中的话，可能把这些被删除的记录占用的存储空间覆盖掉。</p></div> <ul><li><code>min_rec_mask</code>：B+树的每层非叶子节点中的最小记录都会添加该标记，min_rec_mask 值为 1。我们自己插入的四条记录的 min_rec_mask 值都是 0，意味着它们都不是 B+树的非叶子节点中的最小记录。</li> <li><code>record_type</code>：这个属性表示当前记录的类型，一共有 4 种类型的记录：
<ul><li>0：表示普通记录</li> <li>1：表示 B+树非叶节点记录</li> <li>2：表示最小记录</li> <li>3：表示最大记录</li></ul></li> <li><code>heap_no</code>：这个属性表示当前记录在本页中的位置。</li></ul> <div class="custom-block note"><p class="custom-block-title">heap_no 值为 0 和 1 的记录</p> <p>MySQL 会自动给每个页里加了两个记录，由于这两个记录并不是我们自己插入的，所以有时候也称为<code>伪记录</code>或者<code>虚拟记录</code>。这两个伪记录一个代表<code>最小记录</code>，一个代表<code>最大记录</code>。最小记录和最大记录的 heap_no 值分别是 0 和 1，也就是说它们的位置最靠前</p></div> <ul><li><p><code>n_owned</code>：页目录中每个组中最后一条记录的头信息中会存储该组一共有多少条记录，作为 n_owned 字段</p></li> <li><p><code>next_record</code>：记录头信息里该属性非常重要，它表示从当前记录的真实数据到下一条记录的真实数据的<code>地址偏移量</code>。</p></li></ul> <p>比如：第一条记录的 next_record 值为 32，意味着从第一条记录的真实数据的地址处向后找 32 个字节便是下一条记录的真实数据。<strong>注意，下一条记录指得并不是按照我们插入顺序的下一条记录，而是按照主键值由小到大的顺序的下一条记录。</strong> 而且规定 Infimum 记录（也就是最小记录）的下一条记录就是本页中主键值最小的用户记录，而本页中主键值最大的用户记录的下一条记录就是 Supremum 记录（也就是最大记录）。</p> <p>下图用箭头代替偏移量表示 next_record。</p> <p><img src="/assets/img/compact_head2.0f124e30.webp" alt="compact_head2"></p> <p><strong>删除操作</strong></p> <p>从表中删除掉一条记录，这个链表也是会跟着变化：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> page_demo <span class="token keyword">WHERE</span> c1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/delete_compact_head.b09abdcd.webp" alt="delete_compact_head"></p> <p>从图中可以看出来，删除第 2 条记录前后主要发生了这些变化：</p> <ul><li>第 2 条记录并没有从存储空间中移除，而是把该条记录的 delete_mask 值设置为 1。</li> <li>第 2 条记录的 next_record 值变为了 0，意味着该记录没有下一条记录了。</li> <li>第 1 条记录的 next_record 指向了第 3 条记录。</li> <li>最大记录的 n_owned 值从 5 变成了 4。</li></ul> <p><strong>添加操作</strong></p> <p>主键值为 2 的记录被我们删掉了，但是存储空间却没有回收，如果我们再次把这条记录插入到表中，会发生什么事呢？</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> page_demo <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'tong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/add_compact_head.6be34503.webp" alt="add_compact_head"></p> <p>直接复用了原来被删除记录的存储空间。</p> <div class="custom-block tip"><p class="custom-block-title">说明</p> <p>当数据页中存在多条被删除掉的记录时，这些记录的 next_record 属性将会把这些被删除掉的记录组成一个垃圾链表，以备之后重用这部分存储空间。</p></div> <h4 id="_4-记录的真实数据"><a href="#_4-记录的真实数据" class="header-anchor">#</a> 4）记录的真实数据</h4> <p>记录的真实数据除了我们自己定义的列的数据以外，还会有三个隐藏列：</p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">是否必须</th> <th style="text-align:left;">占用空间</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">row_id</td> <td style="text-align:left;">否</td> <td style="text-align:left;">6 字节</td> <td style="text-align:left;">行 ID，唯一标识一条记录</td></tr> <tr><td style="text-align:left;">transaction_id</td> <td style="text-align:left;">是</td> <td style="text-align:left;">6 字节</td> <td style="text-align:left;">事务 ID</td></tr> <tr><td style="text-align:left;">roll_pointer</td> <td style="text-align:left;">是</td> <td style="text-align:left;">7 字节</td> <td style="text-align:left;">回滚指针</td></tr></tbody></table> <p>实际上这几个列的真正名称其实是：<code>DB_ROW_ID</code>、<code>DB_TRX_ID</code>、<code>DB_ROLL_PTR</code>。</p> <p>一个表没有手动定义主键，则会选取一个 Unique 键作为主键，如果连 Unique 键都没有定义的话，则会为表默认添加一个名为 row_id 的隐藏列作为主键。所以 row_id 是在没有自定义主键以及 Unique 键的情况下才会存在的。</p> <h4 id="_5-举例-分析-compact-行记录的内部结构"><a href="#_5-举例-分析-compact-行记录的内部结构" class="header-anchor">#</a> 5）举例：分析 Compact 行记录的内部结构</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> mytest<span class="token punctuation">(</span>
	col1 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	col2 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	col3 <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	col4 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>LATIN1 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> mytest
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'bb'</span><span class="token punctuation">,</span><span class="token string">'bb'</span><span class="token punctuation">,</span><span class="token string">'ccc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'ee'</span><span class="token punctuation">,</span><span class="token string">'ee'</span><span class="token punctuation">,</span><span class="token string">'fff'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'fff'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>在 Windows 操作系统下，可以选择通过程序 UltraEdit 打开表空间文件 <code>mytest.ibd</code> 这个二进制文件</p> <div class="language-wiki line-numbers-mode"><pre class="language-wiki"><code><span class="token hr punctuation">------------------------------------------------------------------------------------------</span>
0000c070 73 75 70 72 65 6d 75 6d 03 02 01 00 00 00 10 00|supremum........|
0000c080 2c 00 00 00 2b 68 00 00 00 00 00 06 05 80 00 00|,...+h..........|
0000c090 00 32 01 10 61 62 62 62 62 20 20 20 20 20 20 20|.2..abbbb|
0000c0a0 20 63 63 63 03 02 01 00 00 00 18 00 2b 00 00 00|ccc........+...|
0000c0b0 2b 68 01 00 00 00 00 06 06 80 00 00 00 32 01 10|+h...........2..|
0000c0c0 64 65 65 65 65 20 20 20 20 20 20 20 20 66 66 66|deeeefff|
0000c0d0 03 01 06 00 00 20 ff 98 00 00 00 2b 68 02 00 00|..........+h...|
0000c0e0 00 00 06 07 80 00 00 00 32 01 10 64 66 66 66 00|........2..dfff.|
<span class="token hr punctuation">------------------------------------------------------------------------------------------</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>第一条数据分析</strong><code>('a','bb','bb','ccc')</code></p> <table><thead><tr><th style="text-align:left;">十六进制码</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>73 75 70 72 65 6d 75 6d</code></td> <td style="text-align:left;">supremum 最大记录结尾</td></tr> <tr><td style="text-align:left;"><code>03 02 01</code></td> <td style="text-align:left;"><strong>变长字段长度列表，逆序</strong><br>col4 的值为 ccc，长度为 3，col2 的值为 bb，长度为 2，<br>col1 的值为 a，长度为 1</td></tr> <tr><td style="text-align:left;"><code>00</code></td> <td style="text-align:left;"><strong>NULL 标志位</strong>，第一条没有 NULL 值</td></tr> <tr><td style="text-align:left;"><code>00 00 10</code></td> <td style="text-align:left;"><strong>Record Header，固定 5 字节长度</strong><br>预留位 1 和 2、delete_mask、mini_rec_mask 都是 0，占 4 位<code>0</code> <br>n_owned 占 4 位 <code>0</code><br><code>0010</code><br>heap_no 占十三位，由于是第 2 条记录，0 和 1 是最小最大记录，所以二进制 <code>0000 0000 0001 0</code> <br>record_type 占三位，普通记录，所以二进制 <code>000</code></td></tr> <tr><td style="text-align:left;"><code>00 2C</code></td> <td style="text-align:left;">next_record，<strong>指向下一条记录 next_record 字段的末尾</strong><br>本条记录的 next_record 字段末尾距离<br>下一条记录的 next_record 末尾相差 44 个字节<br>所以本条记录的 next_reocrd 是 44 个字节，16 进制 2C</td></tr> <tr><td style="text-align:left;"><code>00 00 00 2b 68 00</code></td> <td style="text-align:left;"><strong>RowID InnoDB 自动创建，6 字节</strong></td></tr> <tr><td style="text-align:left;"><code>00 00 00 00 06 05</code></td> <td style="text-align:left;"><strong>TransactionID</strong></td></tr> <tr><td style="text-align:left;"><code>80 00 00 00 32 01 10</code></td> <td style="text-align:left;"><strong>Roll Pointer</strong></td></tr> <tr><td style="text-align:left;"><code>61</code></td> <td style="text-align:left;">列 1 数据'a'</td></tr> <tr><td style="text-align:left;"><code>62 62</code></td> <td style="text-align:left;">列 2 数据'bb'</td></tr> <tr><td style="text-align:left;"><code>62 62 20 20 20 20 20 20 20 20</code></td> <td style="text-align:left;">列 3 数据'bb'，由于类型是 char(10)，20 代表空格，填充 8 个空格</td></tr> <tr><td style="text-align:left;"><code>63 63 63</code></td> <td style="text-align:left;">列 4 数据'ccc'</td></tr></tbody></table> <p>注意 1：InnoDB 每行有隐藏列 TransactionID 和 Roll Pointer。</p> <p>注意 2：固定长度 CHAR 字段在未能完全占用其长度空间时，会用 0x20 来进行填充。</p> <p>注意 3：Record Header 的最后两个字节，这两个字节代表 next_recorder，0x2c 代表下一个记录的偏移量，<strong>当前记录的 next_record 字段末尾，加上偏移量 0x2c 个字节，就是下条记录 next_record 字段末尾。</strong></p> <p><strong>分析有 NULL 值的第三条数据</strong><code>('d',NULL,NULL,'fff')</code></p> <div class="language-wiki line-numbers-mode"><pre class="language-wiki"><code><span class="token hr punctuation">---------------------------------------------------------------------</span>
03 01                       <span class="token block-comment comment">/*变长字段长度列表，逆序*/</span>
06                          <span class="token block-comment comment">/*NULL标志位，第三行有NULL值*/</span>
00 00 20 ff 98              <span class="token block-comment comment">/*Record Header*/</span>
00 00 00 2b 68 02           <span class="token block-comment comment">/*RowID*/</span>
00 00 00 00 06 07           <span class="token block-comment comment">/*TransactionID*/</span>
80 00 00 00 32 01 10        <span class="token block-comment comment">/*Roll Pointer*/</span>
64                          <span class="token block-comment comment">/*列1数据'd'*/</span>
66 66 66                    <span class="token block-comment comment">/*列4数据'fff'*/</span>
<span class="token hr punctuation">---------------------------------------------------------------------</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>第三行有 NULL 值，因此 NULL 标志位不再是 00 而是 06，转换成二进制为 00000110，为 1 的值代表第 2 列和第 3 列的数据为 NULL。在其后存储列数据的部分，用户会发现没有存储 NULL 列，而只存储了第 1 列和第 4 列非 NULL 的值。</p> <p>因此这个例子很好地说明了：不管是 CHAR 类型还是 VARCHAR 类型，在 compact 格式下 NULL 值都不占用任何存储空间。</p> <p><strong>next_record</strong></p> <p>第三条记录的 next_record 的值是<code>ff 98</code>，是一个负数，负的 104 个字节 <code>43+44+17=104</code></p> <p>第三条记录是最后一条记录，最后一条记录的 next_record 字段指向最大记录</p> <p>第二条记录 next_record 是 43，即第二条记录的 next_record 字段结尾距离第三条记录的 next_record 字段结尾，相差 43 个字节</p> <p>第一条记录的 next_record 是 44</p> <p>第一条记录的 next_record 字段结尾距离最大记录的 next_record 字段末尾，相差 17 个字节</p> <p>所以第三条记录的 next_record 的值是负 104</p> <h3 id="_3-3-dynamic-和-compressed-行格式"><a href="#_3-3-dynamic-和-compressed-行格式" class="header-anchor">#</a> 3.3 Dynamic 和 Compressed 行格式</h3> <p><strong>VARCHAR(M)类型，最多可以存放字节数</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>  <span class="token keyword">TABLE</span>  varchar_size_demo<span class="token punctuation">(</span>
	c  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>  <span class="token keyword">CHARSET</span><span class="token operator">=</span>ascii  ROW_FORMAT<span class="token operator">=</span>Compact<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ERROR <span class="token number">1118</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span>: Row size too large. The maximum row size <span class="token keyword">for</span> the used table type, not counting BLOBs, is <span class="token number">65535</span>. This includes storage overhead, check the manual. You have  to  change  some  columns  to  TEXT or  BLOBs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>报错信息表达的意思是：MySQL 对一条记录占用的最大存储空间是有限制的，除 BLOB 或者 TEXT 类型的列之外， 其他所有的列（不包括隐藏列和记录头信息）占用的字节长度加起来不能超过 65535 个字节。</p> <p>这个 65535 个字节除了列本身的数据之外，还包括一些其他的数据，以 Compact 行格式为例，比如说我们为了存储一个 VARCHAR(M)类型的列，除了真实数据占有空间以外，还需要记录的额外信息。</p> <p>如果该 VARCHAR 类型的列没有 NOT NULL 属性，那最多只能存储 65532 个字节的数据，因为变长字段的长度占用 2 个字节，NULL 值标识需要占用 1 个字节。</p> <p>如果有 not null 属性，那么就不需要 NULL 值标识，也就可以多存储一个字节，即 65533 个字节</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>  <span class="token keyword">TABLE</span>  varchar_size_demo<span class="token punctuation">(</span>
	c  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">65532</span><span class="token punctuation">)</span>          <span class="token comment"># 65533 + 2个字节的变长字段的长度 + 1NULL值标识</span>
    ch <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">65533</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token comment"># 65533 + 2个字节的变长字段的长度</span>
<span class="token punctuation">)</span>  <span class="token keyword">CHARSET</span><span class="token operator">=</span>ascii  ROW_FORMAT<span class="token operator">=</span>Compact<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>行溢出</strong></p> <p>我们可以知道一个页的大小一般是 16KB，也就是 16384 字节，而一个 VARCHAR(M)类型的列就最多可以存储 65533 个字节，这样就可能出现一个页存放不了一条记录，这种现象称为<code>行溢出</code></p> <p>在 Compact 和 Reduntant 行格式中，对于占用存储空间非常大的列，在记录的真实数据处只会存储该列的一部分数据，把剩余的数据分散存储在几个其他的页中进行<code>分页存储</code>，然后记录的真实数据处用 20 个字节存储指向这些页的地址（当然这 20 个字节中还包括这些分散在其他页面中的数据的占用的字节数），从而可以找到剩余数据所在的页。这称为<code>页的扩展</code>。</p> <p><img src="data:image/webp;base64,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" alt="page_extension"></p> <p>在 MySQL 8.0 中，默认行格式就是 Dynamic，Dynamic、Compressed 行格式和 Compact 行格式挺像，只不过在处理行溢出数据时有分歧</p> <ul><li>Compressed 和 Dynamic 两种记录格式对于存放在 BLOB 中的数据采用了完全的行溢出的方式。在数据页中只存放 20 个字节的指针（溢出页的地址），实际的数据都存放在 Off Page（溢出页）中。</li> <li>Compact 和 Redundant 两种格式会在记录的真实数据处存储一部分数据（存放 768 个前缀字节）。</li></ul> <p>Compressed 行记录格式的另一个功能就是，存储在其中的行数据会以 zlib 的算法进行压缩，因此对于 BLOB、TEXT、VARCHAR 这类大长度类型的数据能够进行非常有效的存储。</p> <h3 id="_3-4-redundant-行格式"><a href="#_3-4-redundant-行格式" class="header-anchor">#</a> 3.4 Redundant 行格式</h3> <p>Redundant 是 MySQL 5.0 版本之前 InnoDB 的行记录存储方式，MySQL 5.0 支持 Redundant 是为了兼容之前版本的页格式。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> record_test_table ROW_FORMAT<span class="token operator">=</span>Redundant<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/Redundant.aab739a2.webp" alt="Redundant"></p> <p>从上图可以看到，不同于 Compact 行记录格式，Redundant 行格式的首部是一个字段长度偏移列表，同样是按照列的顺序逆序放置的。</p> <p><strong>字段长度偏移列表</strong></p> <p>注意 Compact 行格式的开头是变长字段长度列表，而 Redundant 行格式的开头是字段长度偏移列表，与变长字段长度列表有两处不同：</p> <ul><li>少了“变长”两个字：Redundant 行格式会把该条记录中所有列（包括隐藏列）的长度信息都按照逆序存储到字段长度偏移列表。</li> <li>多了“偏移”两个字：这意味着计算列值长度的方式不像 Compact 行格式那么直观，它是采用两个相邻数值的差值来计算各个列值的长度。</li></ul> <p>举例：比如第一条记录的字段长度偏移列表就是：
2B 25 1F 1B 13 0C 06</p> <p>因为它是逆序排放的，所以按照列的顺序排列就是：
06 0C 13 17 1A 24 25</p> <p>按照两个相邻数值的差值来计算各个列值的长度的意思就是：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>第一列(row_id)的长度就是 0x06个字节，也就是6个字节。
第二列(transaction_id)的长度就是 (0x0C - 0x06)个字节，也就是6个字节。
第三列(roll_pointer)的长度就是 (0x13 - 0x0C)个字节，也就是7个字节。
第四列(col1)的长度就是 (0x1B - 0x13)个字节，也就是8个字节。
第五列(col2)的长度就是 (0x1F - 0x1B)个字节，也就是4个字节。
第六列(col3)的长度就是 (0x25 - 0x1F)个字节，也就是6个字节。
第七列(col4)的长度就是 (0x2B - 0x25)个字节，也就是6个字节。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>记录头信息(record header)</strong></p> <p>不同于 Compact 行格式，Redundant 行格式中的记录头信息固定占用 6 个字节（48 位），每位的含义见下表。</p> <table><thead><tr><th style="text-align:left;">名称</th> <th style="text-align:left;">大小(bit)</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">（）</td> <td style="text-align:left;">1</td> <td style="text-align:left;">未使用</td></tr> <tr><td style="text-align:left;">（）</td> <td style="text-align:left;">1</td> <td style="text-align:left;">未使用</td></tr> <tr><td style="text-align:left;">deleted_mask</td> <td style="text-align:left;">1</td> <td style="text-align:left;">该行是否已被删除</td></tr> <tr><td style="text-align:left;">min_rec_mask</td> <td style="text-align:left;">1</td> <td style="text-align:left;">B+树的每层非叶子节点中的最小记录都会添加该标记</td></tr> <tr><td style="text-align:left;">n_owned</td> <td style="text-align:left;">4</td> <td style="text-align:left;">该记录拥有的记录数</td></tr> <tr><td style="text-align:left;">heap_no</td> <td style="text-align:left;">13</td> <td style="text-align:left;">索引堆中该条记录的位置信息</td></tr> <tr><td style="text-align:left;"><code>n_fields</code></td> <td style="text-align:left;">10</td> <td style="text-align:left;">记录中列的数量</td></tr> <tr><td style="text-align:left;"><code>1byte_offs_flag</code></td> <td style="text-align:left;">1</td> <td style="text-align:left;">记录字段长度偏移列表中每个列对应的偏移量<br>使用 1 个字节还是 2 个字节表示</td></tr> <tr><td style="text-align:left;">next_record</td> <td style="text-align:left;">16</td> <td style="text-align:left;">页中下一条记录的绝对位置</td></tr></tbody></table> <p><strong>与 Compact 行格式的记录头信息对比来看，有两处不同：</strong></p> <ul><li>Redundant 行格式多了 n_field 和 1byte_offs_flag 这两个属性。</li> <li>Redundant 行格式没有 record_type 这个属性。</li></ul> <p><code>n_fields</code>：代表一行中列的数量，占用 10 位，所以 MySQL 一个行支持最多的列为 1023。<code>1byte_offs_flags</code>，定义了偏移列表占用 1 个字节还是 2 个字节。当它的值为 1 时，表明使用 1 个字节存储。当它的值为 0 时，表明使用 2 个字节存储。</p> <p><strong>1byte_offs_flag 的值是怎么选择的</strong></p> <p>每个列对应的偏移量可以占用 1 个字节或者 2 个字节来存储，那到底什么时候用 1 个字节，什么时候用 2 个字节呢？其实是根据该条 Redundant 行格式记录的真实数据占用的总大小来判断的：</p> <ul><li>当记录的真实数据占用的字节数值不大于 127（十六进制 0x7F，二进制 01111111）时，每个列对应的偏移量占用 1 个字节。</li> <li>当记录的真实数据占用的字节数大于 127，但不大于 32767（十六进制 0x7FFF，二进制 0111111111111111）时，每个列对应的偏移量占用 2 个字节。</li></ul> <p>有没有记录的真实数据大于 32767 的情况呢？有，不过此时的记录已经存放到了溢出页中，在本页中只保留前 768 个字节和 20 个字节的溢出页面地址。因为字段长度偏移列表处只需要记录每个列在本页面中的偏移就好了，所以每个列使用 2 个字节来存储偏移量就够了。</p> <p>大家可以看出来，Redundant 行格式还是比较简单粗暴的，直接使用整个记录的真实数据长度来决定使用 1 个字节还是 2 个字节存储列对应的偏移量。只要整条记录的真实数据占用的存储空间大小大于 127，即使第一个列的值占用存储空间小于 127，那对不起，也需要使用 2 个字节来表示该列对应的偏移量。简单粗暴，就是这么简单粗暴（所以这种行格式有些过时了）。</p> <p>为了在解析记录时知道每个列的偏移量是使用 1 个字节还是 2 个字节表示的，Redundant 行格式特意在<code>记录头信息</code>里放置了一个称之为 1byte_offs_flag 的属性</p> <p><strong>Redundant 行格式中 NULL 值的处理</strong></p> <p>因为 Redundant 行格式并没有 NULL 值列表，所以 Redundant 行格式在字段长度偏移列表中的各个列对应的偏移量处做了一些特殊处理————将列对应的偏移量值的第一个比特位作为是否为 NULL 的依据，该比特位也可以被称之为 NULL 比特位。也就是说在解析一条记录的某个列时，首先<code>看一下该列对应的偏移量的 NULL 比特位是不是为 1。</code>如果为 1，那么该列的值就是 NULL，否则不是 NULL。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>这也就解释了上边介绍为什么只要记录的真实数据大于 127（十六进制 0x7F，二进制 01111111）时，就采用 2 个字节来表示一个列对应的偏移量，主要是第一个比特位是所谓的 NULL 比特位，用来标记该列的值是否为 NULL。</p></div> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> record_test_table <span class="token punctuation">(</span>
	c1 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	c2 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	c3 <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	c4 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>ascii ROW_FORMAT<span class="token operator">=</span>REDUNDANT<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> record_test_table<span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">,</span> col3<span class="token punctuation">,</span> col4<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span> <span class="token string">'wangwu'</span><span class="token punctuation">,</span> <span class="token string">'songhk'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">(</span><span class="token string">'tong'</span><span class="token punctuation">,</span> <span class="token string">'tom'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>但是还有一点要注意，对于值为 NULL 的列来说，该列的类型是否为定长类型决定了 NULL 值的实际存储方式，我们接下来分析一下 record_test_table 表的第二条记录，它对应的字段长度偏移列表如下</p> <p>A4 A4 1A 17 13 0C 06</p> <p>按照列的顺序排放就是：</p> <p>06 0C 13 17 1A A4 A4</p> <p>我们分情况看一下：</p> <ul><li><p>如果存储 NULL 值的字段是定长类型的，比方说<code>CHAR(M)</code>数据类型的，则 NULL 值也将占用记录的真实数据部分，并把该字段对应的数据使用 0x00 字节填充。</p> <p>第二条记录的 c3 列的值是 NULL，而 c3 列的类型是<code>CHAR(10)</code>，占用记录的真实数据部分 10 字节，所以我们看到在 Redundant 行格式中使用 0x00000000000000000000 来表示 NULL 值。</p> <p>另外，c3 列对应的偏移量为 0xA4，它对应的二进制实际是：10100100，可以看到最高位为 1，意味着该列的值是 NULL。将最高位去掉后的值变成了 0100100，对应的十进制值为 36，而 c2 列对应的偏移量为 0x1A，也就是十进制的 26。36 - 26 = 10，也就是说最终 c3 列占用的存储空间为 10 个字节。</p></li> <li><p>如果该存储 NULL 值的字段是变长数据类型的，则不在记录的真实数据处占用任何存储空间。</p> <p>比如 record_test_table 表的 c4 列是 VARCHAR(10)类型的，VARCHAR(10)是一个变长数据类型，c4 列对应的偏移量为 0xA4，与 c3 列对应的偏移量相同，这也就意味着它的值也为 NULL，将 0xA4 的最高位去掉后对应的十进制值也是 36，36 - 36 = 0，也就意味着 c4 列本身不占用任何记录的实际数据处的空间。</p> <p>除了以上的几点之外，Redundant 行格式和 Compact 行格式还是大致相同的。</p></li></ul> <h2 id="_4-区、段和碎片区"><a href="#_4-区、段和碎片区" class="header-anchor">#</a> 4. 区、段和碎片区</h2> <h3 id="_4-1-为什么要有区"><a href="#_4-1-为什么要有区" class="header-anchor">#</a> 4.1 为什么要有区？</h3> <p><code>B+</code>树的每一层中的页都会形成一个双向链表，如果是以<code>页为单位</code>来分配存储空间的话，双向链表相邻的两个页之间的<code>物理位置可能离得非常远</code>。我们介绍 B+树索引的使用场景的时候特别提到范围查询只需要定位到最左边的记录和最右边的记录，然后沿着双向链表一直扫描就可以了，而如果链表中相邻的两个页物理位置离得非常远，就是所谓的<code>随机 I/O</code>。再一次强调，磁盘的速度和内存的速度差了好几个数量级，<code>随机 I/O 是非常慢</code>的，所以我们应该尽量让链表中相邻的页的物理位置也相邻，这样进行范围查询的时候才可以使用所谓的<code>顺序 I/O</code>。</p> <p>引入<code>区</code>的概念，一个区就是物理位置上连续的<code>64 个页</code>。因为 InnoDB 中的页的大小默认是 16KB，所以一个区的大小是 64*16KB=<code>1MB</code>。在表中<code>数据量大</code>的时候，为某个索引分配空间的时候就不再按照页的单位分配了，而是按照<code>区为单位分配</code>，甚至在表中的数据特别多的时候，可以一次性分配多个连续的区。虽然可能造成<code>一点点空间的浪费</code>（数据不足以填充满整个区），但是从性能角度看，可以消除很多的随机 I/O，<code>功大于过</code>！</p> <h3 id="_4-2-为什么要有段"><a href="#_4-2-为什么要有段" class="header-anchor">#</a> 4.2 为什么要有段？</h3> <p>对于范围查询，其实是对 B+树叶子节点中的记录进行顺序扫描，而如果不区分叶子节点和非叶子节点，统统把节点代表的页面放到申请到的区中的话，进行范围扫描的效果就大打折扣了。所以 InnoDB 对 B+树的<code>叶子节点</code>和<code>非叶子节点</code>进行了区别对待，也就是说叶子节点有自己独有的区，非叶子节点也有自己独有的区。存放叶子节点的区的集合就算是一个<code>段（segment）</code>，存放非叶子节点的区的集合也算是一个段。也就是说一个索引会生成 2 个段，一个<code>叶子节点段</code>，一个<code>非叶子节点段</code>。</p> <p>除了索引的叶子节点段和非叶子节点段之外，InnoDB 中还有为存储一些特殊的数据而定义的段，比如回滚段。所以，常见的段有<code>数据段</code>、<code>索引段</code>、<code>回滚段</code>。数据段即为 B+树的叶子节点，索引段即为 B+树的非叶子节点。</p> <p>在 InnoDB 存储引擎中，对段的管理都是由引擎自身所完成，DBA 不能也没有必要对其进行控制。这从一定程度上简化了 DBA 对于段的管理。</p> <p>段其实不对应表空间中的某一个连续的物理区域，而是一个逻辑上的概念，由若干个零散的页面以及一些完整的区组成。</p> <h3 id="_4-3-为什么要有碎片区"><a href="#_4-3-为什么要有碎片区" class="header-anchor">#</a> 4.3 为什么要有碎片区？</h3> <p>默认情况下，一个使用 InnoDB 存储引擎的表只有一个聚簇索引，一个索引会生成 2 个段，而段是以区为单位申请存储空间的，一个区默认占用 1M(64*16KB=1024KB)存储空间，所以<strong>默认情况下一个只存在几条记录的小表也需要 2M 的存储空间么？</strong> 以后每次添加一个索引都要多申请 2M 的存储空间么？这对于存储记录比较少的表简直是天大的浪费。这个问题的症结在于到现在为止我们介绍的区都是非常<code>纯粹</code>的，也就是一个区被整个分配给某一个段，或者说区中的所有页面都是为了存储同一个段的数据而存在的，即使段的数据填不满区中所有的页面，那余下的页面也不能挪作他用。</p> <p>为了考虑以完整的区为单位分配给某个段对于<code>数据量较小</code>的表太浪费存储空间的这种情况，InnoDB 提出了一个<code>碎片（fragment）区</code>的概念。在一个碎片区中，并不是所有的页都是为了存储同一个段的数据而存在的，而是碎片区中的页可以用于不同的目的，比如有些页面用于段 A，有些页面用于段 B，有些页甚至哪个段都不属于。<code>碎片区直属于表空间</code>，并不属于任何一个段。</p> <p>所以此后为某个段分配存储空间的策略是这样的：</p> <ul><li>在刚开始向表中插入数据的时候，段是从某个碎片区以单个页面为单位来分配存储空间的。</li> <li>当某个段已经占用了<code>32 个碎片区</code>页面之后，就会申请以完整的区为单位来分配存储空间。</li></ul> <p>所以现在段不能仅定义为是某些区的集合，更精确的应该是<code>某些零散的页面</code>已经<code>一些完整的区</code>的集合。</p> <h3 id="_4-4-区的分类"><a href="#_4-4-区的分类" class="header-anchor">#</a> 4.4 区的分类</h3> <p>区大体上可以分为 4 种类型：</p> <ul><li><code>空闲的区(FREE)</code>：现在还没有用到这个区中的任何页面。</li> <li><code>有剩余空间的碎片区(FREE_FRAG)</code>：表示碎片区中还有可用的页面。</li> <li><code>没有剩余空间的碎片区(FULL_FRAG)</code>：表示碎片区中的所有页面都被使用，没有空闲页面。</li> <li><code>附属于某个段的区(FSEG)</code>：每一索引都可以分为叶子节点段和非叶子节点段</li></ul> <p>处于<code>FREE</code>、<code>FREE_FRAG</code>以及<code>FULL_FRAG</code>这三种状态的区都是独立的，直属于表空间。而处于<code>FSEG</code>状态的区是附属于某个段的。</p> <h2 id="_5-表空间"><a href="#_5-表空间" class="header-anchor">#</a> 5. 表空间</h2> <p>表空间可以看做是 InnoDB 存储引擎逻辑结构的最高层，所有的数据都存放在表空间中。</p> <p>表空间是一个<code>逻辑容器</code>，表空间存储的对象是段，在一个表空间中可以有一个或多个段，但是一个段只能属于一个表空间。表空间数据库由一个或多个表空间组成，表空间从管理上可以划分为<code>系统表空间（System tablespace）</code>、 <code>独立表空间（File-per-table tablespace）</code>、 <code>撤销表空间（Undo Tablespace）</code>和 <code>临时表空间（Temporary Tablespace）</code>等。</p> <h3 id="_5-1-独立表空间"><a href="#_5-1-独立表空间" class="header-anchor">#</a> 5.1 独立表空间</h3> <p>独立表空间，即每张表有一个独立的表空间，也就是数据和索引信息都会保存在自己的表空间中。独立的表空间 （即：单表） 可以在不同的数据库之间进行<code>迁移</code>。</p> <p>空间可以回收 （DROP TABLE 操作可自动回收表空间；其他情况，表空间不能自己回收） 。如果对于统计分析或是日志表，删除大量数据后可以通过：<code>alter table TableName engine=innodb;</code>回收不用的空间。对于使用独立表空间的表，不管怎么删除，表空间的碎片不会太严重的影响性能，而且还有机会处理。</p> <p><strong>独立表空间结构</strong></p> <p>独立表空间由段、区、页组成。</p> <p><strong>真实表空间对应的文件大小</strong></p> <p>我们到数据目录里看，会发现一个新建的表对应的<code>.ibd</code>文件只占用了<code>96K</code>，才 6 个页面大小 （MySQL5.7 中），这是因为一开始表空间占用的空间很小，因为表里边都没有数据。不过别忘了这些<code>.ibd</code>文件是<code>自扩展的</code>，随着表中数据的增多，表空间对应的文件也逐渐增大。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>MySQL8 新建表对应的.ibd 文件会有 7 个页大小，因为表结构和表数据信息存放在一块了。MySQL5.7 是分开存储的。</p></div> <p><strong>查看 InnoDB 的表空间类型</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'innodb_file_per_table'</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
<span class="token operator">|</span> Variable_name         <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
<span class="token operator">|</span> innodb_file_per_table <span class="token operator">|</span> <span class="token keyword">ON</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------+-------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>innodb_file_per_table=ON</code>, 这就意味着每张表都会单词保存一个<code>.ibd</code>文件。</p> <h3 id="_5-2-系统表空间"><a href="#_5-2-系统表空间" class="header-anchor">#</a> 5.2 系统表空间</h3> <p>系统表空间的结构和独立表空间基本类似，只不过由于整个 MySQL 进程只有一个系统表空间，在系统表空间中会额外记录一些有关整个系统信息的页面，这部分是独立表空间中没有的。</p> <p><strong>InnoDB 数据字典</strong></p> <p>每当我们向一个表中插入一条记录时，<code>MySQL校验过程</code>如下：</p> <p>先要校验一下插入语句对应的表存不存在，插入的列和表中的列是否符合。如果语法没有问题的话，还需要知道该表的聚簇索引和所有二级索引对应的根页面是哪个表空间的哪个页面，然后把记录插入对应索引的 B+树中。所以说，MySQL 除了保存着我们插入的用户数据之外，还需要保存许多额外的信息，比如说：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- 某个表属于哪个表空间，表里边有多少列
- 表对应的每一个列的类型是什么
- 该表有多少索引，每个索引对应哪几个字段，该索引对应的根页面在哪个表空间的哪个页面
- 该表有哪些外键，外键对应哪个表的哪些列
- 某个表空间对应文件系统上文件路径是什么
- ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上述这些数据并不是我们使用<code>INSERT</code>语句插入的用户数据，实际上是为了更好的管理我们这些用户数据而不得以引入的一些额外数据，这些数据页称为<code>元数据</code>。InnoDB 存储引擎特意定义了一些列的<code>内部系统表</code> (internal system table) 来记录这些元数据：</p> <table><thead><tr><th style="text-align:left;">表名</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>SYS_TABLES</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有表的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_COLUMNS</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有列的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_INDEXES</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有索引的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_FIELDS</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有索引对应的列的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_FOREIGN</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有外键的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_FOREIGN_COLS</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有外键对应列的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_TABLESPACES</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有表空间的信息</td></tr> <tr><td style="text-align:left;"><code>SYS_DATAFILES</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有表空间对应文件系统的文件路径信息</td></tr> <tr><td style="text-align:left;"><code>SYS_VIRTUAL</code></td> <td style="text-align:left;">整个 InnoDB 存储引擎中所有虚拟生成列的信息</td></tr></tbody></table> <p>这些系统表也称为<code>数据字典</code>，它们都是以<code>B+</code>树的形式保存在系统表空间的某个页面中。其中<code>SYS_TABLES、SYS_COLUMNS、SYS_INDEXES、SYS_FIELDS</code>这四个表尤其重要，称之为基本系统表(basic system tables) ，我们先看看这 4 个表的结构：</p> <p><strong>SYS_TABLES 表结构</strong></p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>NAME</code></td> <td style="text-align:left;">表的名称。主键</td></tr> <tr><td style="text-align:left;"><code>ID</code></td> <td style="text-align:left;">InnoDB 存储引擎中每个表都有一个唯一的 ID。（二级索引）</td></tr> <tr><td style="text-align:left;"><code>N_COLS</code></td> <td style="text-align:left;">该表拥有列的个数</td></tr> <tr><td style="text-align:left;"><code>TYPE</code></td> <td style="text-align:left;">表的类型，记录了一些文件格式、行格式、压缩等信息</td></tr> <tr><td style="text-align:left;"><code>MIX_ID</code></td> <td style="text-align:left;">已过时，忽略</td></tr> <tr><td style="text-align:left;"><code>MIX_LEN</code></td> <td style="text-align:left;">表的一些额外的属性</td></tr> <tr><td style="text-align:left;"><code>CLUSTER_ID</code></td> <td style="text-align:left;">未使用，忽略</td></tr> <tr><td style="text-align:left;"><code>SPACE</code></td> <td style="text-align:left;">该表所属表空间的 ID</td></tr></tbody></table> <p><strong>SYS_COLUMNS 表结构</strong></p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>TABLE_ID</code></td> <td style="text-align:left;">该列所属表对应的 ID。（与<code>POS</code>一起构成联合主键）</td></tr> <tr><td style="text-align:left;"><code>POS</code></td> <td style="text-align:left;">该列在表中是第几列。</td></tr> <tr><td style="text-align:left;"><code>NAME</code></td> <td style="text-align:left;">该列的名称</td></tr> <tr><td style="text-align:left;"><code>MTYPE</code></td> <td style="text-align:left;">main data type 主数据类型，例如 INT、CHAR、VARCHAR、FLOAT、DOUBLE 等。</td></tr> <tr><td style="text-align:left;"><code>PRTYPE</code></td> <td style="text-align:left;">precise type 精确数据类型，修饰主数据类型的属性，如是否允许 NULL 值,是否允许负数</td></tr> <tr><td style="text-align:left;"><code>LEN</code></td> <td style="text-align:left;">该列最多占用存储空间的字节数。</td></tr> <tr><td style="text-align:left;"><code>PREC</code></td> <td style="text-align:left;">该列的精度，不过这列貌似都没有使用，默认值通常为 0。</td></tr></tbody></table> <p><strong>SYS_INDEXES 表结构</strong></p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>TABLE_ID</code></td> <td style="text-align:left;">该索引所属表对应的 ID。（与<code>ID</code>一起构成联合主键）</td></tr> <tr><td style="text-align:left;"><code>ID</code></td> <td style="text-align:left;">InnoDB 存储引擎中每个索引都有一个唯一的 ID。</td></tr> <tr><td style="text-align:left;"><code>NAME</code></td> <td style="text-align:left;">该索引的名称。</td></tr> <tr><td style="text-align:left;"><code>TYPE</code></td> <td style="text-align:left;">该索引的类型，如聚簇索引、唯一索引、更改缓冲区的索引，全文索引、普通的二级索引等。</td></tr> <tr><td style="text-align:left;"><code>N_FIELDS</code></td> <td style="text-align:left;">该索引包含的列的个数。</td></tr> <tr><td style="text-align:left;"><code>SPACE</code></td> <td style="text-align:left;">该索引根页面所在的表空间 ID。</td></tr> <tr><td style="text-align:left;"><code>PAGE_NO</code></td> <td style="text-align:left;">该索引根页面所在的页号。</td></tr> <tr><td style="text-align:left;"><code>MERGE_THRESHOLD</code></td> <td style="text-align:left;">如果页面中的记录被删除到某个比例，就把该页面和相邻页面合并，这个值就是这个比例</td></tr></tbody></table> <p><strong>SYS_FIELDS 表结构</strong></p> <table><thead><tr><th style="text-align:left;">列名</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>INDEX_ID</code></td> <td style="text-align:left;">该索引列所属的索引的 ID。（与 <code>POS</code> 一起构成联合主键）</td></tr> <tr><td style="text-align:left;"><code>POS</code></td> <td style="text-align:left;">该索引列在某个索引中是第几列。</td></tr> <tr><td style="text-align:left;"><code>COL_NAME</code></td> <td style="text-align:left;">该索引列的名称。</td></tr></tbody></table> <p>注意：用户不能直接访问 InnoDB 的这些内部系统表，除非你直接去解析系统表空间对应文件系统上的文件。不过考虑到查看这些表的内容可能有助于大家分析问题，所以在系统数据库<code>information_schema</code>中提供了一些以 <code>innodb_sys</code>开头的表:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">USE</span> information_schema<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span> <span class="token operator">LIKE</span> <span class="token string">'INNODB_SYS%'</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
<span class="token operator">|</span> Tables_in_information_schema <span class="token punctuation">(</span>INNODB_SYS<span class="token operator">%</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
<span class="token operator">|</span> INNODB_SYS_DATAFILES                       <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_VIRTUAL                         <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_INDEXES                         <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_TABLES                          <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_FIELDS                          <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_TABLESPACES                     <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_FOREIGN_COLS                    <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_COLUMNS                         <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_FOREIGN                         <span class="token operator">|</span>
<span class="token operator">|</span> INNODB_SYS_TABLESTATS                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>在<code>information_scheme</code>数据库中的这些以<code>INNODB_SYS</code>开头的表并不是真正的内部系统表(内部系统表就是我们上边以<code>SYS</code>开头的那些表)，而是在存储引擎启动时读取这些以<code>SYS</code>开头的系统表，然后填充到这些以<code>INNODB_SYS</code>开头的表中。以<code>INNODB_SYS</code>开头的表和以<code>SYS</code>开头的表中的字段并不完全一样，但仅供大家参考已经足矣。</p> <h2 id="附录-数据页加载的三种方式"><a href="#附录-数据页加载的三种方式" class="header-anchor">#</a> 附录：数据页加载的三种方式</h2> <p>InnoDB 从磁盘中读取数据 <code>最小单位</code> 是数据页。而你想得到的 id = xxx 的数据，就是这个数据页众多行中的一行。</p> <p>对于 MySQL 存放的数据，逻辑概念上我们称之为表，在磁盘等物理层面而言是按 <code>数据页</code> 形式进行存放的，当其加载到 MySQL 中我们称之为 <code>缓存页</code>。</p> <p>如果缓冲池没有该页数据，那么缓冲池有以下三种读取数据的方式，每种方式的读取速率是不同的：</p> <p><strong>1）内存读取</strong></p> <p>如果该数据存在于内存中，基本上执行时间在 1ms 左右，效率还是很高的。</p> <p><strong>2）随机读取</strong></p> <p>如果数据没有在内存中，就需要在磁盘上对该页进行查找，整体时间预估在 10ms 左右，这 10ms 中有 6ms 是磁盘的实际等待时间（包括了<code>寻道和半圈旋转时间</code>），有 3ms 是对可能发生的排队时间的估计值，另外还有 1ms 的传输时间，将页从磁盘服务器缓冲区传输到数据库缓冲区中。这 10ms 看起来很快，但实际上对于数据库来说消耗的时间已经非常长了，因为这还只是一个页的读取时间。</p> <p><img src="/assets/img/Read_Page_From_Disk.e8156e91.webp" alt="Read_Page_From_Disk"></p> <p><strong>3）顺序读取</strong></p> <p>顺序读取其实是一种批量读取的方式，因为我们请求的<code>数据在磁盘上往往都是相邻存储的</code>，顺序读取可以帮助我们批量读取页面，这样的话，一次性加载到缓冲池中就不需要再对其他页面单独进行磁盘 I/O 操作了。如果一个磁盘的吞吐量是 40MB/S，那么对于一个 16KB 大小的页来说，一次可以顺序读取 2560(40MB/16KB)个页，相当于一个页的读取时间为 0.4ms。采用批量读取的方式，即使是从磁盘上进行读取，效率也比从内存中只单独读取一个页的效率要高。</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/07/20, 17:16:01</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-6/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">第06章_索引的数据结构</div></a> <a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-8/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">第08章_索引的创建与设计原则</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-6/" class="prev">第06章_索引的数据结构</a></span> <span class="next"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-8/">第08章_索引的创建与设计原则</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/java-basic/java-web/chapter-9/"><div>
            第九章 前端工程化-下
            <!----></div></a> <span class="date">12-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/java-basic/java-web/chapter-8/"><div>
            第八章 前端工程化-中
            <!----></div></a> <span class="date">12-11</span></dt></dl><dl><dd>03</dd> <dt><a href="/java-basic/java-web/chapter-7/"><div>
            第七章 前端工程化-上
            <!----></div></a> <span class="date">12-04</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1214025526@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/coderofmutou" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/ismutou" title="Gitee" target="_blank" class="iconfont icon-gitee"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2026
    <span>bombax | <a href="https://github.com/coderofmutou/coderofmutou.github.io/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1f9bc03c.js" defer></script><script src="/assets/js/3.be9e7e99.js" defer></script><script src="/assets/js/2.c36d0987.js" defer></script><script src="/assets/js/33.a02e512f.js" defer></script>
  </body>
</html>
