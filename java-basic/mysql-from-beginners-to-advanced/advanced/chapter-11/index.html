<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第11章_数据库的设计规范 | Bombax&#39;s Knowledge Document Notes</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="技术知识学习笔记">
    <meta name="keywords" content="技术知识学习笔记">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.a5ee4d2c.css" as="style"><link rel="preload" href="/assets/js/app.ca5c989c.js" as="script"><link rel="preload" href="/assets/js/3.f2884e99.js" as="script"><link rel="preload" href="/assets/js/2.81e8b964.js" as="script"><link rel="preload" href="/assets/js/16.81c1d5ab.js" as="script"><link rel="prefetch" href="/assets/js/1.f754fd0b.js"><link rel="prefetch" href="/assets/js/10.bde6e567.js"><link rel="prefetch" href="/assets/js/100.000718ad.js"><link rel="prefetch" href="/assets/js/101.863f022a.js"><link rel="prefetch" href="/assets/js/102.7b45f43b.js"><link rel="prefetch" href="/assets/js/103.ba5681a8.js"><link rel="prefetch" href="/assets/js/104.e35b7e87.js"><link rel="prefetch" href="/assets/js/105.15a150cd.js"><link rel="prefetch" href="/assets/js/106.aea81b3b.js"><link rel="prefetch" href="/assets/js/107.4f4dec09.js"><link rel="prefetch" href="/assets/js/108.0079fda6.js"><link rel="prefetch" href="/assets/js/109.7a5059de.js"><link rel="prefetch" href="/assets/js/11.fa1b0bc7.js"><link rel="prefetch" href="/assets/js/110.85007649.js"><link rel="prefetch" href="/assets/js/111.dbec93e3.js"><link rel="prefetch" href="/assets/js/112.f17a38c0.js"><link rel="prefetch" href="/assets/js/113.6478506e.js"><link rel="prefetch" href="/assets/js/114.6031c0db.js"><link rel="prefetch" href="/assets/js/115.d7094af2.js"><link rel="prefetch" href="/assets/js/116.316a6234.js"><link rel="prefetch" href="/assets/js/117.1336f5e0.js"><link rel="prefetch" href="/assets/js/118.4b882789.js"><link rel="prefetch" href="/assets/js/119.503f83be.js"><link rel="prefetch" href="/assets/js/12.04b9b957.js"><link rel="prefetch" href="/assets/js/120.af7d94d8.js"><link rel="prefetch" href="/assets/js/121.5cd3597d.js"><link rel="prefetch" href="/assets/js/122.82f45642.js"><link rel="prefetch" href="/assets/js/123.f2ba0b19.js"><link rel="prefetch" href="/assets/js/13.680e50fd.js"><link rel="prefetch" href="/assets/js/14.dfca4100.js"><link rel="prefetch" href="/assets/js/15.01784967.js"><link rel="prefetch" href="/assets/js/17.9a472859.js"><link rel="prefetch" href="/assets/js/18.5366cb68.js"><link rel="prefetch" href="/assets/js/19.b1b74ef9.js"><link rel="prefetch" href="/assets/js/20.e938fa21.js"><link rel="prefetch" href="/assets/js/21.3e38db33.js"><link rel="prefetch" href="/assets/js/22.f9d18654.js"><link rel="prefetch" href="/assets/js/23.8eea4b67.js"><link rel="prefetch" href="/assets/js/24.6fe732dc.js"><link rel="prefetch" href="/assets/js/25.b1885cb6.js"><link rel="prefetch" href="/assets/js/26.936ee89a.js"><link rel="prefetch" href="/assets/js/27.fb3beb63.js"><link rel="prefetch" href="/assets/js/28.af721a74.js"><link rel="prefetch" href="/assets/js/29.427b7eae.js"><link rel="prefetch" href="/assets/js/30.2af5e34e.js"><link rel="prefetch" href="/assets/js/31.60102330.js"><link rel="prefetch" href="/assets/js/32.746872da.js"><link rel="prefetch" href="/assets/js/33.9466d03b.js"><link rel="prefetch" href="/assets/js/34.c7f7b0ef.js"><link rel="prefetch" href="/assets/js/35.53799eb8.js"><link rel="prefetch" href="/assets/js/36.e8875fc1.js"><link rel="prefetch" href="/assets/js/37.c386b2c5.js"><link rel="prefetch" href="/assets/js/38.ee46082f.js"><link rel="prefetch" href="/assets/js/39.11d092ff.js"><link rel="prefetch" href="/assets/js/4.920d0610.js"><link rel="prefetch" href="/assets/js/40.4ee40bcf.js"><link rel="prefetch" href="/assets/js/41.81c3174c.js"><link rel="prefetch" href="/assets/js/42.18f42b9d.js"><link rel="prefetch" href="/assets/js/43.7426d1ac.js"><link rel="prefetch" href="/assets/js/44.d5baff75.js"><link rel="prefetch" href="/assets/js/45.7b25c5ca.js"><link rel="prefetch" href="/assets/js/46.dff72ed3.js"><link rel="prefetch" href="/assets/js/47.15531a4f.js"><link rel="prefetch" href="/assets/js/48.48bbc098.js"><link rel="prefetch" href="/assets/js/49.49acd468.js"><link rel="prefetch" href="/assets/js/5.847584a2.js"><link rel="prefetch" href="/assets/js/50.e26ee1bf.js"><link rel="prefetch" href="/assets/js/51.6728bddb.js"><link rel="prefetch" href="/assets/js/52.c238e7bf.js"><link rel="prefetch" href="/assets/js/53.025903f6.js"><link rel="prefetch" href="/assets/js/54.05baf03a.js"><link rel="prefetch" href="/assets/js/55.b6fc3e0a.js"><link rel="prefetch" href="/assets/js/56.8e5ef1fc.js"><link rel="prefetch" href="/assets/js/57.db41b6fb.js"><link rel="prefetch" href="/assets/js/58.b4cb51f8.js"><link rel="prefetch" href="/assets/js/59.423b27e1.js"><link rel="prefetch" href="/assets/js/6.b384c550.js"><link rel="prefetch" href="/assets/js/60.57eff889.js"><link rel="prefetch" href="/assets/js/61.387a5103.js"><link rel="prefetch" href="/assets/js/62.23ba2982.js"><link rel="prefetch" href="/assets/js/63.2d69780b.js"><link rel="prefetch" href="/assets/js/64.d3f669fb.js"><link rel="prefetch" href="/assets/js/65.f5410640.js"><link rel="prefetch" href="/assets/js/66.59887fb2.js"><link rel="prefetch" href="/assets/js/67.01fba30e.js"><link rel="prefetch" href="/assets/js/68.8a6bbb81.js"><link rel="prefetch" href="/assets/js/69.12e673c4.js"><link rel="prefetch" href="/assets/js/70.a227d4b3.js"><link rel="prefetch" href="/assets/js/71.bd6a3bd7.js"><link rel="prefetch" href="/assets/js/72.4f2efca4.js"><link rel="prefetch" href="/assets/js/73.7dbf57a8.js"><link rel="prefetch" href="/assets/js/74.28c26d0a.js"><link rel="prefetch" href="/assets/js/75.d36a4feb.js"><link rel="prefetch" href="/assets/js/76.9123efc1.js"><link rel="prefetch" href="/assets/js/77.cbe2020d.js"><link rel="prefetch" href="/assets/js/78.7ab3eb40.js"><link rel="prefetch" href="/assets/js/79.bc69c4a8.js"><link rel="prefetch" href="/assets/js/80.da17de0b.js"><link rel="prefetch" href="/assets/js/81.1d16813f.js"><link rel="prefetch" href="/assets/js/82.586f2e97.js"><link rel="prefetch" href="/assets/js/83.129cc5fa.js"><link rel="prefetch" href="/assets/js/84.83d65ed9.js"><link rel="prefetch" href="/assets/js/85.f4327096.js"><link rel="prefetch" href="/assets/js/86.866a7d4f.js"><link rel="prefetch" href="/assets/js/87.f8aba274.js"><link rel="prefetch" href="/assets/js/88.43c5a138.js"><link rel="prefetch" href="/assets/js/89.b47b6d86.js"><link rel="prefetch" href="/assets/js/9.ef15744b.js"><link rel="prefetch" href="/assets/js/90.4950712a.js"><link rel="prefetch" href="/assets/js/91.80bbaffe.js"><link rel="prefetch" href="/assets/js/92.0d03ce50.js"><link rel="prefetch" href="/assets/js/93.fff94cff.js"><link rel="prefetch" href="/assets/js/94.91d0e36d.js"><link rel="prefetch" href="/assets/js/95.15227fb3.js"><link rel="prefetch" href="/assets/js/96.b3ef20b0.js"><link rel="prefetch" href="/assets/js/97.9e5e1675.js"><link rel="prefetch" href="/assets/js/98.b213b526.js"><link rel="prefetch" href="/assets/js/99.1ec76897.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.1b448e12.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a5ee4d2c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.webp" alt="Bombax's Knowledge Document Notes" class="logo"> <span class="site-name can-hide">Bombax's Knowledge Document Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><a href="/java-basic/" class="link-title router-link-active">Java基础</a> <span class="title" style="display:none;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前置</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-learning/" class="nav-link">尚硅谷Java学习</a></li><li class="dropdown-subitem"><a href="/java-basic/software-install-config/" class="nav-link">基础软件安装与配置</a></li></ul></li><li class="dropdown-item"><h4>核心</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-from-entry-to-proficiency/" class="nav-link">Java从入门到精通(JDK17版)</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/beginners/" class="nav-link">MySQL从入门到高级-基础篇</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/" class="nav-link router-link-active">MySQL从入门到高级-高级篇</a></li><li class="dropdown-subitem"><a href="/java-basic/jdbc-core/" class="nav-link">JDBC 核心技术(JDK21版)</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/pojo/" class="nav-link">POJO 概念</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务核心" class="dropdown-title"><a href="/micro-service-core/" class="link-title">微服务核心</a> <span class="title" style="display:none;">微服务核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud/" class="nav-link">SpringCloud</a></li><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud-Alibaba/" class="nav-link">SpringCloud-Alibaba</a></li></ul></li><li class="dropdown-item"><h4>持久层框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/micro-service-core/MyBatisPlus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>相关知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/20b7dd/" class="nav-link">Mybatis 代码生成工具比较</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务生态" class="dropdown-title"><a href="/micro-service-ecology/" class="link-title">微服务生态</a> <span class="title" style="display:none;">微服务生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>安全框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/SpringSecurity/" class="nav-link">安全框架之 Spring Security</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/Shiro/" class="nav-link">安全框架之 Shiro</a></li></ul></li><li class="dropdown-item"><h4>定时任务框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/Quartz/" class="nav-link">定时任务框架之 Quartz</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/XXL-JOB/" class="nav-link">定时任务框架之 XXL-JOB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用工具" class="dropdown-title"><a href="/tools/" class="link-title">实用工具</a> <span class="title" style="display:none;">实用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/java-logs/" class="nav-link">Java 日志热门框架</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">Git 常用命令</a></li><li class="dropdown-item"><!----> <a href="/tools/swagger/" class="nav-link">Swagger API 文档生成工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/weibocom/motan/wiki/zh_overview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Motan RPC
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.knowledgedict.com/tutorial/lombok-intro.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Tutorial
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://projectlombok.org/features/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Features
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/fastjson2/wiki/fastjson2_intro_cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FastJSON2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://felord.cn/_doc/spring/5.x.RELEASE/_book/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Framework 5 中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://x-stream.github.io/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XStream
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://neoremind.com/2016/02/java%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6fluent-validator/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  fluent-validator 业务逻辑验证框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.ehcache.org/documentation/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ehcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caffeine.gitbook.io/caffeine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  caffeine 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://springdoc.cn/spring/integration.html#cache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Cache
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/imyjy/p/15695160.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主流缓存框架调研
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95" target="_blank" rel="noopener noreferrer" class="nav-link external">
  redisson 官方中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012934325/article/details/100652805" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 中文学习指南
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.liquibase.com/concepts/introduction-to-liquibase.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 官方文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/coderofmutou/coderofmutou.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.webp"> <div class="blogger-info"><h3>bombax</h3> <span>小小程序猿</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><a href="/java-basic/" class="link-title router-link-active">Java基础</a> <span class="title" style="display:none;">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前置</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-learning/" class="nav-link">尚硅谷Java学习</a></li><li class="dropdown-subitem"><a href="/java-basic/software-install-config/" class="nav-link">基础软件安装与配置</a></li></ul></li><li class="dropdown-item"><h4>核心</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-basic/java-from-entry-to-proficiency/" class="nav-link">Java从入门到精通(JDK17版)</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/beginners/" class="nav-link">MySQL从入门到高级-基础篇</a></li><li class="dropdown-subitem"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/" class="nav-link router-link-active">MySQL从入门到高级-高级篇</a></li><li class="dropdown-subitem"><a href="/java-basic/jdbc-core/" class="nav-link">JDBC 核心技术(JDK21版)</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/pojo/" class="nav-link">POJO 概念</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务核心" class="dropdown-title"><a href="/micro-service-core/" class="link-title">微服务核心</a> <span class="title" style="display:none;">微服务核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud/" class="nav-link">SpringCloud</a></li><li class="dropdown-subitem"><a href="/micro-service-core/SpringCloud-Alibaba/" class="nav-link">SpringCloud-Alibaba</a></li></ul></li><li class="dropdown-item"><h4>持久层框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-core/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/micro-service-core/MyBatisPlus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>相关知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/20b7dd/" class="nav-link">Mybatis 代码生成工具比较</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务生态" class="dropdown-title"><a href="/micro-service-ecology/" class="link-title">微服务生态</a> <span class="title" style="display:none;">微服务生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>安全框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/SpringSecurity/" class="nav-link">安全框架之 Spring Security</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/Shiro/" class="nav-link">安全框架之 Shiro</a></li></ul></li><li class="dropdown-item"><h4>定时任务框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/micro-service-ecology/Quartz/" class="nav-link">定时任务框架之 Quartz</a></li><li class="dropdown-subitem"><a href="/micro-service-ecology/XXL-JOB/" class="nav-link">定时任务框架之 XXL-JOB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实用工具" class="dropdown-title"><a href="/tools/" class="link-title">实用工具</a> <span class="title" style="display:none;">实用工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/java-logs/" class="nav-link">Java 日志热门框架</a></li><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">Git 常用命令</a></li><li class="dropdown-item"><!----> <a href="/tools/swagger/" class="nav-link">Swagger API 文档生成工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/weibocom/motan/wiki/zh_overview" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Motan RPC
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.knowledgedict.com/tutorial/lombok-intro.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Tutorial
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://projectlombok.org/features/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lombok Features
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/fastjson2/wiki/fastjson2_intro_cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FastJSON2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://felord.cn/_doc/spring/5.x.RELEASE/_book/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Framework 5 中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://x-stream.github.io/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XStream
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://neoremind.com/2016/02/java%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6fluent-validator/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  fluent-validator 业务逻辑验证框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.ehcache.org/documentation/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ehcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jetcache java 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://caffeine.gitbook.io/caffeine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  caffeine 缓存框架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://springdoc.cn/spring/integration.html#cache" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Cache
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/imyjy/p/15695160.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主流缓存框架调研
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95" target="_blank" rel="noopener noreferrer" class="nav-link external">
  redisson 官方中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/u012934325/article/details/100652805" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 中文学习指南
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.liquibase.com/concepts/introduction-to-liquibase.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LiquiBase 官方文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/coderofmutou/coderofmutou.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>核心</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Java从入门到精通(JDK17版)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>MySQL从入门到高级-基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>MySQL从入门到高级-高级篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-0/" class="sidebar-link">第00章_写在前面</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-1/" class="sidebar-link">第01章_Linux 下 MySQL 的安装与使用</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-2/" class="sidebar-link">第02章_MySQL 的数据目录</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-3/" class="sidebar-link">第03章_用户与权限管理</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-4/" class="sidebar-link">第04章_逻辑架构</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-5/" class="sidebar-link">第05章_存储引擎</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-6/" class="sidebar-link">第06章_索引的数据结构</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-7/" class="sidebar-link">第07章_InnoDB 数据存储结构</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-8/" class="sidebar-link">第08章_索引的创建与设计原则</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-9/" class="sidebar-link">第09章_性能分析工具的使用</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-10/" class="sidebar-link">第10章_索引优化与查询优化</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/" aria-current="page" class="active sidebar-link">第11章_数据库的设计规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_1-为什么需要数据库设计" class="sidebar-link">1. 为什么需要数据库设计</a></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-范式" class="sidebar-link">2. 范式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-1-范式简介" class="sidebar-link">2.1 范式简介</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-2-范式都包括哪些" class="sidebar-link">2.2 范式都包括哪些</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-3-键和相关属性的概念" class="sidebar-link">2.3 键和相关属性的概念</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-4-第一范式-1st-nf" class="sidebar-link">2.4 第一范式 (1st NF)</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-5-第二范式-2nd-nf" class="sidebar-link">2.5 第二范式 (2nd NF)</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-6-第三范式-3rd-nf" class="sidebar-link">2.6 第三范式 (3rd NF)</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_2-7-小结" class="sidebar-link">2.7 小结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_3-反范式化" class="sidebar-link">3. 反范式化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_3-1-概述" class="sidebar-link">3.1 概述</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_3-2-应用举例" class="sidebar-link">3.2 应用举例</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_3-3-反范式的新问题" class="sidebar-link">3.3 反范式的新问题</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_3-3-反范式的适用场景" class="sidebar-link">3.3 反范式的适用场景</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-bcnf-巴斯范式" class="sidebar-link">4. BCNF（巴斯范式）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-1-案例" class="sidebar-link">4.1 案例</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-2-是否符合三范式" class="sidebar-link">4.2 是否符合三范式</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-3-存在的问题" class="sidebar-link">4.3 存在的问题</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-4-问题解决" class="sidebar-link">4.4 问题解决</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_4-5-再举例" class="sidebar-link">4.5 再举例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_5-第四范式" class="sidebar-link">5. 第四范式</a></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_6-第五范式、域键范式" class="sidebar-link">6. 第五范式、域键范式</a></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_7-实战案例" class="sidebar-link">7. 实战案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_7-1-迭代-1-次-考虑-1nf" class="sidebar-link">7.1 迭代 1 次：考虑 1NF</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_7-2-迭代-2-次-考虑-2nf" class="sidebar-link">7.2 迭代 2 次：考虑 2NF</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_7-3-迭代-3-次-考虑-3nf" class="sidebar-link">7.3 迭代 3 次：考虑 3NF</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_7-4-反范式化-业务优先的原则" class="sidebar-link">7.4 反范式化：业务优先的原则</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-er-模型" class="sidebar-link">8. ER 模型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-1-er-模型包括那些要素" class="sidebar-link">8.1 ER 模型包括那些要素？</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-2-关系的类型" class="sidebar-link">8.2 关系的类型</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-3-建模分析" class="sidebar-link">8.3 建模分析</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-4-er-模型的细化" class="sidebar-link">8.4 ER 模型的细化</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-er-模型图转换成数据表" class="sidebar-link">8.5 ER 模型图转换成数据表</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-1-一个实体转换成一个数据表" class="sidebar-link">8.5.1 一个实体转换成一个数据表</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-2-一个多对多的关系转换成一个数据表" class="sidebar-link">8.5.2 一个多对多的关系转换成一个数据表</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-3-通过外键来表达一对多的关系" class="sidebar-link">8.5.3 通过外键来表达一对多的关系</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-4-把属性转换成表的字段" class="sidebar-link">8.5.4 把属性转换成表的字段</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_8-5-5-总结" class="sidebar-link">8.5.5 总结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_9-数据表的设计原则" class="sidebar-link">9. 数据表的设计原则</a></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_10-数据库对象编写建议" class="sidebar-link">10. 数据库对象编写建议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_10-1-关于库" class="sidebar-link">10.1 关于库</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_10-2-关于表、列" class="sidebar-link">10.2 关于表、列</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_10-3-关于索引" class="sidebar-link">10.3 关于索引</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_10-4-sql-编写" class="sidebar-link">10.4 SQL 编写</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-powerdesigner-的使用" class="sidebar-link">11. PowerDesigner 的使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-1-开始界面" class="sidebar-link">11.1 开始界面</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-2-概念数据模型" class="sidebar-link">11.2 概念数据模型</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#entity-实体" class="sidebar-link">Entity 实体</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#填充实体字段" class="sidebar-link">填充实体字段</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#设置主标识符" class="sidebar-link">设置主标识符</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#放大模型" class="sidebar-link">放大模型</a></li><li class="sidebar-sub-header level4"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#实体关系" class="sidebar-link">实体关系</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-3-物理数据模型" class="sidebar-link">11.3 物理数据模型</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-4-概念模型转为物理模型" class="sidebar-link">11.4 概念模型转为物理模型</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-5-物理模型转为概念模型" class="sidebar-link">11.5 物理模型转为概念模型</a></li><li class="sidebar-sub-header level3"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-11/#_11-6-物理模型导出-sql-语句" class="sidebar-link">11.6 物理模型导出 SQL 语句</a></li></ul></li></ul></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-12/" class="sidebar-link">第12章_数据库其它调优策略</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-13/" class="sidebar-link">第13章_事务基础知识</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-14/" class="sidebar-link">第14章_MySQL 事务日志</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-15/" class="sidebar-link">第15章_锁</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-16/" class="sidebar-link">第16章_多版本并发控制</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-17/" class="sidebar-link">第17章_其它数据库日志</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-18/" class="sidebar-link">第18章_主从复制</a></li><li><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-19/" class="sidebar-link">第19章_数据库备份与恢复</a></li></ul></section></li><li><a href="/java-basic/jdbc-core/" class="sidebar-link">JDBC 核心技术(JDK21版)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Java%E5%9F%BA%E7%A1%80" title="分类" data-v-06225672>Java基础</a></li><li data-v-06225672><a href="/categories/?category=%E6%A0%B8%E5%BF%83" title="分类" data-v-06225672>核心</a></li><li data-v-06225672><a href="/categories/?category=MySQL%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7-%E9%AB%98%E7%BA%A7%E7%AF%87" title="分类" data-v-06225672>MySQL从入门到高级-高级篇</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/coderofmutou" target="_blank" title="作者" class="beLink" data-v-06225672>bombax</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-05-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">第11章_数据库的设计规范<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="第-11-章-数据库的设计规范"><a href="#第-11-章-数据库的设计规范" class="header-anchor">#</a> 第 11 章 数据库的设计规范</h1> <h2 id="_1-为什么需要数据库设计"><a href="#_1-为什么需要数据库设计" class="header-anchor">#</a> 1. 为什么需要数据库设计</h2> <p><strong>我们在设计数据表的时候，要考虑很多问题</strong>。比如：</p> <ul><li>用户会需要什么数据？需要在数据表里保存哪些数据？</li> <li>如何保证数据表中的数据的<code>正确性</code>，当插入、删除、更新的时候该进行怎样的<code>约束检查</code>？</li> <li>如何降低数据表的<code>数据冗余度</code>，保证数据表不会因为用户量的增长而迅速扩张？</li> <li>如何使负责维护数据库的人员<code>更方便</code>地使用数据库？</li> <li>使用数据表的应用场景会有不同，可以针对不同的情况，设计出来的数据表可能<code>千差万别</code>。</li></ul> <p><strong>现状情况下，面临的场景：</strong></p> <p>当数据库运行了一段时间之后，我们会发现数据表设计的有问题。重新调整数据表的结构，就需要做数据迁移，这个可能会影响程序的业务逻辑，以及网站的正常访问。</p> <p><strong>如果是糟糕的数据库设计可能会造成以下问题：</strong></p> <ul><li>数据冗余、信息丢失、存储空间浪费</li> <li>数据更新、插入、删除的异常</li> <li>无法正确表示信息</li> <li>丢失有效信息</li> <li>程序性差</li></ul> <p><strong>良好的数据库设计则有以下优点：</strong></p> <ul><li>节省数据的存储空间</li> <li>能够保证数据的完整性</li> <li>方便进行数据库应用系统的开发</li></ul> <p>总之，开始设置数据库表的时候，我们就需要重视数据表的设计。为了建立<strong>冗余较小、结构合理</strong>的数据库，设计数据表时必须遵循一定的规则。</p> <h2 id="_2-范式"><a href="#_2-范式" class="header-anchor">#</a> 2. 范式</h2> <h3 id="_2-1-范式简介"><a href="#_2-1-范式简介" class="header-anchor">#</a> 2.1 范式简介</h3> <p><strong>在关系型数据库中，关于数据表设计的基本原则、规则就称为范式</strong>。可以理解为，一张数据表的设计结构需要满足的某种设计标准的<code>级别</code>。要想设计一个结构合理的关系型数据库，必须满足一定的范式。</p> <p>范式的英文名称是<code>Normal Form</code>，简称<code>NF</code>。它是英国人 E.F.Codd 在上个世纪 70 年代提出关系数据库模型后总结出来的。范式是关系数据库理论的基础，也是我们在设计数据库结构过程中所要遵循的<code>规则和指导方法</code>。</p> <h3 id="_2-2-范式都包括哪些"><a href="#_2-2-范式都包括哪些" class="header-anchor">#</a> 2.2 范式都包括哪些</h3> <p>目前关系型数据库有六种常见范式，按照范式级别，从低到高分别是：<strong>第一范式(1NF)、第二范式(2NF)、第三范式(3NF)、巴斯-科德范式(BCNF)、第四范式(4NF) 和第五范式（5NF，又称完美范式）</strong>。</p> <p>数据库的范式设计越高阶，冗余度就越低，同时高阶的范式一定符合低阶范式的要求，满足最低要求的范式是第一范式(1NF)。在第一范式的基础上进一步满足更多规范的要求称为第二范式(2NF)，其余范式以此类推。</p> <p>一般来说，在关系型数据库设计中，最高也就遵循到<code>BCNF</code>，普遍还是<code>3NF</code>。但也不绝对，有时候为了提高某些查询性能，我们还需要破坏范式规则，也就是<code>反规范化</code>。</p> <p><img src="/assets/img/6NF.0b50b3f8.webp" alt="6NF.webp"></p> <h3 id="_2-3-键和相关属性的概念"><a href="#_2-3-键和相关属性的概念" class="header-anchor">#</a> 2.3 键和相关属性的概念</h3> <p>范式的定义会使用到主键和候选键，数据库中的键(Key)由一个或者多个属性组成。数据表中常用的几种键和属性的定义：</p> <ul><li><code>超键</code>：能唯一标识元组的属性集叫做超键。</li> <li><code>候选键</code>：如果超键不包括多余的属性，那么这个超键就是候选键。</li> <li><code>主键</code>：用户可以从候选键中选择一个作为主键。</li> <li><code>外键</code>：如果数据表 R1 中的某属性集不是 R1 的主键，而是另一个数据表 R2 的主键，那么这个属性集就是数据表 R1 的外键。</li> <li><code>主属性</code>：包含在任一候选键中的属性称为主属性。</li> <li><code>非主属性</code>：与主属性相对，指的是不包含在任何一个候选键中的属性。</li></ul> <p>通常，我们也将候选键称为<code>码</code>，把主键也称为<code>主码</code>。因为键可能是由多个属性组成的，针对单个属性，我们还可以用主属性和非主属性来进行区分。</p> <p><code>决定</code> 通常指的是一个属性或属性集确定另一个属性或属性集的能力，例如，如果属性 A 的值可以唯一地确定属性 B 的值，那么 A 决定 B。</p> <p>假设有一个学生表，包含学生 <code>ID(StudentID)</code> 和学生姓名<code>(Name)</code>两个属性。在这个例子中，学生 ID 可以唯一确定学生姓名，因此可以表示为： $\text{StudentID} \rightarrow \text{Name}$ 即 StudentID 决定 Name，Name</p> <p><strong>举例</strong></p> <p>这里有两个表：</p> <p><code>球员表(player)</code>：球员编号|姓名|身份证号|年龄|球队编号</p> <p><code>球队表(team)</code>：球队编号|主教练|球队所在地</p> <ul><li><code>超键</code>：对于球员表来说，超键就是包括球员编号或者身份证号的任意组合，比如（球员编号）（球员编号，姓名）（身份证号，年龄）等。</li> <li><code>候选键</code>：就是最小的超键，对于球员表来说，候选键就是（球员编号）或者（身份证号）。</li> <li><code>主键</code>：我们自己选定，也就是从候选键中选择一个，比如（球员编号）。</li> <li><code>外键</code>：球员表中的球队编号。</li> <li><code>主属性</code>、<code>非主属性</code>：在球员表中，主属性是（球员编号）（身份证号），其他的属性（姓名）（年龄）（球队编号）都是非主属性。</li></ul> <h3 id="_2-4-第一范式-1st-nf"><a href="#_2-4-第一范式-1st-nf" class="header-anchor">#</a> 2.4 第一范式 (1st NF)</h3> <p>第一范式主要是确保数据表中每个字段的值必须具有<code>原子性</code>，也就是说数据表中每个字段的值为<code>不可再次拆分</code>的最小数据单位。</p> <p>我们在设计某个字段的时候，对于字段 X 来说，不能把字段 X 拆分成字段 X-1 和字段 X-2。事实上，任何的 DBMS 都会满足第一范式的要求，不会将字段进行拆分。</p> <p><strong>举例 1：</strong></p> <p>假设一家公司要存储员工的姓名和联系方式。它创建一个如下表：</p> <p><img src="/assets/img/1NF_1.982d4aea.webp" alt="image-1NF"></p> <p>该表不符合 1NF，因为规则说<code>表的每个属性必须具有原子（单个）值</code>，员工 lisi 和 zhaoliu 的 emp_mobile 值违反了该规则。为了使表符合 1NF，我们应该有如下表数据：</p> <p><img src="/assets/img/1NF_02.e05a3c38.webp" alt="image-1NF-02"></p> <p><strong>举例 2：</strong></p> <p>user 表的设计不符合第一范式</p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">主键 id</td></tr> <tr><td style="text-align:left;">username</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">用户名</td></tr> <tr><td style="text-align:left;">password</td> <td style="text-align:left;">VARCHAR(50)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">密码</td></tr> <tr><td style="text-align:left;">user_info</td> <td style="text-align:left;">VARCHAR(255)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">用户信息 （包含真实姓名、电话、住址）</td></tr></tbody></table> <p>其中，user_info 字段为用户信息，可以进一步拆分成更小粒度的字段，不符合数据库设计对第一范式的要求。将 user_info 拆分后如下：</p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">主键 id</td></tr> <tr><td style="text-align:left;">username</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">用户名</td></tr> <tr><td style="text-align:left;">password</td> <td style="text-align:left;">VARCHAR(50)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">密码</td></tr> <tr><td style="text-align:left;">real_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">真实姓名</td></tr> <tr><td style="text-align:left;">phone</td> <td style="text-align:left;">VARCHAR(12)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">联系电话</td></tr> <tr><td style="text-align:left;">address</td> <td style="text-align:left;">VARCHAR(100)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">家庭住址</td></tr></tbody></table> <p><strong>举例 3：</strong></p> <p>属性的原子性是<code>主观的</code>。例如，Employees 关系中雇员姓名应当使用 1 个(fullname)、2 个（firstname 和 lastname）还是 3 个（firstname、middlename 和 lastname）属性表示呢？答案取决于应用程序。如果应 用程序需要分别处理雇员的姓名部分（如：用于搜索目的），则有必要把它们分开。否则，不需要。</p> <p>表 1：</p> <table><thead><tr><th style="text-align:left;">姓名</th> <th style="text-align:left;">年龄</th> <th style="text-align:left;">地址</th></tr></thead> <tbody><tr><td style="text-align:left;">张三</td> <td style="text-align:left;">20</td> <td style="text-align:left;">广东省广州市三元里 78 号</td></tr> <tr><td style="text-align:left;">李四</td> <td style="text-align:left;">24</td> <td style="text-align:left;">广东省深圳市龙华新区</td></tr></tbody></table> <p>表 2：</p> <table><thead><tr><th style="text-align:left;">姓名</th> <th style="text-align:left;">年龄</th> <th style="text-align:left;">省</th> <th style="text-align:left;">市</th> <th style="text-align:left;">地址</th></tr></thead> <tbody><tr><td style="text-align:left;">张三</td> <td style="text-align:left;">20</td> <td style="text-align:left;">广东</td> <td style="text-align:left;">广州</td> <td style="text-align:left;">三元里 78 号</td></tr> <tr><td style="text-align:left;">李四</td> <td style="text-align:left;">24</td> <td style="text-align:left;">广东</td> <td style="text-align:left;">深圳</td> <td style="text-align:left;">龙华新区</td></tr></tbody></table> <h3 id="_2-5-第二范式-2nd-nf"><a href="#_2-5-第二范式-2nd-nf" class="header-anchor">#</a> 2.5 第二范式 (2nd NF)</h3> <p>第二范式要求，在满足第一范式的基础上，还要<strong>满足数据表里的每一条数据记录，都是可唯一标识的。而且所有非主键字段，都必须完全依赖主键，不能只依赖主键的一部分</strong>。如果知道主键的所有属性的值，就可以检索到任何元组（行）的任何属性的任何值。（要求中的主键，其实可以扩展替换为候选键）。</p> <p><strong>举例 1：</strong></p> <p><code>成绩表</code>（学号，课程号，成绩）关系中，（学号，课程号）可以决定成绩，但是学号不能决定成绩，课程号也不能决定成绩，所以 $(学号，课程号) \to 成绩$ 就是<code>完全依赖关系</code>。</p> <p><strong>举例 2：</strong></p> <p><code>比赛表 player_game</code> ，里面包含球员编号、姓名、年龄、比赛编号、比赛时间和比赛场地等属性，这里候选键和主键都为（球员编号，比赛编号），我们可以通过候选键（或主键）来决定如下的关系：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(球员编号, 比赛编号) → (姓名, 年龄, 比赛时间, 比赛场地，得分)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但是这个数据表不满足第二范式，因为数据表中的字段之间还存在着如下的对应关系：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(球员编号) → (姓名，年龄)
(比赛编号) → (比赛时间, 比赛场地)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>对于非主属性来说，并非完全依赖候选键。这样会产生怎样的问题呢？</p> <ul><li><code>数据冗余</code> ：如果一个球员可以参加 m 场比赛，那么球员的姓名和年龄就重复了 m-1 次。一个比赛也可能会有 n 个球员参加，比赛的时间和地点就重复了 n-1 次。</li> <li><code>插入异常</code>：如果我们想要添加一场新的比赛，但是这时还没有确定参加的球员都有谁，那么就没法插入。</li> <li><code>删除异常</code>：如果我要删除某个球员编号，如果没有单独保存比赛表的话，就会同时把比赛信息删除掉。</li> <li><code>更新异常</code>：如果我们调整了某个比赛的时间，那么数据表中所有这个比赛的时间都需要进行调整，否则就会出现一场比赛时间不同的情况。</li></ul> <p>为了避免出现上述的情况，我们可以把球员比赛表设计为下面的三张表。</p> <table><thead><tr><th style="text-align:left;">表名</th> <th style="text-align:left;">属性（字段）</th></tr></thead> <tbody><tr><td style="text-align:left;">球员 player 表</td> <td style="text-align:left;">球员编号、姓名和年龄等属性</td></tr> <tr><td style="text-align:left;">比赛 game 表</td> <td style="text-align:left;">比赛编号、比赛时间和比赛场地等属性</td></tr> <tr><td style="text-align:left;">球员比赛关系 player_game 表</td> <td style="text-align:left;">球员编号、比赛编号和得分等属性</td></tr></tbody></table> <p>这样的话，每张数据表都符合第二范式，也就避免了异常情况的发生。</p> <div class="custom-block note"><p class="custom-block-title">笔记</p> <p>1NF 告诉我们字段属性需要是原子性的，而 2NF 告诉我们一张表就是一个独立的对象，一张表只表达一个意思。</p></div> <p><strong>举例 3：</strong></p> <p>定义了一个名为 Orders 的关系，表示订单和订单行的信息：</p> <p><img src="data:image/webp;base64,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" alt="2NF_01.webp"></p> <p>违反了第二范式，因为有非主键属性仅依赖于候选键（或主键）的一部分。例如，可以仅通过 orderid 找到订单的 orderdate，以及 customerid 和 companyname，而没有必要再去使用 productid。</p> <p>修改：</p> <p>Orders 表和 OrderDetails 表如下，此时符合第二范式。</p> <p><img src="/assets/img/2NF_02.c00f49ed.webp" alt="2NF_02.webp"></p> <div class="custom-block note"><p class="custom-block-title">小结</p> <p>第二范式(2NF)要求实体的属性完全依赖主关键字。如果存在不完全依赖，那么这个属性和主关键字的这一部分应该分离出来形成一个新的实体，新实体与元实体之间是一对多的关系。</p></div> <h3 id="_2-6-第三范式-3rd-nf"><a href="#_2-6-第三范式-3rd-nf" class="header-anchor">#</a> 2.6 第三范式 (3rd NF)</h3> <p>第三范式是在第二范式的基础上，确保数据表中的每一个非主键字段都和主键字段直接相关，也就是说，<strong>要求数据表中的所有非主键字段不能依赖于其他非主键字段。</strong>（即，不能存在非主属性 A 依赖于非主属性 B，非主属性 B 依赖于主键 C 的情况，即存在&quot;A--&gt;B--&gt;C&quot;的决定关系）通俗地讲，该规则的意思是所有<code>非主键属性</code>之间不能有依赖关系，必须<code>相互独立</code>。</p> <p>这里的主键可以扩展为候选键。</p> <p><strong>举例 1：</strong></p> <p><code>部门信息表</code>：每个部门有部门编号(dept_id)、部门名称、部门简介等信息。</p> <p><code>员工信息表</code>：每个员工有员工编号、姓名、部门编号。列出部门编号后就不能再将部门名称、部门简介等与部门有关的信息再加入员工信息表中。</p> <p>如果不存在部门信息表，则根据第三范式(3NF)也应该构建它，否则就会有大量的数据冗余。</p> <p><strong>举例 2：</strong></p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">商品主键 id（主键）</td></tr> <tr><td style="text-align:left;">category_id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别 id</td></tr> <tr><td style="text-align:left;">category_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别名称</td></tr> <tr><td style="text-align:left;">goods_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品名称</td></tr> <tr><td style="text-align:left;">price</td> <td style="text-align:left;">DECIMAL(10,2)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品价格</td></tr></tbody></table> <p>商品类别名称依赖于商品类别编号，不符合第三范式。</p> <p>修改：</p> <p>表 1：符合第三范式的<code>商品类别表</code>的设计</p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">商品类别主键 id</td></tr> <tr><td style="text-align:left;">category_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别名称</td></tr></tbody></table> <p>表 2：符合第三范式的<code>商品表</code>的设计</p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">商品主键 id</td></tr> <tr><td style="text-align:left;">category_id</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别 id</td></tr> <tr><td style="text-align:left;">goods_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品名称</td></tr> <tr><td style="text-align:left;">price</td> <td style="text-align:left;">DECIMAL(10,2)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品价格</td></tr></tbody></table> <p>商品表 goods 通过商品类别 id 字段(category_id)与商品类别表 goods_category 进行关联。</p> <p><strong>举例 3：</strong></p> <p><code>球员player表</code>：球员编号、姓名、球队名称和球队主教练。现在，我们把属性之间的依赖关系画出来，如下图所示:</p> <p><img src="data:image/webp;base64,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" alt="3NF.webp"></p> <p>你能看到球员编号决定了球队名称，同时球队名称决定了球队主教练，非主属性球队主教练就会传递依赖于球员编号，因此不符合 3NF 的要求。</p> <p>如果要达到 3NF 的要求，需要把数据表拆成下面这样：</p> <table><thead><tr><th style="text-align:left;">表名</th> <th style="text-align:left;">属性（字段）</th></tr></thead> <tbody><tr><td style="text-align:left;">球员表</td> <td style="text-align:left;">球员编号、姓名和球队名称</td></tr> <tr><td style="text-align:left;">球队表</td> <td style="text-align:left;">球队名称、球队主教练</td></tr></tbody></table> <p><strong>举例 4：</strong></p> <p>修改第二范式中的举例 3。</p> <p>此时的 Orders 关系包含 orderid、orderdate、customerid 和 companyname 属性，主键定义为 orderid。customerid 和 companyname 均依赖于主键 orderid。例如，你需要通过 orderid 主键来查找代表订单中客户的 customerid，同样，你需要通过 orderid 主键查找订单中客户的公司名称(companyname)。然而，customerid 和 companyname 也是互相依靠的。为满足第三范式，可以改写如下：</p> <p><img src="/assets/img/3NF_2.e881605e.webp" alt="3NF_2.webp"></p> <div class="custom-block note"><p class="custom-block-title">笔记</p> <p>符合 3NF 后的数据模型通俗地讲，2NF 和 3NF 通常以这句话概括：“每个非键属性依赖于键，依赖于整个键，并且除了键别无他物”。（非键属性不互相依赖，非键属性只依赖于整个键）</p></div> <h3 id="_2-7-小结"><a href="#_2-7-小结" class="header-anchor">#</a> 2.7 小结</h3> <p>关于数据表的设计，有三个范式要遵循。</p> <p>① 第一范式(1NF)，确保每列保持<code>原子性</code></p> <p>数据库的每一列都是不可分割的原子数据项，不可再分的最小数据单元，而不能是集合、数组、记录等非原子数据项。</p> <p>② 第二范式(2NF)，确保每列都和主键<code>完全依赖</code></p> <p>尤其在复合主键的情况向下，非主键部分不应该依赖于部分主键。</p> <p>③ 第三范式(3NF)，确保每列都和主键<code>直接相关</code>，而不是间接相关</p> <p><strong>范式的优点</strong>：数据的标准化有助于消除数据库中的<code>数据冗余</code>，第三范式(3NF)通常被认为在性能、拓展性和数据完整性方面达到了最好的平衡。</p> <p><strong>范式的缺点</strong>：范式的使用，可能<code>降低查询的效率</code>。因为范式等级越高，设计出来的数据表就越多、越精细，数据的冗余度就越低，进行数据查询的时候就可能需要<code>关联多张表</code>，这不但代价昂贵，也可能使一些<code>索引策略无效</code>。</p> <p>范式只是提出了设计的标准，实际上设计数据表时，未必一定要符合这些标准。开发中，我们会出现为了性能和读取效率违反范式化的原则，通过<code>增加少量的冗余</code>或重复的数据来提高数据库的<code>读性能</code>，减少关联查询，join 表的次数，实现<code>空间换取时间</code>的目的。因此在实际的设计过程中要理论结合实际，灵活运用。</p> <div class="custom-block note"><p class="custom-block-title">笔记</p> <p>范式本身没有优劣之分，只有适用场景不同。没有完美的设计，只有合适的设计，我们在数据表设计中，还需要根据需求将范式和反范式混合使用。</p></div> <h2 id="_3-反范式化"><a href="#_3-反范式化" class="header-anchor">#</a> 3. 反范式化</h2> <h3 id="_3-1-概述"><a href="#_3-1-概述" class="header-anchor">#</a> 3.1 概述</h3> <p>有的时候不能简单按照规范要求设计数据表，因为有的数据看似冗余，其实对业务来说十分重要。这个时候，我们就要遵循<code>业务优先</code>的原则，首先满足业务需求，再尽量减少冗余。</p> <p>如果数据库中的数据量比较大，系统的独立访客量(Unique Visitor，UV)、页面访问量(Page View，PV)、访问频次比较高，则完全按照 MySQL 的三大范式设计数据表，读数据时会产生大量的关联查询，在一定程度上会影响数据库的读性能。如果我们想对查询效率进行优化，<code>反范式优化</code>也是一种优化思路。此时，可以通过在数据表中<code>增加冗余字段</code>来提高数据库的读性能。</p> <div class="custom-block tip"><p class="custom-block-title">规范化 vs 性能</p> <ol><li>为满足某种商业目标，数据库性能比规范化数据库更重要</li> <li>在数据规范化的同时， 要综合考虑数据库的性能</li> <li>通过在给定的表中添加额外的字段，以大量减少需要从中搜索信息所需的时间</li> <li>通过在给定的表中插入计算列，以方便查询</li></ol></div> <h3 id="_3-2-应用举例"><a href="#_3-2-应用举例" class="header-anchor">#</a> 3.2 应用举例</h3> <p><strong>举例 1：</strong></p> <p>员工的信息存储在<code>employees表</code>中，部门信息存储在<code>departments表</code>中。通过 employees 表中的 department_id 字段与 departments 表建立关联关系。如果要查询一个员工所在部门的名称：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果经常需要进行这个操作，连接查询就会浪费很多时间。可以在 employees 表中增加一个冗余字段 department_name，这样就不用每次都进行连接操作了。</p> <p><strong>举例 2：</strong></p> <p>反范式化的<code>goods 商品信息表</code>设计如下：</p> <table><thead><tr><th style="text-align:left;">字段名称</th> <th style="text-align:left;">字段类型</th> <th style="text-align:left;">是否是主键</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">id</td> <td style="text-align:left;">INT</td> <td style="text-align:left;">是</td> <td style="text-align:left;">商品 id（主键）</td></tr> <tr><td style="text-align:left;">category_id</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别 id</td></tr> <tr><td style="text-align:left;">category_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品类别名称</td></tr> <tr><td style="text-align:left;">goods_name</td> <td style="text-align:left;">VARCHAR(30)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品名称</td></tr> <tr><td style="text-align:left;">price</td> <td style="text-align:left;">DECIMAL(10,2)</td> <td style="text-align:left;">否</td> <td style="text-align:left;">商品价格</td></tr></tbody></table> <p><strong>举例 3：</strong></p> <p>我们有 2 个表，分别是<code>商品流水表（trans）</code>和 <code>商品信息表（goodsinfo）</code> 。商品流水表里有 400 万条流水记录，商品信息表里有 2000 条商品记录。</p> <p>商品流水表：</p> <p><img src="/assets/img/Anti_NF1.fbede06d.webp" alt="image-Anti_NF1"></p> <p>商品信息表：</p> <p><img src="/assets/img/Anti_NF2.83cf7cfa.webp" alt="image-Anti_NF2"></p> <p>两个表是符合第三范式要求的。但是，在我们项目的实施过程中，对流水的查询频率很高，而且为了获取商品名称，基本都会用到与商品信息表的连接查询。</p> <p>为了减少连接，我们可以直接把商品名字段加到流水表里面。这样一来，我们就可以直接从流水表中获取商品名称字段了。虽然增加了冗余字段，但是避免了关联查询，提升了查询的效率。</p> <p>新的商品流水表如下所示：</p> <p><img src="data:image/webp;base64,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" alt="image-AntiNF3"></p> <p><strong>举例 4：</strong></p> <p><code>课程评论表 class_comment</code>，对应的字段名称及含义如下：</p> <table><thead><tr><th style="text-align:left;">字段</th> <th style="text-align:left;">comment_id</th> <th style="text-align:left;">class_id</th> <th style="text-align:left;">comment_text</th> <th style="text-align:left;">comment_time</th> <th style="text-align:left;">stu_id</th></tr></thead> <tbody><tr><td style="text-align:left;">含义</td> <td style="text-align:left;">课程评论 ID</td> <td style="text-align:left;">课程 ID</td> <td style="text-align:left;">评论内容</td> <td style="text-align:left;">评论时间</td> <td style="text-align:left;">学生 ID</td></tr></tbody></table> <p><code>学生表 student</code>，对应的字段名称及含义如下：</p> <table><thead><tr><th style="text-align:left;">字段</th> <th style="text-align:left;">stu_id</th> <th style="text-align:left;">stu_name</th> <th style="text-align:left;">create_time</th></tr></thead> <tbody><tr><td style="text-align:left;">含义</td> <td style="text-align:left;">学生 ID</td> <td style="text-align:left;">学生昵称</td> <td style="text-align:left;">注册时间</td></tr></tbody></table> <p>在实际应用中，我们在显示课程评论的时候，通常会显示这个学生的昵称，而不是学生 ID，因此当我们想要查询某个课程的前 1000 条评论时，需要关联 class_comment 和 student 这两张表来进行查询。</p> <p><strong>实验数据：模拟两张百万量级的数据表</strong></p> <p>为了更好地进行 SQL 优化实验，我们需要给学生表和课程评论表随机模拟出百万量级的数据。我们可以通过存储过程来实现模拟数据。</p> <p><strong>创建数据库和表</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> dbtest_nf<span class="token punctuation">;</span>
<span class="token keyword">USE</span> dbtest_nf<span class="token punctuation">;</span>

<span class="token comment">#学生表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
  stu_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  stu_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  create_time <span class="token keyword">DATETIME</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#课程评论表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> class_comment<span class="token punctuation">(</span>
    comment_id   <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    class_id     <span class="token keyword">INT</span><span class="token punctuation">,</span>
    comment_text <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    comment_time <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
    stu_id       <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>创建存储过程</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 创建向学生表中添加数据的存储过程</span>
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> batch_insert_student<span class="token punctuation">(</span><span class="token operator">IN</span> <span class="token keyword">START</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> max_num <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_start <span class="token keyword">DATETIME</span> <span class="token keyword">DEFAULT</span> <span class="token punctuation">(</span><span class="token string">'2017-01-01 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_temp <span class="token keyword">DATETIME</span><span class="token punctuation">;</span>

    <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> date_start<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">REPEAT</span>
        <span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> DATE_ADD<span class="token punctuation">(</span>date_temp<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token keyword">SECOND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student<span class="token punctuation">(</span>stu_id<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> create_time<span class="token punctuation">)</span>
        <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">START</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token string">'stu_'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> date_temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    UNTIL i <span class="token operator">=</span> max_num
    <span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>

    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>学生对课程的评价表，class_comment 随机生成 100 万条评论。这里我们设置为给某一课程评论，比如 class_id=10001。评论的内容为随机的 20 个字母。以下是创建随机的 100 万条课程评论的存储过程：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 创建向课程评论表中添加数据的存储过程</span>
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> batch_insert_class_comments<span class="token punctuation">(</span><span class="token operator">IN</span> <span class="token keyword">START</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> max_num <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_start <span class="token keyword">DATETIME</span> <span class="token keyword">DEFAULT</span> <span class="token punctuation">(</span><span class="token string">'2018-01-01 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_temp <span class="token keyword">DATETIME</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> comment_text <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> stu_id <span class="token keyword">INT</span><span class="token punctuation">;</span>

    <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> date_start<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">REPEAT</span>
        <span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> DATE_ADD<span class="token punctuation">(</span>date_temp<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token keyword">SECOND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> comment_text <span class="token operator">=</span> SUBSTR<span class="token punctuation">(</span>MD5<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> stu_id <span class="token operator">=</span> FLOOR<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>class_comment<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>comment_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>comment_text<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>comment_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>stu_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">START</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">,</span> comment_text<span class="token punctuation">,</span> date_temp<span class="token punctuation">,</span> stu_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    UNTIL i <span class="token operator">=</span> max_num
    <span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>

    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CALL</span> batch_insert_student<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CALL</span> batch_insert_class_comments<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>       <span class="token comment">#1000000</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> class_comment<span class="token punctuation">;</span> <span class="token comment">#1000000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>反范式优化实验对比</strong></p> <p>如果我们想要查询课程 ID 为 10001 的第 10000-30000 条评论，需要写成下面这样：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>comment_text<span class="token punctuation">,</span> p<span class="token punctuation">.</span>comment_time<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>stu_name
<span class="token keyword">FROM</span> class_comment <span class="token keyword">AS</span> p 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> student <span class="token keyword">AS</span> stu
<span class="token keyword">ON</span> p<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> stu<span class="token punctuation">.</span>stu_id
<span class="token keyword">WHERE</span> p<span class="token punctuation">.</span>class_id <span class="token operator">=</span> <span class="token number">10001</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> p<span class="token punctuation">.</span>comment_id <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>运行结果（20000 条数据行）：运行时长为 0.02 秒。</p> <p>如果我们想要提升查询的效率，可以允许适当的数据冗余，也就是在商品评论表中增加用户昵称字段</p> <p>新建 class_comment2 数据表，在 class_comment 数据表的基础上增加 stu_name 字段。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#课程评论表2</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> class_comment2<span class="token punctuation">(</span>
    comment_id   <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    class_id     <span class="token keyword">INT</span><span class="token punctuation">,</span>
    comment_text <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    comment_time <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
    stu_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    stu_id       <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 创建向课程评论表中添加数据的存储过程</span>
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> batch_insert_class_comments2<span class="token punctuation">(</span><span class="token operator">IN</span> <span class="token keyword">START</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> max_num <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_start <span class="token keyword">DATETIME</span> <span class="token keyword">DEFAULT</span> <span class="token punctuation">(</span><span class="token string">'2018-01-01 00:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> date_temp <span class="token keyword">DATETIME</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> comment_text <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">DECLARE</span> stu_id <span class="token keyword">INT</span><span class="token punctuation">;</span>

    <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> date_start<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">REPEAT</span>
        <span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> date_temp <span class="token operator">=</span> DATE_ADD<span class="token punctuation">(</span>date_temp<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token keyword">SECOND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> comment_text <span class="token operator">=</span> SUBSTR<span class="token punctuation">(</span>MD5<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> stu_id <span class="token operator">=</span> FLOOR<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>class_comment2<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>comment_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>comment_text<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>comment_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>stu_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>stu_name<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">START</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">,</span> comment_text<span class="token punctuation">,</span> date_temp<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token string">'stu_'</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    UNTIL i <span class="token operator">=</span> max_num
    <span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>

    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CALL</span> batch_insert_class_comments2<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样一来，只需单表查询就可以得到数据集结果：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> comment_text<span class="token punctuation">,</span> comment_time<span class="token punctuation">,</span> stu_name
<span class="token keyword">FROM</span> class_comment2
<span class="token keyword">WHERE</span> class_id <span class="token operator">=</span> <span class="token number">10001</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> class_id <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>反范式化之后，只需要扫描一次聚集索引即可，运行时间为 0.002 秒，查询时间是之前的 1/10。可以看到，在表中数据量比较大的情况下，查询效率会得到显著的提升。</p> <h3 id="_3-3-反范式的新问题"><a href="#_3-3-反范式的新问题" class="header-anchor">#</a> 3.3 反范式的新问题</h3> <p>虽然反范式化可以通过空间来换时间的方式来提高查询效率，但是这也会带来一些问题。</p> <ul><li>存储<code>空间变大</code>了，因为多了冗余字段。</li> <li>一个表中字段做了修改，另一个表中冗余的字段也需要做同步修改，否则<code>数据不一致</code></li> <li>若采用存储过程来支持数据的更新、删除等额外操作，如果更新频繁，会非常<code>消耗系统资源</code></li> <li>在<code>数据量小</code>的情况下，反范式不能体现性能的优势，可能还会让数据库的设计更加<code>复杂</code></li></ul> <h3 id="_3-3-反范式的适用场景"><a href="#_3-3-反范式的适用场景" class="header-anchor">#</a> 3.3 反范式的适用场景</h3> <p>当冗余信息有价值或者能<code>大幅度提高查询效率</code>的时候，我们才会采取反范式的设计。</p> <p><strong>① 增加冗余字段一定要符合两个条件：</strong></p> <p>一是这个冗余字段<code>不需要经常进行修改</code>；</p> <p>二是这个冗余字段<code>查询的时候不可或缺</code>。</p> <p><strong>② 历史快照、历史数据的需要</strong></p> <p>在现实生活中，我们经常需要一些冗余信息，比如订单中的收货人信息，包括姓名、电话和地址等。每次发生的<code>订单收货信息</code>都属于<code>历史快照</code>，需要进行保存，但用户可以随时修改自己的信息，这时保存这些冗余信息是非常有必要的。</p> <p>反范式优化也常用在<code>数据仓库</code>的设计中，因为数据仓库通常<code>存储历史数据</code>，对增删改的实时性要求不强，对历史数据的分析需求强。这时适当允许数据的冗余度，更方便进行数据分析。</p> <div class="custom-block tip"><p class="custom-block-title">数据仓库和数据库在使用上的区别</p> <ul><li>数据库设计的目的在于<code>捕捉数据</code>，而数据仓库设计的目的在于<code>分析数据</code>。</li> <li>数据库对数据的<code>增删改实时性</code>要求强，需要存储在线的用户数据，而数据仓库存储的一般是<code>历史数据</code>。</li> <li>数据库设计需要<code>尽量避免冗余</code>，但为了提高查询效率也允许一定的<code>冗余度</code>，而数据仓库在设计上更偏向采用反范式设计。</li></ul></div> <h2 id="_4-bcnf-巴斯范式"><a href="#_4-bcnf-巴斯范式" class="header-anchor">#</a> 4. BCNF（巴斯范式）</h2> <p>人们在 3NF 的基础上进行了改进，提出了<strong>巴斯范式(BCNF)，也叫巴斯-科德范式(Boyce-Codd Normal Form)</strong>。BCNF 被认为没有新的设计规范加入，只是对第三范式中设计规范要求更强，使得数据库冗余度更小。所以，称为是<code>修正的第三范式</code>，或<code>扩充的第三范式</code>，BCNF 不被称为第四范式。</p> <p>若一个关系达到了第三范式，并且它只有一个候选键，或者它的每个候选键都是单属性，则该关系自然达到 BC 范式。</p> <p>一般来说，一个数据库设符合 3NF 或者 BCNF 就可以了。</p> <h3 id="_4-1-案例"><a href="#_4-1-案例" class="header-anchor">#</a> 4.1 案例</h3> <p>我们分析如下表的范式情况：</p> <table><thead><tr><th style="text-align:left;">仓库名</th> <th style="text-align:left;">管理员</th> <th style="text-align:left;">物品名</th> <th style="text-align:left;">数量</th></tr></thead> <tbody><tr><td style="text-align:left;">北京仓</td> <td style="text-align:left;">张三</td> <td style="text-align:left;">iphone XR</td> <td style="text-align:left;">10</td></tr> <tr><td style="text-align:left;">北京仓</td> <td style="text-align:left;">张三</td> <td style="text-align:left;">iphone 7</td> <td style="text-align:left;">20</td></tr> <tr><td style="text-align:left;">上海仓</td> <td style="text-align:left;">李四</td> <td style="text-align:left;">iphone 7p</td> <td style="text-align:left;">30</td></tr> <tr><td style="text-align:left;">上海仓</td> <td style="text-align:left;">李四</td> <td style="text-align:left;">iphone 8</td> <td style="text-align:left;">40</td></tr></tbody></table> <p>在这个表中，一个仓库只有一个管理员，同时一个管理员也只管理一个仓库。</p> <p>我们先来梳理下这些属性之间的依赖关系。</p> <p>仓库名决定了管理员，管理员也决定了仓库名，同时（仓库名，物品名）的属性集合可以决定数量这个属性。这样，我们就可以找到数据表的候选键。</p> <p><code>候选键</code>：是（管理员，物品名）和（仓库名，物品名），然后我们从候选键中选择一个作为主键，比如（仓库名，物品名）。</p> <p><code>主属性</code>：包含在任一候选键中的属性，也就是仓库名，管理员和物品名。</p> <p><code>非主属性</code>：数量这个属性。</p> <h3 id="_4-2-是否符合三范式"><a href="#_4-2-是否符合三范式" class="header-anchor">#</a> 4.2 是否符合三范式</h3> <p>如何判断一张表的范式呢？我们需要根据范式的等级，从低到高来进行判断。</p> <p>首先，数据表每个属性都是原子性的，符合 1NF 的要求；</p> <p>其次，数据表中非主属性”数量“都与候选键全部依赖，（仓库名，物品名）决定数量，（管理员，物品名）决定数量。因此，数据表符合 2NF 的要求；</p> <p>最后，数据表中的非主属性，不传递依赖于候选键。因此符合 3NF 的要求。</p> <h3 id="_4-3-存在的问题"><a href="#_4-3-存在的问题" class="header-anchor">#</a> 4.3 存在的问题</h3> <p>既然数据表已经符合了 3NF 的要求，是不是就不存在问题了呢？我们来看下面的情况：</p> <ul><li>增加一个仓库，但是还没有存放任何物品。根据数据表实体完整性的要求，主键不能有空值，因此会出现<code>插入异常</code></li> <li>如果仓库更换了管理员，我们就可能会<code>修改数据表中的多条记录</code>；</li> <li>如果仓库里的商品都卖空了，那么此时仓库名称和相应的管理员名称也会随之被删除。</li></ul> <p>你能看到，即便数据表符合 3NF 的要求，同样可能存在插入，更新和删除数据的异常情况。</p> <h3 id="_4-4-问题解决"><a href="#_4-4-问题解决" class="header-anchor">#</a> 4.4 问题解决</h3> <p>首先我们需要确认造成异常的原因：主属性（仓库名）对于候选键（管理员，物品名）是部分依赖的关系，这样就有可能导致异常情况。因此引入 BCNF，<strong>它在 3NF 的基础上消除了主属性对候选键的部分依赖或者传递依赖关系</strong>。</p> <ul><li>如果在关系 R 中，U 为主键，A 属性是主键的一个属性，若存在 A-&gt;Y，Y 为主属性，则该关系不属于 BCNF。</li></ul> <p>根据 BCNF 的要求，我们需要把仓库管理关系 warehouse_keeper 表拆分成下面这样：</p> <p><code>仓库表</code>：（仓库名，管理员）</p> <p><code>库存表</code>：（仓库名，物品名，数量）</p> <p>这样就不存在主属性对于候选键的部分依赖或传递依赖，上面数据表的设计就符合 BCNF。</p> <h3 id="_4-5-再举例"><a href="#_4-5-再举例" class="header-anchor">#</a> 4.5 再举例</h3> <p>有一个<code>学生导师表</code>，其中包含字段：学生 ID，专业，导师，专业 GPA，这其中学生 ID 和专业是联合主键。</p> <table><thead><tr><th style="text-align:left;">StudentId</th> <th style="text-align:left;">Major</th> <th style="text-align:left;">Advisor</th> <th style="text-align:left;">MajGPA</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">人工智能</td> <td style="text-align:left;">Edward</td> <td style="text-align:left;">4.0</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">大数据</td> <td style="text-align:left;">William</td> <td style="text-align:left;">3.8</td></tr> <tr><td style="text-align:left;">1</td> <td style="text-align:left;">大数据</td> <td style="text-align:left;">William</td> <td style="text-align:left;">3.7</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">大数据</td> <td style="text-align:left;">Joseph</td> <td style="text-align:left;">4.0</td></tr></tbody></table> <p>这个表的设计满足三范式，但是这里存在另一个依赖关系，专业依赖于导师，也就是说每个导师只做一个专业方面的导师，只要知道了是哪个导师，我们自然就知道是哪个专业的了。</p> <p>所以这个表的部分主键 Major 依赖于非主键属性 Advisor，那么我们可以进行以下的调整，拆分成 2 个表：</p> <p>学生导师表：</p> <table><thead><tr><th style="text-align:left;">StudentId</th> <th style="text-align:left;">Advisor</th> <th style="text-align:left;">MajGPA</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">Edward</td> <td style="text-align:left;">4.0</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">William</td> <td style="text-align:left;">3.8</td></tr> <tr><td style="text-align:left;">1</td> <td style="text-align:left;">William</td> <td style="text-align:left;">3.7</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">Joseph</td> <td style="text-align:left;">4.0</td></tr></tbody></table> <p>导师表：</p> <table><thead><tr><th style="text-align:left;">Advisor</th> <th style="text-align:left;">Major</th></tr></thead> <tbody><tr><td style="text-align:left;">Edward</td> <td style="text-align:left;">人工智能</td></tr> <tr><td style="text-align:left;">William</td> <td style="text-align:left;">大数据</td></tr> <tr><td style="text-align:left;">Joseph</td> <td style="text-align:left;">大数据</td></tr></tbody></table> <h2 id="_5-第四范式"><a href="#_5-第四范式" class="header-anchor">#</a> 5. 第四范式</h2> <p>多值依赖的概念：</p> <ul><li><code>多值依赖</code>即属性之间的一对多关系，记为 <code>K—&gt;—&gt;A</code>。</li> <li><code>函数依赖</code>事实上是单值依赖，所以不能表达属性值之间的一对多关系。</li> <li><code>平凡的多值依赖</code>：全集 <code>U=K+A</code>，一个 K 可以对应于多个 A，即 <code>K—&gt;—&gt;A</code>。此时整个表就是一组一对多关系。</li> <li><code>非平凡的多值依赖</code>：全集 <code>U=K+A+B</code>，一个 K 可以对应于多个 A，也可以对应于多个 B，A 与 B 相互独立，即 <code>K—&gt;—&gt;A</code>，<code>K—&gt;—&gt;B</code>。整个表有多组一对多关系，且有：&quot;一&quot;部分是相同的属性集合，“多”部分是相互独立的属性集合。</li></ul> <p>第四范式即在满足*巴斯-科德范式(BCNF)*的基础上，消除非平凡且非函数依赖的多值依赖（即把同一表的多对多关系删除）。</p> <p><strong>举例 1</strong>：职工表（职工编号，职工孩子姓名，职工选修课程）。</p> <p>在这个表中，同一个职工可能会有多个职工孩子姓名。同样，同一个职工也可能会有多个职工选修课程，即这里存在着多值事实，不符合第四范式。</p> <p>如果要符合第四范式，只需要将上表分为两个表，使它们只有一个多值事实，例如： <code>职工表一</code> （职工编号，职工孩子姓名），<code>职工表二</code>（职工编号，职工选修课程），两个表都只有一个多值事实，所以符合第四范式。</p> <p><strong>举例 2：</strong></p> <p>比如我们建立课程、教师、教材的模型。我们规定，每门课程有对应的一组教师，每门课程也有对应的一组教材，一门课程使用的教材和教师没有关系。我们建立的关系表如下：</p> <p>课程 ID，教师 ID，教材 ID；这三列作为联合主键。</p> <p>为了表述方便，我们用 Name 代替 ID，这样更容易看懂：</p> <table><thead><tr><th style="text-align:left;">Course</th> <th style="text-align:left;">Teacher</th> <th style="text-align:left;">Book</th></tr></thead> <tbody><tr><td style="text-align:left;">英语</td> <td style="text-align:left;">Bill</td> <td style="text-align:left;">人教版英语</td></tr> <tr><td style="text-align:left;">英语</td> <td style="text-align:left;">Bill</td> <td style="text-align:left;">美版英语</td></tr> <tr><td style="text-align:left;">英语</td> <td style="text-align:left;">Jay</td> <td style="text-align:left;">美版英语</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">William</td> <td style="text-align:left;">人教版高数</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">Dave</td> <td style="text-align:left;">美版高数</td></tr></tbody></table> <p>这个表除了主键，就没有其他字段了，所以肯定满足 BC 范式，但是却存在<code>多值依赖</code>导致的异常。</p> <p>假如我们下学期想采用一本新的英版高数教材，但是还没确定具体哪个老师来教，那么我们就无法在这个表中维护 Course 高数和 Book 英版高数教材的的关系。</p> <p>解决办法是我们把这个多值依赖的表拆解成 2 个表，分别建立关系。这是我们拆分后的表：</p> <table><thead><tr><th style="text-align:left;">Course</th> <th style="text-align:left;">Teacher</th></tr></thead> <tbody><tr><td style="text-align:left;">英语</td> <td style="text-align:left;">Bill</td></tr> <tr><td style="text-align:left;">英语</td> <td style="text-align:left;">Jay</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">William</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">Dave</td></tr></tbody></table> <p>以及</p> <table><thead><tr><th style="text-align:left;">Course</th> <th style="text-align:left;">Book</th></tr></thead> <tbody><tr><td style="text-align:left;">英语</td> <td style="text-align:left;">人教版英语</td></tr> <tr><td style="text-align:left;">英语</td> <td style="text-align:left;">美版英语</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">人教版高数</td></tr> <tr><td style="text-align:left;">高数</td> <td style="text-align:left;">美版高数</td></tr></tbody></table> <h2 id="_6-第五范式、域键范式"><a href="#_6-第五范式、域键范式" class="header-anchor">#</a> 6. 第五范式、域键范式</h2> <p>除了第四范式外，我们还有更高级的第五范式（又称完美范式）和域键范式(DKNF)。</p> <p>在满足第四范式(4NF)的基础上，消除不是由候选键所蕴含的连接依赖。<strong>如果关系模式 R 中的每一个连接依赖均由 R 的候选键所隐含</strong>，则称此关系模式符合第五范式。</p> <p>函数依赖是多值依赖的一种特殊的情况，而多值依赖实际上是连接依赖的一种特殊情况。但连接依赖不像函数依赖和多值依赖可以由<code>语义直接导出</code>，而是在<code>关系连接运算</code>时才反映出来。存在连接依赖的关系模式仍可能遇到数据冗余及插入、修改、删除异常等问题。</p> <p>第五范式处理的是<code>无损连接问题</code>，这个范式基本<code>没有实际意义</code>，因为无损连接很少出现，而且难以察觉。而域键范式试图定义一个<code>终极范式</code>，该范式考虑所有的依赖和约束类型，但是实用价值也是最小的，只存在理论研究中。</p> <h2 id="_7-实战案例"><a href="#_7-实战案例" class="header-anchor">#</a> 7. 实战案例</h2> <p>商超进货系统中的<code>进货单表</code>进行剖析：</p> <p>进货单表：</p> <p><img src="/assets/img/nf_demo1.47c1dc64.webp" alt="imag-nf-demo1"></p> <p>这个表中的字段很多，表里的数据量也很惊人。大量重复导致表变得庞大，效率极低。如何改造？</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在实际工作场景中，这种由于数据表结构设计不合理，而导致的数据重复的现象并不少见。往往是系统虽然能够运行，承载能力却很差，稍微有点流量，就会出现内存不足、CPU 使用率飙升的情况，甚至会导致整个项目失败。</p></div> <h3 id="_7-1-迭代-1-次-考虑-1nf"><a href="#_7-1-迭代-1-次-考虑-1nf" class="header-anchor">#</a> 7.1 迭代 1 次：考虑 1NF</h3> <p>第一范式要求：<strong>所有的字段都是基本数据类型，不可进行拆分</strong>。这里需要确认，所有的列中，每个字段只包含一种数据。</p> <p>这张表里，我们把“property&quot;这一字段，拆分成”specification （规格）&quot; 和 &quot;unit （单位）&quot;，这两个字段如下：</p> <p><img src="/assets/img/nf_demo2.720abb25.webp" alt="image-nf-demo2"></p> <h3 id="_7-2-迭代-2-次-考虑-2nf"><a href="#_7-2-迭代-2-次-考虑-2nf" class="header-anchor">#</a> 7.2 迭代 2 次：考虑 2NF</h3> <p>第二范式要求，在满足第一范式的基础上，<strong>还要满足数据表里的每一条数据记录，都是可唯一标识的。而且所有字段，都必须完全依赖主键，不能只依赖主键的一部分</strong>。</p> <p>第 1 步，就是要确定这个表的主键。通过观察发现，字段“listnumber（单号）&quot;+&quot;barcode（条码）&quot;可以唯一标识每一条记录，可以作为主键。</p> <p>第 2 步，确定好了主键以后，判断哪些字段完全依赖主键，哪些字段只依赖于主键的一部分。把只依赖于主键一部分的字段拆出去，形成新的数据表。</p> <p>首先，进货单明细表里面的<code>&quot;goodsname(名称)&quot;&quot;specification(规格)&quot;&quot;unit(单位)&quot;</code>这些信息是商品的属性，只依赖于<code>&quot;batcode(条码)&quot;</code>，不完全依赖主键，可以拆分出去。我们把这 3 个字段加上它们所依赖的字段&quot;barcode（条码）&quot;，拆分形成新的数据表&quot;<code>商品信息表</code>&quot;。</p> <p>此外，字段<code>supplierid(供应商编号) suppliername(供应商名称) stock(仓库)</code>只依赖于<code>&quot;listnumber(单号)&quot;</code>，不完全依赖于主键，所以，我们可把这 3 个字段再加上它们依赖的字段&quot;listnumber（单号）&quot;拆出去，就形成了一个新的表&quot;<code>进货单头表</code>&quot;。</p> <p>剩下的字段，会组成新的表，我们叫它&quot;<code>进货单明细表</code>&quot;。</p> <p>这样一来，原来的数据表就拆分成了 3 个表。</p> <p>进货单表头</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">supplierid</th> <th style="text-align:left;">suppliername</th> <th style="text-align:left;">stock</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">食品厂</td> <td style="text-align:left;">仓库</td></tr> <tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">食品厂</td> <td style="text-align:left;">仓库</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">2</td> <td style="text-align:left;">服装厂</td> <td style="text-align:left;">卖场</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">1</td> <td style="text-align:left;">食品厂</td> <td style="text-align:left;">卖场</td></tr></tbody></table> <p>进货单明细表：</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">barcode</th> <th style="text-align:left;">quantity</th> <th style="text-align:left;">importprice</th> <th style="text-align:left;">importvalue</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">0001</td> <td style="text-align:left;">200</td> <td style="text-align:left;">25</td> <td style="text-align:left;">5000</td></tr> <tr><td style="text-align:left;">100001</td> <td style="text-align:left;">0002</td> <td style="text-align:left;">400</td> <td style="text-align:left;">9.9</td> <td style="text-align:left;">3960</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">0003</td> <td style="text-align:left;">5</td> <td style="text-align:left;">2000</td> <td style="text-align:left;">10000</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">0002</td> <td style="text-align:left;">200</td> <td style="text-align:left;">15</td> <td style="text-align:left;">3000</td></tr></tbody></table> <p>商品信息表：</p> <table><thead><tr><th style="text-align:left;">barcode</th> <th style="text-align:left;">goodsname</th> <th style="text-align:left;">specification</th> <th style="text-align:left;">unit</th></tr></thead> <tbody><tr><td style="text-align:left;">0001</td> <td style="text-align:left;">方便面</td> <td style="text-align:left;">6 包</td> <td style="text-align:left;">袋</td></tr> <tr><td style="text-align:left;">0002</td> <td style="text-align:left;">棒棒糖</td> <td style="text-align:left;">10 支</td> <td style="text-align:left;">盒</td></tr> <tr><td style="text-align:left;">0003</td> <td style="text-align:left;">西服</td> <td style="text-align:left;">NULL</td> <td style="text-align:left;">套</td></tr></tbody></table> <p>现在，我们再来分析一下拆分后的 3 个表，保证这 3 个表都满足第二范式的要求。</p> <p>第 3 步，在“商品信息表”中，字段“barcode&quot;是有<code>可能存在重复</code>的，比如，用户门店可能有散装称重商品和自产商品，会存在条码共用的情况。所以，所有的字段都不能唯一标识表里的记录。这个时候，我们必须给这个表加上一个主键，比如说是<code>自增字段&quot;itemnumber&quot;</code>。</p> <p>现在就可以把进货单明细表里面的字段&quot;barcode&quot;都替换成字段&quot;itemnumber&quot;，这就得到了新的如下表。</p> <p>进货单明细表：</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">itemnumber</th> <th style="text-align:left;">quantity</th> <th style="text-align:left;">importprice</th> <th style="text-align:left;">importvalue</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">200</td> <td style="text-align:left;">25</td> <td style="text-align:left;">5000</td></tr> <tr><td style="text-align:left;">100001</td> <td style="text-align:left;">2</td> <td style="text-align:left;">400</td> <td style="text-align:left;">9.9</td> <td style="text-align:left;">3960</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">3</td> <td style="text-align:left;">5</td> <td style="text-align:left;">2000</td> <td style="text-align:left;">10000</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">2</td> <td style="text-align:left;">200</td> <td style="text-align:left;">15</td> <td style="text-align:left;">3000</td></tr></tbody></table> <p>商品信息表：</p> <table><thead><tr><th style="text-align:left;">itemnumber</th> <th style="text-align:left;">barcode</th> <th style="text-align:left;">goodsname</th> <th style="text-align:left;">specification</th> <th style="text-align:left;">unit</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">0001</td> <td style="text-align:left;">方方便面</td> <td style="text-align:left;">6 包</td> <td style="text-align:left;">袋</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">0002</td> <td style="text-align:left;">棒棒糖</td> <td style="text-align:left;">10 支</td> <td style="text-align:left;">盒</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">0003</td> <td style="text-align:left;">西服</td> <td style="text-align:left;">NULL</td> <td style="text-align:left;">套</td></tr></tbody></table> <p>拆分后的 3 个数据表就全部满足了第二范式的要求</p> <h3 id="_7-3-迭代-3-次-考虑-3nf"><a href="#_7-3-迭代-3-次-考虑-3nf" class="header-anchor">#</a> 7.3 迭代 3 次：考虑 3NF</h3> <p>我们的进货单头表，还有数据冗余的可能。因为&quot;suppliername&quot;依赖&quot;supplierid&quot;，那么就可以按照第三范式的原则进行拆分了。我们就进一步拆分进货单头表，把它拆解成供货商表和进货单头表。</p> <p>供货商表：</p> <table><thead><tr><th style="text-align:left;">supplierid</th> <th style="text-align:left;">suppliername</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">食品厂</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">服装厂</td></tr></tbody></table> <p>进货单头表：</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">supplierid</th> <th style="text-align:left;">stock</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">仓库</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">2</td> <td style="text-align:left;">卖场</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">1</td> <td style="text-align:left;">卖场</td></tr></tbody></table> <p>这 2 个表都满足第三范式的要求了。</p> <h3 id="_7-4-反范式化-业务优先的原则"><a href="#_7-4-反范式化-业务优先的原则" class="header-anchor">#</a> 7.4 反范式化：业务优先的原则</h3> <p>在进货单明细表中， <code>quantity * importprice = importvalue</code>、“importprice&quot;、 “quantity&quot;和&quot;importvalue 可以通过任意两个计算出第三个来，这就存在冗余字段。如果严格按照第三范式的要求，应该进行进一步优化。优化的办法是删除其中一个字段，只保留另外 2 个，这样就没有冗余数据了。</p> <p>可是，真的可以这样做吗? 要回答这个问题就要先了解下实际工作中的<code>业务优先原则</code>。</p> <p>所谓的业务优先原则，就是指一切以业务需求为主，技术服务于业务。<strong>完全按照理论的设计不一定就是最优，还要根据实际情况来决定</strong>。这里就来分析一下不同选择的利与弊。</p> <p>对于 <code>quantity * importprice =importvalue</code>，看起来&quot;importvalue&quot;似乎是冗余字段，但并不会导致数据不一致，可是，如果把这个字段取消，是会影响业务的。</p> <p>因为有的时候，供货商会经常进行一些促销活动，按金额促销，那他们拿来的进货单只有金额，没有价格。而“importprice&quot;反而是通过<code>importvalue / quantity</code>计算出来的，经过四舍五入，会产生较大的误差。这样日积月累，最终会导致查询结果出现较大偏差，影响系统的可靠性。</p> <p>举例：进货金额(importvalue)是 25.5 元，数量(quantity)是 34，那么进货价格(importprice)就等于 <code>25.5/34=0.74</code> 元，但是如果用这个计算出来的进货价格(importprice)来计算进货金额，那么，进货金额 (importvalue)就等于 0.74x34=25.16 元，其中相差了 25.5-25.16=0.34 元</p> <p>所以，本着业务优先的原则，在不影响系统可靠性的前提下，可适当增加数据冗余，保留 “importvalue&quot;importprice”和“quantity&quot;。</p> <p>因此，最后我们可以把进货单表拆分成下面的 4 个表:</p> <p>供货商表：</p> <table><thead><tr><th style="text-align:left;">supplierid</th> <th style="text-align:left;">suppliername</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">食品厂</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">服装厂</td></tr></tbody></table> <p>进货单头表：</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">supplierid</th> <th style="text-align:left;">stock</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">仓库</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">2</td> <td style="text-align:left;">卖场</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">1</td> <td style="text-align:left;">卖场</td></tr></tbody></table> <p>进货单明细表：</p> <table><thead><tr><th style="text-align:left;">listnumber</th> <th style="text-align:left;">itemnumber</th> <th style="text-align:left;">quantity</th> <th style="text-align:left;">importprice</th> <th style="text-align:left;">importvalue</th></tr></thead> <tbody><tr><td style="text-align:left;">100001</td> <td style="text-align:left;">1</td> <td style="text-align:left;">200</td> <td style="text-align:left;">25</td> <td style="text-align:left;">5000</td></tr> <tr><td style="text-align:left;">100001</td> <td style="text-align:left;">2</td> <td style="text-align:left;">400</td> <td style="text-align:left;">9.9</td> <td style="text-align:left;">3960</td></tr> <tr><td style="text-align:left;">100002</td> <td style="text-align:left;">3</td> <td style="text-align:left;">5</td> <td style="text-align:left;">2000</td> <td style="text-align:left;">10000</td></tr> <tr><td style="text-align:left;">100003</td> <td style="text-align:left;">2</td> <td style="text-align:left;">200</td> <td style="text-align:left;">15</td> <td style="text-align:left;">3000</td></tr></tbody></table> <p>商品信息表：</p> <table><thead><tr><th style="text-align:left;">itemnumber</th> <th style="text-align:left;">barcode</th> <th style="text-align:left;">goodsname</th> <th style="text-align:left;">specification</th> <th style="text-align:left;">unit</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">0001</td> <td style="text-align:left;">方方便面</td> <td style="text-align:left;">6 包</td> <td style="text-align:left;">袋</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">0002</td> <td style="text-align:left;">棒棒糖</td> <td style="text-align:left;">10 支</td> <td style="text-align:left;">盒</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">0003</td> <td style="text-align:left;">西服</td> <td style="text-align:left;">NULL</td> <td style="text-align:left;">套</td></tr></tbody></table> <p>这样一来，我们就避免了冗余，而且还能够满足业务的需求，这样的数据表设计，才是合格的设计。</p> <h2 id="_8-er-模型"><a href="#_8-er-模型" class="header-anchor">#</a> 8. ER 模型</h2> <p>数据库设计是牵一发而动全身的。那有没有什么办法提前看到数据库的全貌呢？比如需要哪些数据表，数据表中应该有哪些字段，数据表与数据表之间有什么关系，通过什么字段进行连接，等等。这样我们才能进行整体的梳理和设计。</p> <p>其实，ER 模型就是一个这样的工具。ER 模型也叫作<code>实体关系模型</code>，是用来描述现实生活中客观存在的事物、事物的属性，以及事物之间关系的一种数据模型。<strong>在开发基于数据库的信息系统的设计阶段，通常使用 ER 模型来描述信息需求和信息特性，帮助我们理清业务逻辑，从而设计出优秀的数据库。</strong></p> <h3 id="_8-1-er-模型包括那些要素"><a href="#_8-1-er-模型包括那些要素" class="header-anchor">#</a> 8.1 ER 模型包括那些要素？</h3> <p><strong>ER 模型中有三个要素，分别是实体、属性和关系</strong>。</p> <p><code>实体</code>，可以看做是数据对象，往往对应于现实生活中的真实存在的个体。在 ER 模型中，用<code>矩形</code>来表示。实体分为两类，分别是<code>强实体</code>和<code>弱实体</code>。强实体是指不依赖于其他实体的实体；弱实体是指对另一个实体有很强的依赖关系的实体。</p> <p><code>属性</code>，则是指实体的特性。比如超市的地址、联系电话、员工数等。在 ER 模型中用<code>椭圆形</code>来表示。</p> <p><code>关系</code>，则是指实体之间的联系。比如超市把商品卖给顾客，就是一种超市与顾客之间的联系。在 ER 模型中用<code>菱形</code>来表示。</p> <p>注意：实体和属性不容易区分。这里提供一个原则：我们要从系统整体的角度出发去看，<strong>可以独立存在的是实体，不可再分的是属性</strong>。也就是说，属性不能包含其他属性。</p> <h3 id="_8-2-关系的类型"><a href="#_8-2-关系的类型" class="header-anchor">#</a> 8.2 关系的类型</h3> <p>在 ER 模型的 3 个要素中，关系又可以分为 3 种类型，分别是 一对一、一对多、多对多。</p> <p><code>一对一</code>：指实体之间的关系是一一对应的</p> <p><code>一对多</code>：指一边的实体通过关系，可以对应多个另外一边的实体。相反，另外一边的实体通过这个关系，则只能对应唯一的一边的实体</p> <p><code>多对多</code>：指关系两边的实体都可以通过关系对应多个对方的实体</p> <h3 id="_8-3-建模分析"><a href="#_8-3-建模分析" class="header-anchor">#</a> 8.3 建模分析</h3> <p>ER 模型看起来比较麻烦，但是对我们把控项目整体非常重要。如果你只是开发一个小应用，或许简单设计几个表够用了，一旦要设计有一定规模的应用，在项目的初始阶段，建立完整的 ER 模型就非常关键 了。开发应用项目的实质，其实就是<code>建模</code>。</p> <p>我们设计的案例是<code>电商业务</code>，由于电商业务太过庞大且复杂，所以我们做了业务简化，比如针对 SKU（StockKeepingUnit，库存量单位）和 SPU（Standard Product Unit，标准化产品单元）的含义上，我 们直接使用了 SKU，并没有提及 SPU 的概念。本次电商业务设计总共有 8 个实体，如下所示。</p> <ul><li>地址实体</li> <li>用户实体</li> <li>购物车实体</li> <li>评论实体</li> <li>商品实体</li> <li>商品分类实体</li> <li>订单实体</li> <li>订单详情实体</li></ul> <p>其中，<code>用户</code>和<code>商品</code>分类是强实体，因为它们不需要依赖其他任何实体。而其他属于弱实体，因为它们虽然都可以独立存在，但是它们都依赖用户这个实体，因此都是弱实体。知道了这些要素，我们就可以给电商业务创建 ER 模型了，如图：</p> <p><img src="/assets/img/ER_Demo1.22e5d7d7.webp" alt="ER_Demo1.webp"></p> <p>在这个图中，地址和用户之间的添加关系，是一对多的关系，而商品和商品详情示一对 1 的关系，商品和订单是多对多的关系。 这个 ER 模型，包括了 8 个实体之间的 8 种关系。</p> <p>(1) 用户可以在电商平台添加多个地址；</p> <p>(2) 用户只能拥有一个购物车；</p> <p>(3) 用户可以生成多个订单；</p> <p>(4) 用户可以发表多条评论；</p> <p>(5) 一件商品可以有多条评论；</p> <p>(6) 每一个商品分类包含多种商品；</p> <p>(7) 一个订单可以包含多个商品，一个商品可以在多个订单里。</p> <p>(8) 订单中又包含多个订单详情，因为一个订单中可能包含不同种类的商品</p> <h3 id="_8-4-er-模型的细化"><a href="#_8-4-er-模型的细化" class="header-anchor">#</a> 8.4 ER 模型的细化</h3> <p>有了这个 ER 模型，我们就可以从整体上理解电商的业务了。刚刚的 ER 模型展示了电商业务的框架，但是只包括了订单，地址，用户，购物车，评论，商品，商品分类和订单详情这八个实体，以及它们之间的关系，还不能对应到具体的表，以及表与表之间的关联。我们需要把<code>属性加上</code>，用<code>椭圆</code>来表示， 这样我们得到的 ER 模型就更加完整了。</p> <p>因此，我们需要进一步去设计一下这个 ER 模型的各个局部，也就是细化下电商的具体业务流程，然后把它们综合到一起，形成一个完整的 ER 模型。这样可以帮助我们理清数据库的设计思路。</p> <p>接下来，我们再分析一下各个实体都有哪些属性，如下所示。</p> <p>(1) <code>地址实体</code> 包括用户编号、省、市、地区、收件人、联系电话、是否是默认地址。</p> <p>(2) <code>用户实体</code> 包括用户编号、用户名称、昵称、用户密码、手机号、邮箱、头像、用户级别。</p> <p>(3) <code>购物车实体</code> 包括购物车编号、用户编号、商品编号、商品数量、图片文件 url。</p> <p>(4) <code>订单实体</code> 包括订单编号、收货人、收件人电话、总金额、用户编号、付款方式、送货地址、下单时间。</p> <p>(5) <code>订单详情实体</code> 包括订单详情编号、订单编号、商品名称、商品编号、商品数量。</p> <p>(6) <code>商品实体</code> 包括商品编号、价格、商品名称、分类编号、是否销售，规格、颜色。</p> <p>(7) <code>评论实体</code> 包括评论 id、评论内容、评论时间、用户编号、商品编号</p> <p>(8) <code>商品分类实体</code> 包括类别编号、类别名称、父类别编号</p> <p>这样细分之后，我们就可以重新设计电商业务了，ER 模型如图：</p> <p><img src="/assets/img/ER_Deom2.251bb053.webp" alt="image-ER_Demo2"></p> <h3 id="_8-5-er-模型图转换成数据表"><a href="#_8-5-er-模型图转换成数据表" class="header-anchor">#</a> 8.5 ER 模型图转换成数据表</h3> <p>通过绘制 ER 模型，我们已经理清了业务逻辑，现在，我们就要进行非常重要的一步了：把绘制好的 ER 模型，转换成具体的数据表，下面介绍下转换的原则：</p> <p>(1)一个<code>实体</code>通常转换成一个<code>数据表</code>；</p> <p>(2)一个<code>多对多的关系</code>，通常也转换成一个<code>数据表</code>；</p> <p>(3)一个<code>1 对 1</code>，或者<code>1 对多</code>的关系，往往通过表的<code>外键</code>来表达，而不是设计一个新的数据表；</p> <p>(4)<code>属性</code>转换成表的<code>字段</code>。</p> <p>下面结合前面的 ER 模型，具体讲解一下怎么运用这些转换的原则，把 ER 模型转换成具体的数据表，从而把抽象出来的数据模型，落实到具体的数据库设计当中。</p> <h4 id="_8-5-1-一个实体转换成一个数据表"><a href="#_8-5-1-一个实体转换成一个数据表" class="header-anchor">#</a> 8.5.1 一个实体转换成一个数据表</h4> <p><strong>先来看一下强实体转换成数据表:</strong></p> <p><code>用户实体</code>转换成用户表(user_info)的代码如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户昵称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>passwd<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户密码'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>phone_num<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'手机号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'邮箱'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>head_img<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'头像'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_level<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户级别'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">4</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'用户表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>商品分类实体</code>转换成商品分类表 (base_category)，由于商品分类可以有一级分类和二级分类，比如一级分类有家居、手机等等分类，二级分类可以根据手机的一级分类分为手机配件，运营商等，这里我们把商品分类实体规划为两张表，分别是<code>一级分类表</code>和<code>二级分类表</code>，之所以这么规划是因为一级分类和二级分类都是有限的，存储为两张表业务结构更加清晰。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 一级分类表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>base_category1<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'分类名称'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'一级分类表'</span><span class="token punctuation">;</span>

<span class="token comment"># 二级分类表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>base_category2<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'二级分类名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category1_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'一级分类编号'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'二级分类表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>那么如果规划为—张表呢，表结构如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>base_category<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'分类名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category_parent_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'父分类编号'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'分类表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果这样分类的话，那么查询一级分类时候，就需要判断父分类编号是否为空，但是如果插入二级分类的时候也是空，就容易造成<code>业务数据混乱</code>。而且查询二级分类的时候 IS NOT NULL 条件是无法使用到索引的。同时，这样的设计也不符合第二范式（因为父分类编号并不依赖分类编号 ID，因为父分类编号可以有很多数据为 NULL），所以需要进行表的拆分。因此无论是<code>业务需求</code>还是<code>数据库表的规范</code>来看都应该拆分为两张表。</p> <p><strong>下面我们再把弱实体转换成数据表</strong>:</p> <p><code>地址实体</code>转换成地址表(user_address) ，如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user_address<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>province<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'省'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>city<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'市'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_address<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'具体地址'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>consignee<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'收件人'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>phone_num<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'联系方式'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>is_default<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否是默认'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'用户地址表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>订单实体</code>转换成订单表（order_info），如下所示，实际业务中订单的信息会非常多，我们这里做了简化。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>order_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>consignee<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'收货人'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>consignee_tel<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'收件人电话'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>total_amount<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'总金额'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>payment_way<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'付款方式'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>delivery_address<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'送货地址'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'下单时间'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'订单表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>订单详情实体</code>转换成订单详情表（order_detail），如下所示。（用于体现多对多关系的，见下节）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 订单详情表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>order_detail<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单详情编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>order_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'sku_id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'sku名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_num<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'购买个数'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'操作时间'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'订单明细表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>购物车实体</code>转换成购物车表(cart_info)，如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>cart_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>cart_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'skuid'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_num<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'数量'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>img_url<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'图片文件'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>cart_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'购物车表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>评论实体</code>转换成评论表(members)，如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>sku_comments<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>comment_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'评论编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>comment<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'评论内容'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'评论时间'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>comment_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">45</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'商品评论表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>商品实体</code>转换成商品表(members)，如下所示。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>sku_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品编号(itemID)'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>price<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'价格'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'sku名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_desc<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品规格描述'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category3_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'三级分类id(冗余)'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>color<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'颜色'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>is_sale<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否销售(1:是 0:否)'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">45</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'商品表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_8-5-2-一个多对多的关系转换成一个数据表"><a href="#_8-5-2-一个多对多的关系转换成一个数据表" class="header-anchor">#</a> 8.5.2 一个多对多的关系转换成一个数据表</h4> <p>这个 ER 模型中的多对多的关系有 1 个，即<code>商品</code>和<code>订单</code>之间的关系，同品类的商品可以出现在不同的订单中，不同的订单也可以包含同一类型的商品，所以它们之间的关系是多对多。针对这种情况需要设计一个独立的表来表示，这种表一般称为<code>中间表</code>。</p> <p>我们可以设计一个独立的<code>订单详情表</code>，来代表商品和订单之间的包含关系。这个表关联到 2 个实体，分别 是订单、商品。所以，表中必须要包括这 2 个实体转换成的表的主键。除此之外，我们还要包括该关系自有的属性:商品数量，商品下单价格以及商品名称。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 订单详情表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>order_detail<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单详情编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>order_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单编号'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'sku_id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'sku名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_num<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'购买个数'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'操作时间'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>DYNAMIC 
<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'订单明细表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_8-5-3-通过外键来表达一对多的关系"><a href="#_8-5-3-通过外键来表达一对多的关系" class="header-anchor">#</a> 8.5.3 通过外键来表达一对多的关系</h4> <p>在上面的表的设计中，我们可以用外键来表达 1 对多的关系。比如在商品评论表 sku_comments 中我们分别把 user_id、sku_id 定义成外键，以使用下面的语句设置外键。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CONSTRAINT</span> fk_comment_user <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> user_info <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> fk_comment_sku <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>sku_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> sku_info <span class="token punctuation">(</span>sku_id<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>外键约束主要是在数据库层面上<code>保证数据的一致性</code>，但是因为插入和更新数据需要检查外键，理论上性能会有所下降，对性能是负面的影响。</p> <p>实际的项目，不建议使用外键，一方面是<code>降低开发的复杂度</code>（有外键的话主从表类的操作必须先操作主表），另外是有外键<code>在处理数据的时候非常麻烦</code>。在电商平台，由于<code>并发业务量比较大</code>，所以一般不设置外键，以免影响数据库性能。</p> <p>在应用层面做数据的<code>一致性检查</code>，本来就是一个正常的功能需求。如学生选课的场景，课程肯定不是输入的，而是通过下拉或查找等方式从系统中进行选取，就能够保证是合法的课程 ID，因此就不需要靠数据库的外键来检查了。</p> <h4 id="_8-5-4-把属性转换成表的字段"><a href="#_8-5-4-把属性转换成表的字段" class="header-anchor">#</a> 8.5.4 把属性转换成表的字段</h4> <p>在刚刚的设计中，我们也完成了把属性都转换成了表的字段，比如把商品属性转换成了商品信息表中的字段。</p> <h4 id="_8-5-5-总结"><a href="#_8-5-5-总结" class="header-anchor">#</a> 8.5.5 总结</h4> <p>到这里，我们通过创建电商项目业务流程的 ER 模型，再把 ER 模型转换成具体的数据表的过程，完成利用 ER 模型设计电商项目数据库的工作。</p> <p>其实，任何一个基于数据库的应用项目，都可以通过这种<code>先建立ER模型</code>，再<code>转换成数据表</code>的方式，完成数据库的设计工作。创建 ER 模型不是目的，目的是把业务逻辑梳理清楚，设计出优秀的数据库。我建议你不是为了建模而建模，要利用创建 ER 模型的过程来整理思路，这样创建 ER 模型才有意义。</p> <p><img src="/assets/img/ER_Design.a50eb1fb.webp" alt="image-ER-DESIGN"></p> <h2 id="_9-数据表的设计原则"><a href="#_9-数据表的设计原则" class="header-anchor">#</a> 9. 数据表的设计原则</h2> <p>数据表设计的一般原则：&quot;三少一多&quot;</p> <p><strong>① 数据表的个数越少越好</strong></p> <p>RDBMS 的核心在于对实体和联系的定义，也就是 E-R 图(Entity Relationship Diagram)，数据表越少，证明实体和联系设计得越简洁，既方便理解又方便操作。</p> <p><strong>② 数据表中的字段个数越少越好</strong></p> <p>字段个数越多，数据冗余的可能性越大。设置字段个数少的前提是各个字段相互独立，而不是某个字段的取值可以由其他字段计算出来。当然字段个数少是相对的，通常会在<code>数据冗余</code>和<code>检索效率</code>进行平衡</p> <p><strong>③ 数据表中联合主键的字段个数越少越好</strong></p> <p>设置主键是为了确定唯一性，当一个字段无法确定唯一性的时候，就需要采用联合主键的方式（也就是用多个字段来定义一个主健）。<strong>联合主键中的字段越多，占用的索列空间越大</strong>，不仅会加大理解难度，还会增加运行时间和索引空间，因此联合主键的字段个数越少越好。</p> <p><strong>④ 使用主键和外键越多越好</strong></p> <p>数据库的设计实际上就是定义各种表，以及各种字段之间的关系。这些关系越多，证明这些实体之间的冗余度越低，<code>利用度越高</code>。这样做的好处在于不仅保证了数据表之间的<code>独立性</code>，还能提升相互之间的关联使用率。这里的外键指业务上实现外键，也就是逻辑外键。不一定使用外键约束实现。</p> <p>“三少一多&quot;原则的核心就是<code>简单可复用</code>。简单指的是用更少的表、更少的字段、更少的联合主键字段来完成数据表的设计。可复用则是通过主键、外键的使用来增强数据表之间的复用率。因为一个主键可以理解是一张表的代表。键设计得越多，证明它们之间的利用率越高。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这个原则并不是绝对的，有时候我们需要牺牲数据的冗余度来换取数据处理的效率。</p></div> <h2 id="_10-数据库对象编写建议"><a href="#_10-数据库对象编写建议" class="header-anchor">#</a> 10. 数据库对象编写建议</h2> <h3 id="_10-1-关于库"><a href="#_10-1-关于库" class="header-anchor">#</a> 10.1 关于库</h3> <p>【强制】库的名称必须控制在 32 个字符以内，只能使用英文字母、数字和下划线，建议以英文字母开头。</p> <p>【强制】库名中的英文<code>一律小写</code>，不同单词采用<code>下划线</code>分割。须见名知意。</p> <p>【强制】库的名称格式：业务系统名称_子系统名。</p> <p>【强制】库名禁止使用关键字（如 type,order 等）。</p> <p>【强制】创建数据库时必须<code>显式指定字符集</code>，并且字符集只能是 utf8 或者 utf8mb4。创建数据库 SQL 举例：CREATE DATABASE crm_fund <code>DEFAULT CHARACTER SET 'utf8'</code>;</p> <p>【建议】对于程序连接数据库账号，遵循<code>权限最小原则</code>。使用数据库账号只能在一个 DB 下使用，不准跨库。程序使用的账号<code>原则上不准有drop权限</code>。</p> <p>【建议】临时库以<code>tmp_</code>为前缀，并以日期为后缀；备份库以<code>bak_</code>为前缀，并以日期为后缀。</p> <h3 id="_10-2-关于表、列"><a href="#_10-2-关于表、列" class="header-anchor">#</a> 10.2 关于表、列</h3> <p>【强制】表和列的名称必须控制在 32 个字符以内，表名只能使用英文字母、数字和下划线，建议以<code>英文字母开头</code>。</p> <p>【强制】<code>表名、列名一律小写</code>，不同单词采用下划线分割。须见名知意。</p> <p>【强制】表名要求有模块名强相关，同一模块的表名尽量使用<code>统一前缀</code>。比如：crm_fund_item</p> <p>【强制】创建表时必须<code>显式指定字符集</code>为 utf8 或 utf8mb4。</p> <p>【强制】表名、列名禁止使用关键字（如 type,order 等）。</p> <p>【强制】创建表时必须<code>显式指定表存储引擎</code>类型。如无特殊需求，一律为 InnoDB。</p> <p>【强制】建表必须有 comment。</p> <p>【强制】字段命名应尽可能使用表达实际含义的英文单词或<code>缩写</code>。如：公司 ID，不要使用 corporation_id, 而用 corp_id 即可。</p> <p>【强制】布尔值类型的字段命名为<code>is_描述</code>。如 member 表上表示是否为 enabled 的会员的字段命名为 is_enabled。</p> <p>【强制】禁止在数据库中存储图片、文件等大的二进制数据。</p> <p>通常文件很大，短时间内造成数据量快速增长，数据库进行数据库读取时，通常会进行大量的随机 IO 操作，文件很大时，IO 操作很耗时。通常存储于文件服务器，数据库只存储文件地址信息。</p> <p>【建议】建表时关于主键：<code>表必须有主键</code></p> <p>(1) 强制要求主键为 id，类型为 int 或 bigint，且为 auto_increment 建议使用 unsigned 无符号型。</p> <p>(2) 标识表里每一行主体的字段不要设为主键，建议设为其他字段如 user_id，order_id 等，并建立 unique key 索引。因为如果设为主键且主键值为随机插入，则会导致 innodb 内部页分裂和大量随机 I/O，性能下降。</p> <p>【建议】核心表（如用户表）必须有行数据的<code>创建时间字段</code>(create_time)和<code>最后更新时间字段</code>(update_time)，便于查问题。</p> <p>【建议】表中所有字段尽量都是<code>NOT NULL</code>属性，业务可以根据需要定义<code>DEFAULT 值</code>。 因为使用 NULL 值会存在每一行都会占用额外存储空间、数据迁移容易出错、聚合函数计算结果偏差等问题。</p> <p>【建议】所有存储相同数据的<code>列名和列类型必须一致</code>（一般作为关联列，如果查询时关联列类型不一致会自动进行数据类型隐式转换，会造成列上的索引失效，导致查询效率降低）。</p> <p>【建议】中间表（或临时表）用于保留中间结果集，名称以<code>tmp_</code>开头。备份表用于备份或抓取源表快照，名称以<code>bak_</code>开头。中间表和备份表定期清理。</p> <p>【示范】一个较为规范的建表语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span> 
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增主键'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'真实姓名'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户邮箱'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>nickname<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>birthday<span class="token punctuation">`</span></span> <span class="token keyword">date</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'生日'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>sex<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'性别'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>short_introduce<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'一句话介绍自己，最多50个汉字'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>user_resume<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户提交的简历存放地址'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>user_register_ip<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户注册时的源ip'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span> <span class="token keyword">timestamp</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'创建时间'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>update_time<span class="token punctuation">`</span></span> <span class="token keyword">timestamp</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'修改时间'</span><span class="token punctuation">,</span> 
    <span class="token identifier"><span class="token punctuation">`</span>user_review_status<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户资料审核状态，1为通过，2为审核中，3为未 通过，4为还未提交审核'</span><span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uniq_user_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_username<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_create_time_status<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>user_review_status<span class="token punctuation">`</span></span><span class="token punctuation">)</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'网站用户基本信息'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">建议</p> <p>创建表时，可以使用可视化工具。这样可以确保表、字段相关的约定都能设置上。实际上，我们通常很少自己写 DDL 语句，可以使用一些可视化工具来创建和操作数据库和数据表。可视化工具除了方便，还能直接帮我们将数据库的结构定义转化成 SQL 语言，方便数据库和数据表结构的导出和导入。</p></div> <h3 id="_10-3-关于索引"><a href="#_10-3-关于索引" class="header-anchor">#</a> 10.3 关于索引</h3> <p>【强制】InnoDB 表必须主键为 id int/bigint auto_increment，且主键值<code>禁止被更新</code>。</p> <p>【强制】InnoDB 和 MyISAM 存储引擎表，索引类型必须为<code>BTREE</code>。</p> <p>【建议】主键的名称以<code>pk_</code>开头，唯一键以<code>uni_</code>或<code>uk_</code>开头，普通索引以<code>idx_</code>开头，一律使用小写格式，以字段的名称或缩写作为后缀。</p> <p>【建议】多单词组成的 columnname，取前几个单词首字母，加末单词组成 column_name。如: sample 表 member_id 上的索引：idx_sample_mid。</p> <p>【建议】单个表上的索引个数<code>不能超过6个</code>。</p> <p>【建议】在建立索引时，多考虑建立<code>联合索引</code>，并把区分度最高的字段放在最前面。</p> <p>【建议】在多表 JOIN 的 SQL 里，保证被驱动表的连接列上有索引，这样 JOIN 执行效率最高。</p> <p>【建议】建表或加索引时，保证表里互相不存在<code>冗余索引</code>。 比如：如果表里已经存在 key(a,b)， 则 key(a)为冗余索引，需要删除。</p> <h3 id="_10-4-sql-编写"><a href="#_10-4-sql-编写" class="header-anchor">#</a> 10.4 SQL 编写</h3> <p>【强制】程序端 SELECT 语句必须指定具体字段名称，禁止写成 *。</p> <p>【建议】程序端 insert 语句指定具体字段名称，不要写成 INSERT INTO t1 VALUES(…)。</p> <p>【建议】除静态表或小表（100 行以内），DML 语句必须有 WHERE 条件，且使用索引查找。</p> <p>【建议】INSERT INTO…VALUES(XX),(XX),(XX).. 这里 XX 的值不要超过 5000 个。值过多虽然上线很快，但会引起主从同步延迟。</p> <p>【建议】SELECT 语句不要使用 UNION，推荐使用 UNION ALL，并且 UNION 子句个数限制在 5 个以内。</p> <p>【建议】线上环境，多表 JOIN 不要超过 5 个表。</p> <p>【建议】减少使用 ORDER BY，和业务沟通能不排序就不排序，或将排序放到程序端去做。ORDER BY、GROUP BY、DISTINCT 这些语句较为耗费 CPU，数据库的 CPU 资源是极其宝贵的。</p> <p>【建议】包含了 ORDER BY、GROUP BY、DISTINCT 这些查询的语句，WHERE 条件过滤出来的结果集请保持在 1000 行以内，否则 SQL 会很慢。</p> <p>【建议】对单表的多次 alter 操作必须合并为一次。对于超过 100W 行的大表进行 alter table，必须经过 DBA 审核，并在业务低峰期执行，多个 alter 需整合在一起。 因为 alter table 会产生<code>表锁</code>，期间阻塞对于该表的所有写入，对于业务可能会产生极大影响。</p> <p>【建议】批量操作数据时，需要控制事务处理间隔时间，进行必要的 sleep。</p> <p>【建议】事务里包含 SQL 不超过 5 个。因为过长的事务会导致锁数据较久，MySQL 内部缓存、连接消耗过多等问题。</p> <p>【建议】事务里更新语句尽量基于主键或 UNIQUE KEY，如 UPDATE… WHERE id=XX;否则会产生间隙锁，内部扩大锁定范围，导致系统性能下降，产生死锁。</p> <h2 id="_11-powerdesigner-的使用"><a href="#_11-powerdesigner-的使用" class="header-anchor">#</a> 11. PowerDesigner 的使用</h2> <p>PowerDesigner 是一款开发人员常用的数据库建模工具，用户利用该软件可以方便地制作 <code>数据流程图</code> 、 <code>概念数据模型</code> 、 <code>物理数据模型</code> ，它几乎包括了数据库模型设计的全过程，是 Sybase 公司为企业建模和设计提供的一套完整的集成化企业级建模解决方案。</p> <h3 id="_11-1-开始界面"><a href="#_11-1-开始界面" class="header-anchor">#</a> 11.1 开始界面</h3> <p>当前使用的 PowerDesigner 版本是 16.5 的。打开软件即是此页面，可选择 Create Model，也可以选择 Do Not Show page Again，自行在打开软件后创建也可以！完全看个人的喜好，在此我在后面的学习中不在显示此页面。</p> <p><img src="/assets/img/PowerDesigner1.ece7dd58.webp" alt="PowerDesigner1"></p> <p>“Create Model”的作用类似于普通的一个文件，该文件可以单独存放也可以归类存放。</p> <p>“Create Project”的作用类似于文件夹，负责把有关联关系的文件集中归类存放。</p> <h3 id="_11-2-概念数据模型"><a href="#_11-2-概念数据模型" class="header-anchor">#</a> 11.2 概念数据模型</h3> <p>常用的模型有 4 种，分别是 <code>概念模型(CDM Conceptual Data Model)</code> ，<code>物理模型（PDM Physical Data Model）</code> ， <code>面向对象的模型（OOM Objcet Oriented Model）</code>和 <code>业务模型（BPM Business Process Model）</code> ，我们先创建概念数据模型。</p> <p><img src="/assets/img/PowerDesigner2.44a62ad5.webp" alt="PowerDesigner2"></p> <p>点击上面的 ok，即可出现下图左边的概念模型 1，可以自定义概念模型的名字，在概念模型中使用最多的就是如图所示的 Entity（实体）,Relationship（关系）</p> <p><img src="/assets/img/PowerDesigner3.e7d0cad6.webp" alt="PowerDesigner3"></p> <h4 id="entity-实体"><a href="#entity-实体" class="header-anchor">#</a> Entity 实体</h4> <p>选中右边框中 Entity 这个功能，即可出现下面这个方框，需要注意的是书写 name 的时候，code 自行补全，name 可以是英文的也可以是中文的，但是 code 必须是英文的。</p> <p><img src="/assets/img/PowerDesigner4.bd3bed77.webp" alt="PowerDesigner4"></p> <h4 id="填充实体字段"><a href="#填充实体字段" class="header-anchor">#</a> 填充实体字段</h4> <p>General 中的 name 和 code 填好后，就可以点击 Attributes（属性）来设置 name（名字），code（在数据库中的字段名），Data Type（数据类型） ，length（数据类型的长度）</p> <ul><li>Name: 实体名字一般为中文，如论坛用户</li> <li>Code: 实体代号，一般用英文，如 XXXUser</li> <li>Comment:注释，对此实体详细说明</li> <li>Code 属性：代号，一般用英文 UID DataType</li> <li>Domain 域，表示属性取值范围如可以创建 10 个字符的地址域</li> <li>M:Mandatory 强制属性，表示该属性必填。不能为空</li> <li>P:Primary Identifer 是否是主标识符，表示实体唯一标识符</li> <li>D:Displayed 显示出来，默认全部勾选</li></ul> <p><img src="/assets/img/PowerDesigner5.9b9a705c.webp" alt="PowerDesigner5"></p> <h4 id="设置主标识符"><a href="#设置主标识符" class="header-anchor">#</a> 设置主标识符</h4> <p>如果不希望系统自动生成标识符而是手动设置的话，那么切换到 Identifiers 选项卡，添加一行 Identifier， 然后单击左上角的“属性”按钮，然后弹出的标识属性设置对话框中单击“添加行”按钮，选择该标识中使用的属性。例如将学号设置为学生实体的标识。</p> <p><img src="/assets/img/PowerDesigner6.e8c80941.webp" alt="PowerDesigner6"></p> <h4 id="放大模型"><a href="#放大模型" class="header-anchor">#</a> 放大模型</h4> <p>创建好概念数据模型如图所示，但是创建好的字体很小，读者可以按着 ctrl 键同时滑动鼠标的滚轮即可放大缩写字体，同时也可以看到主标识符有一个*号的标志，同时也显示出来了，name,Data type 和 length 这些可见的属性</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <ul><li>不建议用鼠标滚轮，使用之后，发现模型找不到了，建议用右侧 Toolbox 里的放大镜</li> <li>新版主标识符有一个<code>&lt;pi&gt;</code>的标志</li></ul></div> <h4 id="实体关系"><a href="#实体关系" class="header-anchor">#</a> 实体关系</h4> <p>同理创建一个班级的实体（需要特别注意的是，点击完右边功能的按钮后需要点击鼠标指针状态的按钮或者右击鼠标即可，不然很容易乱操作，这点注意一下就可以了），然后使用 Relationship（关系）这个按钮可以连接学生和班级之间的关系，发生一对多（班级对学生）或者多对一（学生对班级）的关系。如图所示</p> <p><img src="/assets/img/PowerDesigner7.d71336c3.webp" alt="PowerDesigner7"></p> <p>需要注意的是点击 Relationship 这个按钮，就把班级和学生联系起来了，就是一条线，然后双击这条线进行编辑，在 General 这块起 name 和 code</p> <p>在 Cardinalities 这块查看班级和学生的关系，可以看到班级的一端是一条线，学生的一端是三条，代表班级对学生是一对多的关系即 one 对 many 的关系，点击应用，然后确定即可</p> <p><img src="/assets/img/PowerDesigner8.9b9b9d40.webp" alt="PowerDesigner8"></p> <h3 id="_11-3-物理数据模型"><a href="#_11-3-物理数据模型" class="header-anchor">#</a> 11.3 物理数据模型</h3> <p>上面是概念数据模型，下面介绍一下物理数据模型，以后<code>经常使用</code>的就是物理数据模型。打开 PowerDesigner，然后点击 File--&gt;New Model 然后选择如下图所示的物理数据模型，物理数据模型的名字自己起，然后选择自己所使用的数据库即可。</p> <p><img src="/assets/img/PowerDesigner9.8106c280.webp" alt="PowerDesigner9"></p> <p>创建好主页面如图所示，但是右边的按钮和概念模型略有差别，物理模型最常用的三个是 <code>table(表)</code> ， <code>view(视图)</code>， <code>reference(关系)</code>；</p> <p><img src="/assets/img/PowerDesigner10.36111946.webp" alt="PowerDesigner10"></p> <p>鼠标先点击右边 table 这个按钮然后在新建的物理模型点一下，即可新建一个表，然后双击新建如下图所示，在 General 的 name 和 code 填上自己需要的，点击应用即可），如下图：</p> <p><img src="/assets/img/PowerDesigner11.5e23fc84.webp" alt="PowerDesigner11"></p> <p>然后点击 Columns,如下图设置，非常简单，需要注意的就是 P（primary 主键）, F（foreign key 外键）,M（mandatory 强制性的，代表不可为空）这三个。</p> <p><img src="/assets/img/PowerDesigner12.4d1d1538.webp" alt="PowerDesigner12"></p> <p>在此设置学号的自增（MYSQL 里面的自增是这个 AUTO_INCREMENT），班级编号同理，不多赘述！</p> <p><img src="/assets/img/PowerDesigner13.94e03c14.webp" alt="PowerDesigner13"></p> <p>在下面的这个点上对号即可，就设置好了自增</p> <p><img src="/assets/img/PowerDesigner14.423c2202.webp" alt="PowerDesigner14"></p> <p>全部完成后如下图所示。</p> <p><img src="/assets/img/PowerDesigner151.67cce02c.webp" alt="PowerDesigner15"></p> <p>班级物理模型同理如下图所示创建即可</p> <p><img src="/assets/img/PowerDesigner16.020a9dc6.webp" alt="PowerDesigner16"></p> <p><img src="/assets/img/image-20241221205451826.9cba7ec1.webp" alt="image-20241221205451826"></p> <p>完成后如下图所示</p> <p><img src="/assets/img/image-20241221205503707.2336034e.webp" alt="image-20241221205503707"></p> <p>上面的设置好如上图所示，然后下面是关键的地方，点击右边按钮 Reference 这个按钮，因为是班级对学生是一对多的，所以鼠标从学生拉到班级如下图所示，学生表将发生变化，学生表里面增加了一行，这行是班级表的主键作为学生表的外键，将班级表和学生表联系起来。（仔细观察即可看到区别。）</p> <p><img src="/assets/img/image-20241221205527067.e645e59f.webp" alt="image-20241221205527067"></p> <p>做完上面的操作，就可以双击中间的一条线，显示如下图，修改 name 和 code 即可</p> <p><img src="/assets/img/image-20241221205539223.8b3ccdbc.webp" alt="image-20241221205539223"></p> <p>但是需要注意的是，修改完毕后显示的结果却如下图所示，并没有办法直接像概念模型那样，修改过后显示在中间的那条线上面，自己明白即可。</p> <p><img src="/assets/img/image-20241221205557448.e645e59f.webp" alt="image-20241221205557448"></p> <p>学习了多对一或者一对多的关系，接下来学习多对多的关系，同理自己建好老师表，这里不在叙述，记得老师编号自增，建好如下图所示</p> <p><img src="/assets/img/image-20241221205610038.7ff7bf9c.webp" alt="image-20241221205610038"></p> <p>下面是多对多关系的关键，由于物理模型多对多的关系需要一个中间表来连接，如下图，只设置一个字段，主键，自增</p> <p><img src="/assets/img/image-20241221205625101.55a36d1a.webp" alt="image-20241221205625101"></p> <p>点击应用，然后设置 Columns，只添加一个字段</p> <p><img src="/assets/img/image-20241221205634965.f23d8b50.webp" alt="image-20241221205634965"></p> <p>这是设置字段递增，前面已经叙述过好几次</p> <p><img src="/assets/img/image-20241221205748121.d048aa07.webp" alt="image-20241221205748121"></p> <p>设置好后如下图所示，需要注意的是有箭头的一方是一，无箭头的一方是多，即一对多的多对一的关系需要搞清楚，学生也可以有很多老师，老师也可以有很多学生，所以学生和老师都可以是主体；</p> <p><img src="/assets/img/image-20241221205803089.21aa25bf.webp" alt="image-20241221205803089"></p> <p>可以看到添加关系以后学生和教师的关系表前后发生的变化</p> <p><img src="/assets/img/image-20241221205911205.572f60da.webp" alt="image-20241221205911205"></p> <h3 id="_11-4-概念模型转为物理模型"><a href="#_11-4-概念模型转为物理模型" class="header-anchor">#</a> 11.4 概念模型转为物理模型</h3> <p>1：如下图所示先打开概念模型图，然后点击 Tool,如下图所示</p> <p><img src="/assets/img/image-20241222184120609.c60e1008.webp" alt="image-20241222184120609"></p> <p>点开的页面如下所示，name 和 code 已经从概念模型 1 改成物理模型 1 了</p> <p><img src="/assets/img/image-20241222184144412.fbdc0cc4.webp" alt="image-20241222184144412"></p> <p>完成后如下图所示，将自行打开修改的物理模型，需要注意的是这些表的数据类型已经自行改变了，而且中间表出现两个主键，即双主键，</p> <p><img src="/assets/img/image-20241222184203384.56d235a7.webp" alt="image-20241222184203384"></p> <h3 id="_11-5-物理模型转为概念模型"><a href="#_11-5-物理模型转为概念模型" class="header-anchor">#</a> 11.5 物理模型转为概念模型</h3> <p>上面介绍了概念模型转物理模型，下面介绍一下物理模型转概念模型（如下图点击操作即可）</p> <p><img src="/assets/img/image-20241222184216709.e8e81286.webp" alt="image-20241222184216709"></p> <p>然后出现如下图所示界面，然后将物理修改为概念 ，点击应用确认即可</p> <p><img src="/assets/img/image-20241222184228264.90bbcd47.webp" alt="image-20241222184228264"></p> <p>点击确认后将自行打开如下图所示的页面，自己观察有何变化，如果转换为 oracle 的，数据类型会发生变
化，比如 Varchar2 等等）；</p> <p><img src="/assets/img/image-20241222184241219.a04f8503.webp" alt="image-20241222184241219"></p> <h3 id="_11-6-物理模型导出-sql-语句"><a href="#_11-6-物理模型导出-sql-语句" class="header-anchor">#</a> 11.6 物理模型导出 SQL 语句</h3> <p>下面介绍一下物理模型导出 SQL 语句（点击 Database 按钮的 Generate Database 或者按 ctrl+G）</p> <p><img src="/assets/img/image-20241222184300554.23bccc8c.webp" alt="image-20241222184300554"></p> <p>打开之后如图所示，修改好存在 sql 语句的位置和生成文件的名称即可</p> <p><img src="/assets/img/image-20241222184312461.3f62433e.webp" alt="image-20241222184312461"></p> <p>在 Selection 中选择需要导出的表，然后点击应用和确认即可</p> <p><img src="/assets/img/image-20241222184324851.14f596c9.webp" alt="image-20241222184324851"></p> <p>完成以后出现如下图所示，可以点击 Edit 或者 close 按钮</p> <p><img src="data:image/webp;base64,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" alt="image-20241222184337108"></p> <p>自此，就完成了导出 sql 语句，就可以到自己指定的位置查看导出的 sql 语句了；PowerDesigner 在以后在项目开发过程中用来做需求分析和数据库的设计非常的方便和快捷。</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/09/01, 22:47:10</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-10/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">第10章_索引优化与查询优化</div></a> <a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-12/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">第12章_数据库其它调优策略</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-10/" class="prev">第10章_索引优化与查询优化</a></span> <span class="next"><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-12/">第12章_数据库其它调优策略</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/java-basic/jdbc-core/"><div>
            JDBC 核心技术(JDK21版)
            <!----></div></a> <span class="date">09-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-0/"><div>
            第00章_写在前面
            <!----></div></a> <span class="date">05-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/java-basic/mysql-from-beginners-to-advanced/advanced/chapter-1/"><div>
            第01章_Linux 下 MySQL 的安装与使用
            <!----></div></a> <span class="date">05-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1214025526@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/coderofmutou" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/ismutou" title="Gitee" target="_blank" class="iconfont icon-gitee"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2025
    <span>bombax | <a href="https://github.com/coderofmutou/coderofmutou.github.io/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ca5c989c.js" defer></script><script src="/assets/js/3.f2884e99.js" defer></script><script src="/assets/js/2.81e8b964.js" defer></script><script src="/assets/js/16.81c1d5ab.js" defer></script>
  </body>
</html>
